{"ast":null,"code":"import React,{useState,useEffect,useCallback,useRef,useMemo}from'react';import{useParams,useNavigate,Link}from'react-router-dom';import axios from'axios';import{useError}from'./ErrorContext';import L from'leaflet';import'leaflet/dist/leaflet.css';import'./ProductDetail.css';import'./ProductList.css';// Виправлення проблеми з іконками Leaflet\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";delete L.Icon.Default.prototype._getIconUrl;L.Icon.Default.mergeOptions({iconRetinaUrl:'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',iconUrl:'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',shadowUrl:'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png'});function ProductDetail(){var _data$product$feature,_data$product$feature2,_data$product$feature3,_data$product$feature4,_data$product$feature5,_data$product$feature6,_data$product$feature7,_data$product$feature8,_data$product$feature9,_data$product$feature10,_data$product$store_p;const{productId}=useParams();const navigate=useNavigate();const{setError,clearError}=useError();const[data,setData]=useState({product:null,storeLocations:[],cities:[]});const[isLoading,setIsLoading]=useState(true);const[error,setLocalError]=useState(null);const[currentImageIndex,setCurrentImageIndex]=useState(0);const[prevImageIndex,setPrevImageIndex]=useState(null);const[direction,setDirection]=useState(null);const[isFullScreen,setIsFullScreen]=useState(false);const[isSaved,setIsSaved]=useState(false);const[showLoginPrompt,setShowLoginPrompt]=useState(false);const[showDeleteModal,setShowDeleteModal]=useState(false);const[isMapFullScreen,setIsMapFullScreen]=useState(false);const[isDragging,setIsDragging]=useState(false);const[citySearch,setCitySearch]=useState('');const[showCityPopup,setShowCityPopup]=useState(false);const cityPopupRef=useRef(null);const featuresRef=useRef(null);const descriptionRef=useRef(null);const storePricesRef=useRef(null);const mapRef=useRef(null);const mapContainerRef=useRef(null);const fullScreenMapRef=useRef(null);const fullScreenMapContainerRef=useRef(null);const markersRef=useRef([]);const fullScreenMarkersRef=useRef([]);const token=localStorage.getItem('token');const user=JSON.parse(localStorage.getItem('user'))||null;const isAdmin=user&&user.is_admin;const userLocation=localStorage.getItem('userLocationStatus')||'Виберіть місто';const cityCoordinates=useMemo(()=>({\"Вінниця\":[49.2331,28.4682],\"Дніпро\":[48.4647,35.0462],\"Донецьк\":[48.0159,37.8028],\"Житомир\":[50.2547,28.6587],\"Запоріжжя\":[47.8388,35.1396],\"Івано-Франківськ\":[48.9226,24.7111],\"Кропивницький\":[48.5079,32.2605],\"Луганськ\":[48.5679,39.3105],\"Луцьк\":[50.7463,25.3355],\"Одеса\":[46.4825,30.7233],\"Черкаси\":[49.4444,32.0597],\"Чернівці\":[48.2923,25.9354],\"Чернігів\":[51.4982,31.2893],\"Біла Церква\":[49.7927,30.1126],\"Бердянськ\":[46.7515,36.7994],\"Бердичів\":[49.8965,28.5855],\"Болехів\":[49.0588,23.8600],\"Борислав\":[49.2864,23.4246],\"Бориспіль\":[50.3543,30.9562],\"Боярка\":[50.3428,30.2872],\"Бровари\":[50.5048,30.7146],\"Бурштин\":[49.2500,24.6167],\"Васильків\":[50.1833,30.3167],\"Вінники\":[49.8167,24.0333],\"Вишгород\":[50.5833,30.4833],\"Вишневе\":[50.3925,30.3667],\"Вознесенськ\":[47.5667,31.31610],\"Волноваха\":[47.6000,37.5167],\"Волочиськ\":[49.2833,26.1667],\"Володимир-Волинський\":[50.8500,24.3167],\"Вугледар\":[47.7833,37.2667],\"Гайсин\":[48.8000,29.4167],\"Гнівань\":[49.1000,28.3667],\"Гола Пристань\":[46.5333,32.5000],\"Голубівка\":[48.3833,38.9167],\"Горішні Плавні\":[49.0167,33.5667],\"Городенка\":[48.6667,25.5000],\"Городок\":[49.1500,27.2333],\"Гостомель\":[50.5667,30.2167],\"Дніпрорудне\":[47.3833,34.9833],\"Добропілля\":[48.4500,37.0833],\"Долина\":[48.9667,23.9500],\"Дрогобич\":[49.3500,23.5000],\"Дубляни\":[49.9333,24.2667],\"Дубно\":[50.3833,25.7500],\"Енергодар\":[47.5000,34.6333],\"Жмеринка\":[49.0333,28.1167],\"Жовква\":[50.0667,23.9667],\"Жовті Води\":[48.3500,33.5000],\"Заліщики\":[48.6500,25.7333],\"Збруч\":[48.6167,26.4833],\"Знам’янка\":[48.7167,32.6667],\"Золотоноша\":[49.6833,32.0333],\"Золочів\":[49.8000,24.9000],\"Ізюм\":[49.2000,37.2500],\"Іллінці\":[49.1000,29.2167],\"Ірпінь\":[50.5167,30.2167],\"Калуш\":[49.0167,24.3667],\"Кам’янець-Подільський\":[48.6833,26.5833],\"Кам’янка\":[49.0333,32.0833],\"Канів\":[49.7500,31.4833],\"Карлівка\":[49.4333,35.1333],\"Каховка\":[46.8167,33.4833],\"Керч\":[45.3563,36.4740],\"Київ\":[50.4501,30.5234],\"Кіровоград\":[48.5079,32.2605],\"Ковель\":[51.2167,24.7000],\"Козятин\":[49.7167,28.8167],\"Коломия\":[48.5333,25.0333],\"Копичинці\":[48.8333,25.8500],\"Коростень\":[50.9667,28.6500],\"Коростишів\":[50.3167,29.0500],\"Косів\":[48.3167,25.1000],\"Костопіль\":[50.8833,26.5333],\"Краматорськ\":[48.7333,37.6000],\"Красилів\":[49.6500,26.9667],\"Кременчук\":[49.0833,33.4167],\"Кролевець\":[51.5333,33.3833],\"Кузнецовськ\":[51.3167,25.8500],\"Куп’янськ\":[49.7167,37.6167],\"Ладижин\":[48.6833,29.2333],\"Ланівці\":[49.8500,26.0833],\"Лебедин\":[50.6000,34.4833],\"Лиман\":[48.9833,37.6167],\"Липовець\":[49.2333,29.0833],\"Лисичанськ\":[48.9000,38.4333],\"Лозова\":[48.8833,36.3167],\"Лубни\":[50.0167,32.9833],\"Лутугине\":[48.4000,39.2167],\"Львів\":[49.8397,24.0297],\"Макіївка\":[48.0500,37.9833],\"Малин\":[50.7667,29.2333],\"Марганець\":[47.6333,34.6333],\"Маріуполь\":[47.0951,37.5538],\"Мелітополь\":[46.8500,35.3667],\"Мена\":[51.5667,32.0833],\"Миколаїв\":[46.9750,31.9946],\"Мирноград\":[48.3000,37.2667],\"Миронівка\":[49.6667,30.6167],\"Могилів-Подільський\":[48.4500,27.7833],\"Молочанськ\":[47.2000,35.5833],\"Монастириська\":[49.0833,25.1667],\"Мостиська\":[49.8000,23.1500],\"Мукачево\":[48.4333,22.7167],\"Надвірна\":[48.6333,24.5833],\"Ніжин\":[51.5167,31.8833],\"Нікополь\":[47.5667,34.4000],\"Нова Каховка\":[46.7500,33.3667],\"Нова Одеса\":[46.7500,31.7500],\"Новий Буг\":[47.6833,32.5333],\"Новоазовськ\":[47.1167,38.7500],\"Новоукраїнка\":[48.3167,31.5167],\"Носівка\":[50.6167,31.5167],\"Обухів\":[50.1000,30.6167],\"Овруч\":[51.3333,28.8000],\"Олевськ\":[51.0500,27.6667],\"Олександрія\":[48.6667,33.1167],\"Олександрівськ\":[47.9500,33.2833],\"Олешки\":[46.6333,32.6167],\"Острог\":[50.3333,26.5167],\"Павлоград\":[48.5333,35.8667],\"Первомайськ\":[50.3167,31.5167],\"Перевальськ\":[48.4333,38.8333],\"Перемишляни\":[49.6500,24.5833],\"Переяслав\":[50.0500,31.4500],\"Пирятин\":[50.2500,32.5167],\"Покров\":[47.6167,33.5167],\"Покровськ\":[48.2833,37.1667],\"Полонне\":[50.1167,27.5167],\"Полтава\":[49.5883,34.5514],\"Помічна\":[48.6167,31.6167],\"Прилуки\":[50.5833,32.3833],\"Пустомити\":[49.7167,23.8833],\"Радехів\":[50.2833,24.6333],\"Радомишль\":[50.4833,29.2333],\"Рені\":[45.4500,28.2833],\"Ржищів\":[50.0333,30.9667],\"Рівне\":[50.6199,26.2516],\"Рогатин\":[49.4167,24.6167],\"Рожище\":[50.9167,25.2667],\"Сарни\":[51.3333,26.5833],\"Свалява\":[48.5500,22.9833],\"Сватове\":[49.4167,38.1500],\"Світловодськ\":[49.0500,33.2333],\"Сєвєродонецьк\":[48.9333,38.4833],\"Семенівка\":[51.3333,32.6000],\"Середина-Буда\":[51.7500,33.9833],\"Синельникове\":[48.3167,35.4833],\"Славута\":[50.3000,26.8667],\"Славутич\":[51.5167,30.7500],\"Смела\":[49.1833,31.8667],\"Снігурівка\":[47.0833,32.7667],\"Сокаль\":[50.4833,23.9833],\"Сокиряни\":[48.4500,27.4167],\"Соледар\":[48.6833,38.1000],\"Сорокине\":[48.1500,39.6167],\"Старобільськ\":[49.2833,38.9167],\"Старокостянтинів\":[49.7500,27.2167],\"Стебник\":[49.2833,23.5667],\"Стрий\":[49.2500,23.8500],\"Судак\":[44.8500,34.9667],\"Суми\":[50.9077,34.7981],\"Таврійськ\":[46.7667,33.3833],\"Талалаївка\":[50.6833,33.1833],\"Тальне\":[48.8833,29.9833],\"Тараща\":[49.5667,30.4833],\"Тернопіль\":[49.5535,25.5948],\"Тетіїв\":[49.3833,29.6167],\"Тисмениця\":[48.9000,24.8500],\"Тлумач\":[48.8667,24.9833],\"Токмак\":[47.2500,35.6667],\"Тростянець\":[50.4833,34.9667],\"Трускавець\":[49.2833,23.5000],\"Тульчин\":[48.6667,28.8500],\"Угледар\":[47.7833,37.2667],\"Ужгород\":[48.6208,22.2879],\"Умань\":[48.7500,30.2167],\"Фастів\":[50.0833,29.9167],\"Феодосія\":[45.0333,35.3667],\"Харків\":[49.9935,36.2304],\"Херсон\":[46.6558,32.6178],\"Хмельницький\":[49.4216,26.9918],\"Хмільник\":[49.5667,27.9667],\"Ходорів\":[49.1667,24.3167],\"Хотин\":[48.5167,26.4833],\"Хрестівка\":[48.0500,37.3167],\"Христинівка\":[48.7833,29.9667],\"Хрустальний\":[48.1167,38.9333],\"Часів Яр\":[48.6000,37.8500],\"Червоноград\":[50.3833,24.2167],\"Чекалин\":[49.2333,28.5833],\"Чигирин\":[49.0833,32.6500],\"Чоп\":[48.4333,22.2000],\"Чортків\":[49.0167,25.8000],\"Чугуїв\":[50.5833,36.6833],\"Шепетівка\":[50.1833,27.0667],\"Шостка\":[51.8667,33.4667],\"Шумськ\":[50.2833,26.0833],\"Щастя\":[48.7333,39.2333],\"Южне\":[46.6167,30.9833],\"Яворів\":[49.9333,23.3833],\"Яготин\":[50.2500,31.7667],\"Ямпіль\":[48.2500,29.0833],\"Яремче\":[48.4500,24.5500]}),[]);// Топ-10 найбільших міст України, з останнім як \"За розташуванням\"\nconst topCities=['Київ','Харків','Одеса','Дніпро','Херсон','Запоріжжя','Львів','Кривий Ріг','Миколаїв','За розташуванням'];// Функція для отримання початкових даних\nconst fetchInitialData=useCallback(async()=>{setIsLoading(true);clearError();try{console.log('Завантаження початкових даних для товару:',productId);const[productResponse,citiesResponse,storeLocationsResponse]=await Promise.all([axios.get(`https://price-ua-react-backend.onrender.com/products/${productId}`,{headers:{'Content-Type':'application/json'}}),axios.get('https://price-ua-react-backend.onrender.com/cities',{headers:{'Content-Type':'application/json'}}),axios.get('https://price-ua-react-backend.onrender.com/store-locations',{params:{productId},headers:{'Content-Type':'application/json'}})]);setData({product:productResponse.data,cities:citiesResponse.data,storeLocations:storeLocationsResponse.data});console.log('Початкові дані завантажено:',{product:productResponse.data.id,cities:citiesResponse.data.length,storeLocations:storeLocationsResponse.data.length});}catch(err){console.error('Помилка завантаження початкових даних:',err);setError('Помилка завантаження даних. Перевірте підключення.');setLocalError('Помилка завантаження даних. Перевірте підключення.');}finally{setIsLoading(false);}},[productId,setError,clearError]);useEffect(()=>{fetchInitialData();},[fetchInitialData]);// Перевірка статусу збереження товару\nconst checkSavedStatus=useCallback(async()=>{if(!token){setIsSaved(false);return;}try{const response=await axios.get(`https://price-ua-react-backend.onrender.com/saved-products/${productId}`,{headers:{Authorization:`Bearer ${token}`,'Content-Type':'application/json'}});setIsSaved(response.data.isSaved);}catch(err){console.error('Помилка перевірки статусу збереження:',err);setError('Не вдалося перевірити статус збереження товару.');}},[productId,token,setError]);useEffect(()=>{if(!isLoading&&!error&&data.product){checkSavedStatus();}},[checkSavedStatus,isLoading,error,data.product]);// Отримання координат за замовчуванням для мапи\nconst getDefaultCoordinates=useCallback(async()=>{let coords=[50.4501,30.5234];// За замовчуванням Київ\nlet zoom=14;if(userLocation&&userLocation!=='Виберіть місто'&&userLocation!=='denied'){if(userLocation in cityCoordinates){coords=cityCoordinates[userLocation];console.log(`Використання координат міста ${userLocation}:`,coords);}else if(userLocation!=='За розташуванням'){try{const response=await axios.get(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(userLocation)}&countrycodes=ua`);if(response.data.length>0){coords=[parseFloat(response.data[0].lat),parseFloat(response.data[0].lon)];console.log(`Отримані координати для ${userLocation}:`,coords);}}catch(err){console.error('Помилка отримання координат міста:',err);}}else if(navigator.geolocation){try{const position=await new Promise((resolve,reject)=>{navigator.geolocation.getCurrentPosition(resolve,reject,{enableHighAccuracy:true,timeout:10000,maximumAge:0});});coords=[position.coords.latitude,position.coords.longitude];console.log('Використання координат геолокації:',coords);}catch(err){console.error('Помилка отримання геолокації:',err);}}}return{coords,zoom};},[userLocation,cityCoordinates]);// Ініціалізація вбудованої мапи\nconst initializeInlineMap=useCallback(async()=>{if(!mapContainerRef.current){console.error('Контейнер вбудованої мапи не знайдено');return;}if(mapContainerRef.current.offsetHeight===0||mapContainerRef.current.offsetWidth===0){console.warn('Контейнер мапи має нульові розміри');setTimeout(()=>initializeInlineMap(),500);return;}try{const{coords,zoom}=await getDefaultCoordinates();console.log('Ініціалізація вбудованої мапи з координатами:',coords,'зум:',zoom);mapRef.current=L.map(mapContainerRef.current,{center:coords,zoom:zoom,scrollWheelZoom:false,dragging:true});const tileLayer=L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'© <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'}).addTo(mapRef.current);tileLayer.on('tileerror',error=>{console.error('Помилка завантаження тайлів:',error);setError('Помилка завантаження мапи. Перевірте підключення до мережі.');});mapRef.current.on('dragstart',()=>{console.log('Початок перетягування вбудованої мапи');setIsDragging(true);});mapRef.current.on('dragend',()=>{console.log('Кінець перетягування вбудованої мапи');setTimeout(()=>setIsDragging(false),100);});// Додавання маркерів\nmarkersRef.current.forEach(marker=>marker.remove());markersRef.current=[];if(data.storeLocations.length>0){markersRef.current=data.storeLocations.map(storeLocation=>{const marker=L.marker([storeLocation.latitude,storeLocation.longitude],{icon:L.icon({iconUrl:'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',iconRetinaUrl:'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',shadowUrl:'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})}).addTo(mapRef.current);marker.bindTooltip(storeLocation.store_name,{permanent:true,direction:'top',offset:[0,-40],className:'store-label'});return marker;});const cityStoreLocations=data.storeLocations.filter(storeLocation=>{const R=6371;const lat1=coords[0]*Math.PI/180;const lat2=storeLocation.latitude*Math.PI/180;const deltaLat=(storeLocation.latitude-coords[0])*Math.PI/180;const deltaLon=(storeLocation.longitude-coords[1])*Math.PI/180;const a=Math.sin(deltaLat/2)**2+Math.cos(lat1)*Math.cos(lat2)*Math.sin(deltaLon/2)**2;const c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));const distance=R*c;return distance<5;});if(cityStoreLocations.length>0){const bounds=L.latLngBounds(cityStoreLocations.map(loc=>[loc.latitude,loc.longitude]));mapRef.current.fitBounds(bounds,{padding:[20,20],maxZoom:15});console.log('Мапа масштабована до магазинів у місті:',cityStoreLocations.length);}else{console.log('Немає магазинів у радіусі 5 км, центрування на місті:',userLocation);mapRef.current.setView(coords,zoom);}}else{console.log('Немає магазинів, центрування на місті:',userLocation);mapRef.current.setView(coords,zoom);}setTimeout(()=>{if(mapRef.current){mapRef.current.invalidateSize();}},200);}catch(err){console.error('Не вдалося ініціалізувати вбудовану мапу:',err);setError('Не вдалося ініціалізувати мапу.');}},[setError,data.storeLocations,userLocation,getDefaultCoordinates]);// Ініціалізація вбудованої мапи лише один раз при монтуванні\nuseEffect(()=>{if(!isLoading&&!error&&data.product){initializeInlineMap();}return()=>{if(mapRef.current){console.log('Очищення вбудованої мапи');mapRef.current.off('dragstart');mapRef.current.off('dragend');mapRef.current.remove();mapRef.current=null;markersRef.current.forEach(marker=>marker.remove());markersRef.current=[];}};},[isLoading,error,data.product,initializeInlineMap]);// Обробка кліків поза попапом міста\nuseEffect(()=>{const handleClickOutside=event=>{if(cityPopupRef.current&&!cityPopupRef.current.contains(event.target)&&!event.target.classList.contains('city-search-input')){setShowCityPopup(false);setCitySearch('');}};document.addEventListener('mousedown',handleClickOutside);return()=>document.removeEventListener('mousedown',handleClickOutside);},[]);// Ініціалізація повноекранної мапи\nconst initializeFullScreenMap=useCallback(async()=>{if(!fullScreenMapContainerRef.current){console.error('Контейнер повноекранної мапи не знайдено');return;}if(fullScreenMapContainerRef.current.offsetHeight===0||fullScreenMapContainerRef.current.offsetWidth===0){console.warn('Контейнер повноекранної мапи має нульові розміри');setTimeout(()=>initializeFullScreenMap(),500);return;}try{const{coords,zoom}=await getDefaultCoordinates();console.log('Ініціалізація повноекранної мапи з координатами:',coords,'зум:',zoom);fullScreenMapRef.current=L.map(fullScreenMapContainerRef.current,{center:coords,zoom:zoom,scrollWheelZoom:true,dragging:true});const tileLayer=L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'© <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'}).addTo(fullScreenMapRef.current);tileLayer.on('tileerror',error=>{console.error('Помилка завантаження тайлів повноекранної мапи:',error);setError('Помилка завантаження мапи.');});fullScreenMarkersRef.current.forEach(marker=>marker.remove());fullScreenMarkersRef.current=[];if(data.storeLocations.length>0){fullScreenMarkersRef.current=data.storeLocations.map(storeLocation=>{const marker=L.marker([storeLocation.latitude,storeLocation.longitude],{icon:L.icon({iconUrl:'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',iconRetinaUrl:'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',shadowUrl:'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})}).addTo(fullScreenMapRef.current);marker.bindTooltip(storeLocation.store_name,{permanent:true,direction:'top',offset:[0,-40],className:'store-label'});return marker;});const cityStoreLocations=data.storeLocations.filter(storeLocation=>{const R=6371;const lat1=coords[0]*Math.PI/180;const lat2=storeLocation.latitude*Math.PI/180;const deltaLat=(storeLocation.latitude-coords[0])*Math.PI/180;const deltaLon=(storeLocation.longitude-coords[1])*Math.PI/180;const a=Math.sin(deltaLat/2)**2+Math.cos(lat1)*Math.cos(lat2)*Math.sin(deltaLon/2)**2;const c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));const distance=R*c;return distance<5;});if(cityStoreLocations.length>0){const bounds=L.latLngBounds(cityStoreLocations.map(loc=>[loc.latitude,loc.longitude]));fullScreenMapRef.current.fitBounds(bounds,{padding:[20,20],maxZoom:15});}else{fullScreenMapRef.current.setView(coords,zoom);}}else{fullScreenMapRef.current.setView(coords,zoom);}setTimeout(()=>{if(fullScreenMapRef.current){fullScreenMapRef.current.invalidateSize();}},500);}catch(err){console.error('Не вдалося ініціалізувати повноекранну мапу:',err);setError('Не вдалося завантажити повноекранну мапу.');}},[setError,data.storeLocations,getDefaultCoordinates]);// Обробка вибору міста на повноекранній мапі\nconst handleCitySelect=async cityName=>{if(!fullScreenMapRef.current)return;let coords=[50.4501,30.5234];// За замовчуванням Київ\nlet zoom=14;if(cityName==='За розташуванням'){if(navigator.geolocation){try{const position=await new Promise((resolve,reject)=>{navigator.geolocation.getCurrentPosition(resolve,reject,{enableHighAccuracy:true,timeout:10000,maximumAge:0});});coords=[position.coords.latitude,position.coords.longitude];console.log('Використання координат геолокації:',coords);}catch(err){console.error('Помилка отримання геолокації:',err);setError('Не вдалося отримати геолокацію.');return;}}}else if(cityName in cityCoordinates){coords=cityCoordinates[cityName];console.log(`Використання координат для ${cityName}:`,coords);}else{try{const response=await axios.get(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(cityName)}&countrycodes=ua`);if(response.data.length>0){coords=[parseFloat(response.data[0].lat),parseFloat(response.data[0].lon)];console.log(`Отримані координати для ${cityName}:`,coords);}else{console.log(`Координати для ${cityName} не знайдено`);return;}}catch(err){console.error('Помилка отримання координат міста:',err);setError('Не вдалося знайти координати міста.');return;}}// Анімація переміщення мапи\nfullScreenMapRef.current.flyTo(coords,zoom,{animate:true,duration:1});// Оновлення маркерів\nfullScreenMarkersRef.current.forEach(marker=>marker.remove());fullScreenMarkersRef.current=[];if(data.storeLocations.length>0){fullScreenMarkersRef.current=data.storeLocations.map(storeLocation=>{const marker=L.marker([storeLocation.latitude,storeLocation.longitude],{icon:L.icon({iconUrl:'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',iconRetinaUrl:'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',shadowUrl:'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})}).addTo(fullScreenMapRef.current);marker.bindTooltip(storeLocation.store_name,{permanent:true,direction:'top',offset:[0,-40],className:'store-label'});return marker;});const cityStoreLocations=data.storeLocations.filter(storeLocation=>{const R=6371;const lat1=coords[0]*Math.PI/180;const lat2=storeLocation.latitude*Math.PI/180;const deltaLat=(storeLocation.latitude-coords[0])*Math.PI/180;const deltaLon=(storeLocation.longitude-coords[1])*Math.PI/180;const a=Math.sin(deltaLat/2)**2+Math.cos(lat1)*Math.cos(lat2)*Math.sin(deltaLon/2)**2;const c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));const distance=R*c;return distance<5;});if(cityStoreLocations.length>0){const bounds=L.latLngBounds(cityStoreLocations.map(loc=>[loc.latitude,loc.longitude]));fullScreenMapRef.current.fitBounds(bounds,{padding:[20,20],maxZoom:15});}else{fullScreenMapRef.current.setView(coords,zoom);}}setShowCityPopup(false);setCitySearch('');};const filteredCities=citySearch?data.cities.filter(city=>city.name_ua.toLowerCase().includes(citySearch.toLowerCase())):[...data.cities.filter(city=>topCities.slice(0,-1).includes(city.name_ua)),{id:'geolocation',name_ua:'За розташуванням'}].slice(0,10);useEffect(()=>{if(isMapFullScreen){setTimeout(()=>{initializeFullScreenMap();},100);}return()=>{if(fullScreenMapRef.current){console.log('Очищення повноекранної мапи');fullScreenMapRef.current.remove();fullScreenMapRef.current=null;fullScreenMarkersRef.current.forEach(marker=>marker.remove());fullScreenMarkersRef.current=[];}};},[isMapFullScreen,initializeFullScreenMap]);const images=data.product&&data.product.images&&data.product.images.length>0?data.product.images:['/img/placeholder.webp'];const handlePrevImage=useCallback(e=>{e.stopPropagation();setDirection('left');setPrevImageIndex(currentImageIndex);setCurrentImageIndex(prev=>prev===0?images.length-1:prev-1);setTimeout(()=>{setPrevImageIndex(null);setDirection(null);},500);},[currentImageIndex,images.length]);const handleNextImage=useCallback(e=>{e.stopPropagation();setDirection('right');setPrevImageIndex(currentImageIndex);setCurrentImageIndex(prev=>prev===images.length-1?0:prev+1);setTimeout(()=>{setPrevImageIndex(null);setDirection(null);},500);},[currentImageIndex,images.length]);useEffect(()=>{if(!data.product)return;const handleKeyDown=e=>{if(!isFullScreen&&!isMapFullScreen)return;if(e.key==='ArrowLeft'&&isFullScreen){handlePrevImage(e);}else if(e.key==='ArrowRight'&&isFullScreen){handleNextImage(e);}else if(e.key==='Escape'){setIsFullScreen(false);setIsMapFullScreen(false);setShowCityPopup(false);setCitySearch('');}};window.addEventListener('keydown',handleKeyDown);return()=>window.removeEventListener('keydown',handleKeyDown);},[isFullScreen,isMapFullScreen,data.product,handlePrevImage,handleNextImage]);const handleSaveToggle=async e=>{e.preventDefault();if(!token){setShowLoginPrompt(true);setTimeout(()=>{setShowLoginPrompt(false);},3000);return;}try{if(isSaved){await axios.delete(`https://price-ua-react-backend.onrender.com/saved-products/${productId}`,{headers:{Authorization:`Bearer ${token}`,'Content-Type':'application/json'}});setIsSaved(false);}else{await axios.post('https://price-ua-react-backend.onrender.com/saved-products',{productId},{headers:{Authorization:`Bearer ${token}`,'Content-Type':'application/json'}});setIsSaved(true);}}catch(err){console.error('Помилка перемикання статусу збереження:',err);setError('Не вдалося змінити статус збереження товару.');}};const handleTrashClick=()=>{setShowDeleteModal(true);};const handleEditClick=()=>{clearError();navigate(`/admin/product-edit?productId=${productId}`);};const handleDeleteConfirm=async()=>{if(!token||!productId)return;try{await axios.delete(`https://price-ua-react-backend.onrender.com/admin/product/${productId}`,{headers:{Authorization:`Bearer ${token}`,'Content-Type':'application/json'}});setShowDeleteModal(false);clearError();navigate('/products');}catch(err){console.error('Помилка видалення товару:',err);setError('Не вдалося видалити товар.');setShowDeleteModal(false);}};const handleDeleteCancel=()=>{setShowDeleteModal(false);};const handleLoginRedirect=()=>{clearError();navigate('/login');};const toggleMapFullScreen=event=>{if(isDragging){console.log('Ігнорування кліку через перетягування');return;}console.log('Перемикання повноекранної мапи');setIsMapFullScreen(!isMapFullScreen);setShowCityPopup(false);setCitySearch('');};if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"loading-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"spinner-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u0417\\u0430\\u0432\\u0430\\u043D\\u0442\\u0430\\u0436\\u0435\\u043D\\u043D\\u044F...\"})]})});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error.message||error});}if(!data.product){setError('Товар не знайдено');return null;}const handleImageClick=index=>{if(index!==currentImageIndex){setDirection(index>currentImageIndex?'right':'left');setPrevImageIndex(currentImageIndex);setCurrentImageIndex(index);setTimeout(()=>{setPrevImageIndex(null);setDirection(null);},500);}};const toggleFullScreen=()=>{setIsFullScreen(!isFullScreen);if(isFullScreen){setPrevImageIndex(null);setDirection(null);}};const renderStars=rating=>{const stars=[];const fullStars=Math.floor(rating);const hasHalfStar=rating%1>=0.5;for(let i=0;i<5;i++){if(i<fullStars){stars.push(/*#__PURE__*/_jsx(\"span\",{className:\"star full\",children:\"\\u2605\"},i));}else if(i===fullStars&&hasHalfStar){stars.push(/*#__PURE__*/_jsx(\"span\",{className:\"star half\",children:\"\\u2605\"},i));}else{stars.push(/*#__PURE__*/_jsx(\"span\",{className:\"star empty\",children:\"\\u2606\"},i));}}return stars;};const scrollToSection=ref=>{ref.current.scrollIntoView({behavior:'smooth'});};const featureList=[{key:'Бренд',value:(_data$product$feature=data.product.features)===null||_data$product$feature===void 0?void 0:_data$product$feature.brand},{key:'Країна виробництва',value:(_data$product$feature2=data.product.features)===null||_data$product$feature2===void 0?void 0:_data$product$feature2.country},{key:'Вид',value:(_data$product$feature3=data.product.features)===null||_data$product$feature3===void 0?void 0:_data$product$feature3.type},{key:'Клас',value:(_data$product$feature4=data.product.features)===null||_data$product$feature4===void 0?void 0:_data$product$feature4.class},{key:'Тип волосся / проблема',value:(_data$product$feature5=data.product.features)===null||_data$product$feature5===void 0?void 0:_data$product$feature5.hairType},{key:'Особливості',value:(_data$product$feature6=data.product.features)===null||_data$product$feature6===void 0?void 0:_data$product$feature6.features},{key:'Група товару',value:(_data$product$feature7=data.product.features)===null||_data$product$feature7===void 0?void 0:_data$product$feature7.category},{key:'Призначення',value:(_data$product$feature8=data.product.features)===null||_data$product$feature8===void 0?void 0:_data$product$feature8.purpose},{key:'Стать',value:(_data$product$feature9=data.product.features)===null||_data$product$feature9===void 0?void 0:_data$product$feature9.gender},{key:'Активний компонент',value:(_data$product$feature10=data.product.features)===null||_data$product$feature10===void 0?void 0:_data$product$feature10.active_ingredients}].filter(feature=>feature.value);const renderFeatureDescription=desc=>{if(!desc)return null;const descSections=desc.split('\\n\\n');return descSections.map((section,index)=>{if(section.startsWith('**')&&section.endsWith('**')){const title=section.slice(2,-2);return/*#__PURE__*/_jsx(\"h4\",{className:\"description-section-title\",children:title},index);}return/*#__PURE__*/_jsx(\"p\",{className:\"description-section-text\",children:section},index);});};const getMinPrice=()=>{if(!data.product.store_prices||data.product.store_prices.length===0)return'Н/Д';return Math.min(...data.product.store_prices.map(sp=>sp.price))+' грн';};return/*#__PURE__*/_jsxs(\"div\",{className:\"product-detail\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"tabs\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"tabs-left\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"tab-button\",onClick:()=>scrollToSection(featuresRef),\"aria-label\":\"\\u041F\\u0435\\u0440\\u0435\\u0439\\u0442\\u0438 \\u0434\\u043E \\u0445\\u0430\\u0440\\u0430\\u043A\\u0442\\u0435\\u0440\\u0438\\u0441\\u0442\\u0438\\u043A\",children:\"\\u0425\\u0430\\u0440\\u0430\\u043A\\u0442\\u0435\\u0440\\u0438\\u0441\\u0442\\u0438\\u043A\\u0438\"}),/*#__PURE__*/_jsx(\"button\",{className:\"tab-button\",onClick:()=>scrollToSection(descriptionRef),\"aria-label\":\"\\u041F\\u0435\\u0440\\u0435\\u0439\\u0442\\u0438 \\u0434\\u043E \\u043E\\u043F\\u0438\\u0441\\u0443 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0443\",children:\"\\u041E\\u043F\\u0438\\u0441 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0443\"}),/*#__PURE__*/_jsx(\"button\",{className:\"tab-button\",onClick:()=>scrollToSection(storePricesRef),\"aria-label\":\"\\u041F\\u0435\\u0440\\u0435\\u0439\\u0442\\u0438 \\u0434\\u043E \\u0446\\u0456\\u043D \\u0443 \\u043C\\u0430\\u0433\\u0430\\u0437\\u0438\\u043D\\u0430\\u0445\",children:\"\\u0426\\u0456\\u043D\\u0438 \\u0432 \\u043C\\u0430\\u0433\\u0430\\u0437\\u0438\\u043D\\u0430\\u0445\"})]}),isAdmin&&/*#__PURE__*/_jsxs(\"div\",{className:\"admin-actions\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"edit-icon-product\",onClick:handleEditClick,title:\"\\u0420\\u0435\\u0434\\u0430\\u0433\\u0443\\u0432\\u0430\\u0442\\u0438 \\u0442\\u043E\\u0432\\u0430\\u0440\",children:/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"#1976d2\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"trash-icon-product\",onClick:handleTrashClick,title:\"\\u0412\\u0438\\u0434\\u0430\\u043B\\u0438\\u0442\\u0438 \\u0442\\u043E\\u0432\\u0430\\u0440\",children:/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"#ff0000\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"polyline\",{points:\"3 6 5 6 21 6\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"10\",y1:\"11\",x2:\"10\",y2:\"17\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"14\",y1:\"11\",x2:\"14\",y2:\"17\"})]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"image-gallery\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"thumbnail-gallery\",children:[images.slice(0,4).map((img,index)=>/*#__PURE__*/_jsx(\"div\",{className:`thumbnail ${index===currentImageIndex?'active':''}`,onClick:()=>handleImageClick(index),children:/*#__PURE__*/_jsx(\"img\",{src:img,alt:`${data.product.name} thumbnail ${index+1}`,onError:e=>{console.log(`Помилка завантаження зображення: ${img}`);e.target.src='/img/placeholder.webp';}})},index)),images.length>4&&/*#__PURE__*/_jsxs(\"div\",{className:\"thumbnail more-images\",onClick:()=>handleImageClick(4),children:[/*#__PURE__*/_jsx(\"img\",{src:images[4],alt:`${data.product.name} more`,onError:e=>{console.log(`Помилка завантаження зображення: ${images[4]}`);e.target.src='/img/placeholder.webp';}}),/*#__PURE__*/_jsxs(\"span\",{className:\"more-count\",children:[\"+\",images.length-4]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"main-image-wrapper\",onClick:toggleFullScreen,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"image-container\",children:[prevImageIndex!==null&&/*#__PURE__*/_jsx(\"img\",{src:images[prevImageIndex],alt:`${data.product.name} ${prevImageIndex+1}`,className:`main-image main-image-prev ${direction==='right'?'slide-out-left':'slide-out-right'}`,onError:e=>{console.log(`Помилка завантаження зображення: ${images[prevImageIndex]}`);e.target.src='/img/placeholder.webp';}}),/*#__PURE__*/_jsx(\"img\",{src:images[currentImageIndex],alt:`${data.product.name} ${currentImageIndex+1}`,className:`main-image ${direction==='right'?'slide-in-right':direction==='left'?'slide-in-left':''}`,onError:e=>{console.log(`Помилка завантаження зображення: ${images[currentImageIndex]}`);e.target.src='/img/placeholder.webp';}})]}),images.length>1&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"arrow prev-arrow\",onClick:handlePrevImage,children:/*#__PURE__*/_jsx(\"svg\",{width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:\"white\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6l-1.41-1.41z\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"arrow next-arrow\",onClick:handleNextImage,children:/*#__PURE__*/_jsx(\"svg\",{width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:\"white\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6l-1.41-1.41z\"})})})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-info\",children:[/*#__PURE__*/_jsx(\"h2\",{children:data.product.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-meta\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"rating\",children:renderStars(data.product.rating||0)}),/*#__PURE__*/_jsxs(\"div\",{className:\"views\",children:[data.product.views||0,\" \\u043F\\u0435\\u0440\\u0435\\u0433\\u043B\\u044F\\u0434\\u0456\\u0432\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-code\",children:[\"\\u041A\\u043E\\u0434: \",data.product.code||'Н/Д']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"price-container\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"price\",children:getMinPrice()}),/*#__PURE__*/_jsx(\"button\",{className:\"price-view-button\",onClick:()=>scrollToSection(storePricesRef),\"aria-label\":\"\\u041F\\u0435\\u0440\\u0435\\u0439\\u0442\\u0438 \\u0434\\u043E \\u0446\\u0456\\u043D \\u0443 \\u043C\\u0430\\u0433\\u0430\\u0437\\u0438\\u043D\\u0430\\u0445\",children:\"\\u041F\\u0435\\u0440\\u0435\\u0433\\u043B\\u044F\\u0434 \\u0446\\u0456\\u043D\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"heart-container\",children:[/*#__PURE__*/_jsx(\"span\",{className:`product-detail-heart ${isSaved?'saved':''}`,onClick:handleSaveToggle,\"aria-label\":isSaved?'Видалити з бажаного':'Додати до бажаного',children:isSaved?/*#__PURE__*/_jsx(\"svg\",{width:\"36\",height:\"36\",viewBox:\"0 0 24 24\",fill:\"#ff6f61\",className:\"heart-svg\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\"})}):/*#__PURE__*/_jsx(\"svg\",{width:\"36\",height:\"36\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"#ff6f61\",strokeWidth:\"2\",className:\"heart-svg\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\"})})}),showLoginPrompt&&/*#__PURE__*/_jsxs(\"span\",{className:\"login-prompt\",children:[\"\\u0423\\u0432\\u0456\\u0439\\u0434\\u0456\\u0442\\u044C \\u0432 \",/*#__PURE__*/_jsx(Link,{to:\"/login\",className:\"login-link\",onClick:handleLoginRedirect,children:\"\\u0430\\u043A\\u043A\\u0430\\u0443\\u043D\\u0442\"}),\" \\u0449\\u043E\\u0431 \\u0434\\u043E\\u0434\\u0430\\u0442\\u0438 \\u0434\\u043E \\u0431\\u0430\\u0436\\u0430\\u043D\\u043E\\u0433\\u043E\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"map-container\",onClick:toggleMapFullScreen,children:/*#__PURE__*/_jsx(\"div\",{ref:mapContainerRef,className:\"map\",style:{height:'200px',width:'100%'}})}),/*#__PURE__*/_jsxs(\"p\",{className:\"volume\",children:[\"\\u041E\\u0431'\\u0454\\u043C: \",data.product.volume||'Н/Д']})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-features\",ref:featuresRef,children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u0425\\u0430\\u0440\\u0430\\u043A\\u0442\\u0435\\u0440\\u0438\\u0441\\u0442\\u0438\\u043A\\u0438\"}),featureList.length>0?/*#__PURE__*/_jsx(\"ul\",{children:featureList.map((feature,index)=>/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"feature-key\",children:feature.key}),/*#__PURE__*/_jsx(\"span\",{className:\"feature-value\",children:feature.value})]},index))}):/*#__PURE__*/_jsx(\"p\",{children:\"\\u0425\\u0430\\u0440\\u0430\\u043A\\u0442\\u0435\\u0440\\u0438\\u0441\\u0442\\u0438\\u043A\\u0438 \\u0432\\u0456\\u0434\\u0441\\u0443\\u0442\\u043D\\u0456\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-description\",ref:descriptionRef,children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u041E\\u043F\\u0438\\u0441 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0443\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"description-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u041E\\u043F\\u0438\\u0441\"}),data.product.description_full?renderFeatureDescription(data.product.description_full):/*#__PURE__*/_jsx(\"p\",{children:\"\\u041E\\u043F\\u0438\\u0441 \\u0432\\u0456\\u0434\\u0441\\u0443\\u0442\\u043D\\u0456\\u0439\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"description-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u0421\\u043A\\u043B\\u0430\\u0434\"}),/*#__PURE__*/_jsx(\"p\",{children:data.product.composition||'Н/Д'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"description-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u0412\\u0438\\u043A\\u043E\\u0440\\u0438\\u0441\\u0442\\u0430\\u043D\\u043D\\u044F\"}),/*#__PURE__*/_jsx(\"p\",{children:data.product.usage||'Н/Д'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"store-prices\",ref:storePricesRef,children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u0426\\u0456\\u043D\\u0438 \\u0432 \\u043C\\u0430\\u0433\\u0430\\u0437\\u0438\\u043D\\u0430\\u0445\"}),/*#__PURE__*/_jsx(\"div\",{className:\"store-list\",children:((_data$product$store_p=data.product.store_prices)===null||_data$product$store_p===void 0?void 0:_data$product$store_p.length)>0?data.product.store_prices.map((store,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"store-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"store-name-logo\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"store-name\",children:store.name}),/*#__PURE__*/_jsx(\"img\",{src:store.logo,alt:`${store.name} logo`,className:\"store-logo\",onError:e=>{console.log(`Помилка завантаження логотипу: ${store.logo}`);e.target.src='/img/placeholder.webp';}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"store-details\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"store-years\",children:[\"\\u2713 \\u0417 \\u043D\\u0430\\u043C\\u0438 \\u0431\\u0456\\u043B\\u044C\\u0448\\u0435 \",store.years_with_us||'-',\" \\u0440\\u043E\\u043A\\u0456\\u0432\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"store-delivery\",children:[\"\\u2022 \\u0414\\u043E\\u0441\\u0442\\u0430\\u0432\\u043A\\u0430: \",store.delivery]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"store-price-buy\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"store-price\",children:[store.price,\" \\u0433\\u0440\\u043D\"]}),/*#__PURE__*/_jsx(\"a\",{href:store.link||'#',target:\"_blank\",rel:\"noopener noreferrer\",children:/*#__PURE__*/_jsx(\"button\",{className:\"buy-button\",children:\"\\u041A\\u0443\\u043F\\u0438\\u0442\\u0438\"})})]})]},index)):/*#__PURE__*/_jsx(\"p\",{children:\"\\u0426\\u0456\\u043D\\u0438 \\u0432 \\u043C\\u0430\\u0433\\u0430\\u0437\\u0438\\u043D\\u0430\\u0445 \\u0432\\u0456\\u0434\\u0441\\u0443\\u0442\\u043D\\u0456\"})})]}),isFullScreen&&/*#__PURE__*/_jsx(\"div\",{className:\"fullscreen-modal\",onClick:toggleFullScreen,children:/*#__PURE__*/_jsxs(\"div\",{className:\"fullscreen-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"image-container\",children:[prevImageIndex&&/*#__PURE__*/_jsx(\"img\",{src:images[prevImageIndex],alt:`${data.product.name} fullscreen ${prevImageIndex+1}`,className:`fullscreen-image fullscreen-image-prev ${direction==='right'?'slide-out-left':'slide-out-right'}`,onError:e=>{console.log(`Помилка завантаження зображення: ${images[prevImageIndex]}`);e.target.src='/img/placeholder.webp';}}),/*#__PURE__*/_jsx(\"img\",{src:images[currentImageIndex],alt:`${data.product.name} fullscreen ${currentImageIndex+1}`,className:`fullscreen-image ${direction==='right'?'slide-in-right':direction==='left'?'slide-in-left':''}`,onError:e=>{console.log(`Помилка завантаження зображення: ${images[currentImageIndex]}`);e.target.src='/img/placeholder.webp';}})]}),images.length>1&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"fullscreen-arrow fullscreen-prev\",onClick:e=>{e.stopPropagation();handlePrevImage(e);},children:/*#__PURE__*/_jsx(\"svg\",{width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"white\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6l-1.41-1.41z\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"fullscreen-arrow fullscreen-next\",onClick:e=>{e.stopPropagation();handleNextImage(e);},children:/*#__PURE__*/_jsx(\"svg\",{width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"white\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6l-1.41-1.41z\"})})})]}),/*#__PURE__*/_jsx(\"button\",{className:\"close-fullscreen\",onClick:toggleFullScreen,children:\"\\u2715\"})]})}),isMapFullScreen&&/*#__PURE__*/_jsx(\"div\",{className:\"fullscreen-map-modal\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"fullscreen-map-content\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{position:'absolute',top:'20px',left:'20px',zIndex:1001,display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u041F\\u043E\\u0448\\u0443\\u043A \\u043C\\u0456\\u0441\\u0442\\u0430...\",value:citySearch,onChange:e=>setCitySearch(e.target.value),className:\"city-map-search-input\",onClick:e=>{e.stopPropagation();setShowCityPopup(true);}}),showCityPopup&&/*#__PURE__*/_jsx(\"div\",{className:`city-map-popup ${showCityPopup?'open':''}`,ref:cityPopupRef,children:/*#__PURE__*/_jsx(\"div\",{className:\"city-list\",children:filteredCities.map(city=>/*#__PURE__*/_jsx(\"div\",{className:\"city-item\",onClick:()=>handleCitySelect(city.name_ua),children:city.name_ua},city.id))})})]}),/*#__PURE__*/_jsx(\"div\",{ref:fullScreenMapContainerRef,className:\"fullscreen-map\",style:{height:'100%'}}),/*#__PURE__*/_jsx(\"button\",{className:\"close-fullscreen-map\",onClick:toggleMapFullScreen,children:\"\\u2715\"})]})}),showDeleteModal&&/*#__PURE__*/_jsx(\"div\",{className:\"delete-modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"delete-modal\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0412\\u0438 \\u0442\\u043E\\u0447\\u043D\\u043E \\u0445\\u043E\\u0447\\u0435\\u0442\\u0435 \\u0432\\u0438\\u0434\\u0430\\u043B\\u0438\\u0442\\u0438 \\u0442\\u043E\\u0432\\u0430\\u0440 \\\"\",data.product.name,\" (\",data.product.id,\")\\\"?\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"delete-modal-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"delete-confirm-btn\",onClick:handleDeleteConfirm,children:\"\\u0422\\u0430\\u043A\"}),/*#__PURE__*/_jsx(\"button\",{className:\"delete-cancel-btn\",onClick:handleDeleteCancel,children:\"\\u041D\\u0456\"})]})]})})]});}export default ProductDetail;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","useMemo","useParams","useNavigate","Link","axios","useError","L","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Icon","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","iconUrl","shadowUrl","ProductDetail","_data$product$feature","_data$product$feature2","_data$product$feature3","_data$product$feature4","_data$product$feature5","_data$product$feature6","_data$product$feature7","_data$product$feature8","_data$product$feature9","_data$product$feature10","_data$product$store_p","productId","navigate","setError","clearError","data","setData","product","storeLocations","cities","isLoading","setIsLoading","error","setLocalError","currentImageIndex","setCurrentImageIndex","prevImageIndex","setPrevImageIndex","direction","setDirection","isFullScreen","setIsFullScreen","isSaved","setIsSaved","showLoginPrompt","setShowLoginPrompt","showDeleteModal","setShowDeleteModal","isMapFullScreen","setIsMapFullScreen","isDragging","setIsDragging","citySearch","setCitySearch","showCityPopup","setShowCityPopup","cityPopupRef","featuresRef","descriptionRef","storePricesRef","mapRef","mapContainerRef","fullScreenMapRef","fullScreenMapContainerRef","markersRef","fullScreenMarkersRef","token","localStorage","getItem","user","JSON","parse","isAdmin","is_admin","userLocation","cityCoordinates","topCities","fetchInitialData","console","log","productResponse","citiesResponse","storeLocationsResponse","Promise","all","get","headers","params","id","length","err","checkSavedStatus","response","Authorization","getDefaultCoordinates","coords","zoom","encodeURIComponent","parseFloat","lat","lon","navigator","geolocation","position","resolve","reject","getCurrentPosition","enableHighAccuracy","timeout","maximumAge","latitude","longitude","initializeInlineMap","current","offsetHeight","offsetWidth","warn","setTimeout","map","center","scrollWheelZoom","dragging","tileLayer","attribution","addTo","on","forEach","marker","remove","storeLocation","icon","iconSize","iconAnchor","popupAnchor","shadowSize","bindTooltip","store_name","permanent","offset","className","cityStoreLocations","filter","R","lat1","Math","PI","lat2","deltaLat","deltaLon","a","sin","cos","c","atan2","sqrt","distance","bounds","latLngBounds","loc","fitBounds","padding","maxZoom","setView","invalidateSize","off","handleClickOutside","event","contains","target","classList","document","addEventListener","removeEventListener","initializeFullScreenMap","handleCitySelect","cityName","flyTo","animate","duration","filteredCities","city","name_ua","toLowerCase","includes","slice","images","handlePrevImage","e","stopPropagation","prev","handleNextImage","handleKeyDown","key","window","handleSaveToggle","preventDefault","delete","post","handleTrashClick","handleEditClick","handleDeleteConfirm","handleDeleteCancel","handleLoginRedirect","toggleMapFullScreen","children","message","handleImageClick","index","toggleFullScreen","renderStars","rating","stars","fullStars","floor","hasHalfStar","i","push","scrollToSection","ref","scrollIntoView","behavior","featureList","value","features","brand","country","type","class","hairType","category","purpose","gender","active_ingredients","feature","renderFeatureDescription","desc","descSections","split","section","startsWith","endsWith","title","getMinPrice","store_prices","min","sp","price","onClick","xmlns","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","d","points","x1","y1","x2","y2","img","src","alt","name","onError","views","code","to","style","volume","description_full","composition","usage","store","logo","years_with_us","delivery","href","link","rel","top","left","zIndex","display","alignItems","placeholder","onChange"],"sources":["C:/Users/pushy/Documents/GitHub/price-ua-react/price-ua-react-frontend/src/components/ProductDetail.js"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef, useMemo } from 'react';\r\nimport { useParams, useNavigate, Link } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { useError } from './ErrorContext';\r\nimport L from 'leaflet';\r\nimport 'leaflet/dist/leaflet.css';\r\nimport './ProductDetail.css';\r\nimport './ProductList.css';\r\n\r\n// Виправлення проблеми з іконками Leaflet\r\ndelete L.Icon.Default.prototype._getIconUrl;\r\nL.Icon.Default.mergeOptions({\r\n  iconRetinaUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',\r\n  iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',\r\n  shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',\r\n});\r\n\r\nfunction ProductDetail() {\r\n  const { productId } = useParams();\r\n  const navigate = useNavigate();\r\n  const { setError, clearError } = useError();\r\n  const [data, setData] = useState({\r\n    product: null,\r\n    storeLocations: [],\r\n    cities: [],\r\n  });\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setLocalError] = useState(null);\r\n  const [currentImageIndex, setCurrentImageIndex] = useState(0);\r\n  const [prevImageIndex, setPrevImageIndex] = useState(null);\r\n  const [direction, setDirection] = useState(null);\r\n  const [isFullScreen, setIsFullScreen] = useState(false);\r\n  const [isSaved, setIsSaved] = useState(false);\r\n  const [showLoginPrompt, setShowLoginPrompt] = useState(false);\r\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n  const [isMapFullScreen, setIsMapFullScreen] = useState(false);\r\n  const [isDragging, setIsDragging] = useState(false);\r\n  const [citySearch, setCitySearch] = useState('');\r\n  const [showCityPopup, setShowCityPopup] = useState(false);\r\n  const cityPopupRef = useRef(null);\r\n\r\n  const featuresRef = useRef(null);\r\n  const descriptionRef = useRef(null);\r\n  const storePricesRef = useRef(null);\r\n  const mapRef = useRef(null);\r\n  const mapContainerRef = useRef(null);\r\n  const fullScreenMapRef = useRef(null);\r\n  const fullScreenMapContainerRef = useRef(null);\r\n  const markersRef = useRef([]);\r\n  const fullScreenMarkersRef = useRef([]);\r\n\r\n  const token = localStorage.getItem('token');\r\n  const user = JSON.parse(localStorage.getItem('user')) || null;\r\n  const isAdmin = user && user.is_admin;\r\n  const userLocation = localStorage.getItem('userLocationStatus') || 'Виберіть місто';\r\n\r\n  const cityCoordinates = useMemo(() => ({\r\n    \"Вінниця\": [49.2331, 28.4682],\r\n    \"Дніпро\": [48.4647, 35.0462],\r\n    \"Донецьк\": [48.0159, 37.8028],\r\n    \"Житомир\": [50.2547, 28.6587],\r\n    \"Запоріжжя\": [47.8388, 35.1396],\r\n    \"Івано-Франківськ\": [48.9226, 24.7111],\r\n    \"Кропивницький\": [48.5079, 32.2605],\r\n    \"Луганськ\": [48.5679, 39.3105],\r\n    \"Луцьк\": [50.7463, 25.3355],\r\n    \"Одеса\": [46.4825, 30.7233],\r\n    \"Черкаси\": [49.4444, 32.0597],\r\n    \"Чернівці\": [48.2923, 25.9354],\r\n    \"Чернігів\": [51.4982, 31.2893],\r\n    \"Біла Церква\": [49.7927, 30.1126],\r\n    \"Бердянськ\": [46.7515, 36.7994],\r\n    \"Бердичів\": [49.8965, 28.5855],\r\n    \"Болехів\": [49.0588, 23.8600],\r\n    \"Борислав\": [49.2864, 23.4246],\r\n    \"Бориспіль\": [50.3543, 30.9562],\r\n    \"Боярка\": [50.3428, 30.2872],\r\n    \"Бровари\": [50.5048, 30.7146],\r\n    \"Бурштин\": [49.2500, 24.6167],\r\n    \"Васильків\": [50.1833, 30.3167],\r\n    \"Вінники\": [49.8167, 24.0333],\r\n    \"Вишгород\": [50.5833, 30.4833],\r\n    \"Вишневе\": [50.3925, 30.3667],\r\n    \"Вознесенськ\": [47.5667, 31.31610],\r\n    \"Волноваха\": [47.6000, 37.5167],\r\n    \"Волочиськ\": [49.2833, 26.1667],\r\n    \"Володимир-Волинський\": [50.8500, 24.3167],\r\n    \"Вугледар\": [47.7833, 37.2667],\r\n    \"Гайсин\": [48.8000, 29.4167],\r\n    \"Гнівань\": [49.1000, 28.3667],\r\n    \"Гола Пристань\": [46.5333, 32.5000],\r\n    \"Голубівка\": [48.3833, 38.9167],\r\n    \"Горішні Плавні\": [49.0167, 33.5667],\r\n    \"Городенка\": [48.6667, 25.5000],\r\n    \"Городок\": [49.1500, 27.2333],\r\n    \"Гостомель\": [50.5667, 30.2167],\r\n    \"Дніпрорудне\": [47.3833, 34.9833],\r\n    \"Добропілля\": [48.4500, 37.0833],\r\n    \"Долина\": [48.9667, 23.9500],\r\n    \"Дрогобич\": [49.3500, 23.5000],\r\n    \"Дубляни\": [49.9333, 24.2667],\r\n    \"Дубно\": [50.3833, 25.7500],\r\n    \"Енергодар\": [47.5000, 34.6333],\r\n    \"Жмеринка\": [49.0333, 28.1167],\r\n    \"Жовква\": [50.0667, 23.9667],\r\n    \"Жовті Води\": [48.3500, 33.5000],\r\n    \"Заліщики\": [48.6500, 25.7333],\r\n    \"Збруч\": [48.6167, 26.4833],\r\n    \"Знам’янка\": [48.7167, 32.6667],\r\n    \"Золотоноша\": [49.6833, 32.0333],\r\n    \"Золочів\": [49.8000, 24.9000],\r\n    \"Ізюм\": [49.2000, 37.2500],\r\n    \"Іллінці\": [49.1000, 29.2167],\r\n    \"Ірпінь\": [50.5167, 30.2167],\r\n    \"Калуш\": [49.0167, 24.3667],\r\n    \"Кам’янець-Подільський\": [48.6833, 26.5833],\r\n    \"Кам’янка\": [49.0333, 32.0833],\r\n    \"Канів\": [49.7500, 31.4833],\r\n    \"Карлівка\": [49.4333, 35.1333],\r\n    \"Каховка\": [46.8167, 33.4833],\r\n    \"Керч\": [45.3563, 36.4740],\r\n    \"Київ\": [50.4501, 30.5234],\r\n    \"Кіровоград\": [48.5079, 32.2605],\r\n    \"Ковель\": [51.2167, 24.7000],\r\n    \"Козятин\": [49.7167, 28.8167],\r\n    \"Коломия\": [48.5333, 25.0333],\r\n    \"Копичинці\": [48.8333, 25.8500],\r\n    \"Коростень\": [50.9667, 28.6500],\r\n    \"Коростишів\": [50.3167, 29.0500],\r\n    \"Косів\": [48.3167, 25.1000],\r\n    \"Костопіль\": [50.8833, 26.5333],\r\n    \"Краматорськ\": [48.7333, 37.6000],\r\n    \"Красилів\": [49.6500, 26.9667],\r\n    \"Кременчук\": [49.0833, 33.4167],\r\n    \"Кролевець\": [51.5333, 33.3833],\r\n    \"Кузнецовськ\": [51.3167, 25.8500],\r\n    \"Куп’янськ\": [49.7167, 37.6167],\r\n    \"Ладижин\": [48.6833, 29.2333],\r\n    \"Ланівці\": [49.8500, 26.0833],\r\n    \"Лебедин\": [50.6000, 34.4833],\r\n    \"Лиман\": [48.9833, 37.6167],\r\n    \"Липовець\": [49.2333, 29.0833],\r\n    \"Лисичанськ\": [48.9000, 38.4333],\r\n    \"Лозова\": [48.8833, 36.3167],\r\n    \"Лубни\": [50.0167, 32.9833],\r\n    \"Лутугине\": [48.4000, 39.2167],\r\n    \"Львів\": [49.8397, 24.0297],\r\n    \"Макіївка\": [48.0500, 37.9833],\r\n    \"Малин\": [50.7667, 29.2333],\r\n    \"Марганець\": [47.6333, 34.6333],\r\n    \"Маріуполь\": [47.0951, 37.5538],\r\n    \"Мелітополь\": [46.8500, 35.3667],\r\n    \"Мена\": [51.5667, 32.0833],\r\n    \"Миколаїв\": [46.9750, 31.9946],\r\n    \"Мирноград\": [48.3000, 37.2667],\r\n    \"Миронівка\": [49.6667, 30.6167],\r\n    \"Могилів-Подільський\": [48.4500, 27.7833],\r\n    \"Молочанськ\": [47.2000, 35.5833],\r\n    \"Монастириська\": [49.0833, 25.1667],\r\n    \"Мостиська\": [49.8000, 23.1500],\r\n    \"Мукачево\": [48.4333, 22.7167],\r\n    \"Надвірна\": [48.6333, 24.5833],\r\n    \"Ніжин\": [51.5167, 31.8833],\r\n    \"Нікополь\": [47.5667, 34.4000],\r\n    \"Нова Каховка\": [46.7500, 33.3667],\r\n    \"Нова Одеса\": [46.7500, 31.7500],\r\n    \"Новий Буг\": [47.6833, 32.5333],\r\n    \"Новоазовськ\": [47.1167, 38.7500],\r\n    \"Новоукраїнка\": [48.3167, 31.5167],\r\n    \"Носівка\": [50.6167, 31.5167],\r\n    \"Обухів\": [50.1000, 30.6167],\r\n    \"Овруч\": [51.3333, 28.8000],\r\n    \"Олевськ\": [51.0500, 27.6667],\r\n    \"Олександрія\": [48.6667, 33.1167],\r\n    \"Олександрівськ\": [47.9500, 33.2833],\r\n    \"Олешки\": [46.6333, 32.6167],\r\n    \"Острог\": [50.3333, 26.5167],\r\n    \"Павлоград\": [48.5333, 35.8667],\r\n    \"Первомайськ\": [50.3167, 31.5167],\r\n    \"Перевальськ\": [48.4333, 38.8333],\r\n    \"Перемишляни\": [49.6500, 24.5833],\r\n    \"Переяслав\": [50.0500, 31.4500],\r\n    \"Пирятин\": [50.2500, 32.5167],\r\n    \"Покров\": [47.6167, 33.5167],\r\n    \"Покровськ\": [48.2833, 37.1667],\r\n    \"Полонне\": [50.1167, 27.5167],\r\n    \"Полтава\": [49.5883, 34.5514],\r\n    \"Помічна\": [48.6167, 31.6167],\r\n    \"Прилуки\": [50.5833, 32.3833],\r\n    \"Пустомити\": [49.7167, 23.8833],\r\n    \"Радехів\": [50.2833, 24.6333],\r\n    \"Радомишль\": [50.4833, 29.2333],\r\n    \"Рені\": [45.4500, 28.2833],\r\n    \"Ржищів\": [50.0333, 30.9667],\r\n    \"Рівне\": [50.6199, 26.2516],\r\n    \"Рогатин\": [49.4167, 24.6167],\r\n    \"Рожище\": [50.9167, 25.2667],\r\n    \"Сарни\": [51.3333, 26.5833],\r\n    \"Свалява\": [48.5500, 22.9833],\r\n    \"Сватове\": [49.4167, 38.1500],\r\n    \"Світловодськ\": [49.0500, 33.2333],\r\n    \"Сєвєродонецьк\": [48.9333, 38.4833],\r\n    \"Семенівка\": [51.3333, 32.6000],\r\n    \"Середина-Буда\": [51.7500, 33.9833],\r\n    \"Синельникове\": [48.3167, 35.4833],\r\n    \"Славута\": [50.3000, 26.8667],\r\n    \"Славутич\": [51.5167, 30.7500],\r\n    \"Смела\": [49.1833, 31.8667],\r\n    \"Снігурівка\": [47.0833, 32.7667],\r\n    \"Сокаль\": [50.4833, 23.9833],\r\n    \"Сокиряни\": [48.4500, 27.4167],\r\n    \"Соледар\": [48.6833, 38.1000],\r\n    \"Сорокине\": [48.1500, 39.6167],\r\n    \"Старобільськ\": [49.2833, 38.9167],\r\n    \"Старокостянтинів\": [49.7500, 27.2167],\r\n    \"Стебник\": [49.2833, 23.5667],\r\n    \"Стрий\": [49.2500, 23.8500],\r\n    \"Судак\": [44.8500, 34.9667],\r\n    \"Суми\": [50.9077, 34.7981],\r\n    \"Таврійськ\": [46.7667, 33.3833],\r\n    \"Талалаївка\": [50.6833, 33.1833],\r\n    \"Тальне\": [48.8833, 29.9833],\r\n    \"Тараща\": [49.5667, 30.4833],\r\n    \"Тернопіль\": [49.5535, 25.5948],\r\n    \"Тетіїв\": [49.3833, 29.6167],\r\n    \"Тисмениця\": [48.9000, 24.8500],\r\n    \"Тлумач\": [48.8667, 24.9833],\r\n    \"Токмак\": [47.2500, 35.6667],\r\n    \"Тростянець\": [50.4833, 34.9667],\r\n    \"Трускавець\": [49.2833, 23.5000],\r\n    \"Тульчин\": [48.6667, 28.8500],\r\n    \"Угледар\": [47.7833, 37.2667],\r\n    \"Ужгород\": [48.6208, 22.2879],\r\n    \"Умань\": [48.7500, 30.2167],\r\n    \"Фастів\": [50.0833, 29.9167],\r\n    \"Феодосія\": [45.0333, 35.3667],\r\n    \"Харків\": [49.9935, 36.2304],\r\n    \"Херсон\": [46.6558, 32.6178],\r\n    \"Хмельницький\": [49.4216, 26.9918],\r\n    \"Хмільник\": [49.5667, 27.9667],\r\n    \"Ходорів\": [49.1667, 24.3167],\r\n    \"Хотин\": [48.5167, 26.4833],\r\n    \"Хрестівка\": [48.0500, 37.3167],\r\n    \"Христинівка\": [48.7833, 29.9667],\r\n    \"Хрустальний\": [48.1167, 38.9333],\r\n    \"Часів Яр\": [48.6000, 37.8500],\r\n    \"Червоноград\": [50.3833, 24.2167],\r\n    \"Чекалин\": [49.2333, 28.5833],\r\n    \"Чигирин\": [49.0833, 32.6500],\r\n    \"Чоп\": [48.4333, 22.2000],\r\n    \"Чортків\": [49.0167, 25.8000],\r\n    \"Чугуїв\": [50.5833, 36.6833],\r\n    \"Шепетівка\": [50.1833, 27.0667],\r\n    \"Шостка\": [51.8667, 33.4667],\r\n    \"Шумськ\": [50.2833, 26.0833],\r\n    \"Щастя\": [48.7333, 39.2333],\r\n    \"Южне\": [46.6167, 30.9833],\r\n    \"Яворів\": [49.9333, 23.3833],\r\n    \"Яготин\": [50.2500, 31.7667],\r\n    \"Ямпіль\": [48.2500, 29.0833],\r\n    \"Яремче\": [48.4500, 24.5500],\r\n  }), []);\r\n\r\n  // Топ-10 найбільших міст України, з останнім як \"За розташуванням\"\r\n  const topCities = [\r\n    'Київ', 'Харків', 'Одеса', 'Дніпро', 'Херсон',\r\n    'Запоріжжя', 'Львів', 'Кривий Ріг', 'Миколаїв', 'За розташуванням'\r\n  ];\r\n\r\n  // Функція для отримання початкових даних\r\n  const fetchInitialData = useCallback(async () => {\r\n    setIsLoading(true);\r\n    clearError();\r\n    try {\r\n      console.log('Завантаження початкових даних для товару:', productId);\r\n      const [productResponse, citiesResponse, storeLocationsResponse] = await Promise.all([\r\n        axios.get(`https://price-ua-react-backend.onrender.com/products/${productId}`, {\r\n          headers: { 'Content-Type': 'application/json' },\r\n        }),\r\n        axios.get('https://price-ua-react-backend.onrender.com/cities', {\r\n          headers: { 'Content-Type': 'application/json' },\r\n        }),\r\n        axios.get('https://price-ua-react-backend.onrender.com/store-locations', {\r\n          params: { productId },\r\n          headers: { 'Content-Type': 'application/json' },\r\n        }),\r\n      ]);\r\n\r\n      setData({\r\n        product: productResponse.data,\r\n        cities: citiesResponse.data,\r\n        storeLocations: storeLocationsResponse.data,\r\n      });\r\n      console.log('Початкові дані завантажено:', {\r\n        product: productResponse.data.id,\r\n        cities: citiesResponse.data.length,\r\n        storeLocations: storeLocationsResponse.data.length,\r\n      });\r\n    } catch (err) {\r\n      console.error('Помилка завантаження початкових даних:', err);\r\n      setError('Помилка завантаження даних. Перевірте підключення.');\r\n      setLocalError('Помилка завантаження даних. Перевірте підключення.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [productId, setError, clearError]);\r\n\r\n  useEffect(() => {\r\n    fetchInitialData();\r\n  }, [fetchInitialData]);\r\n\r\n  // Перевірка статусу збереження товару\r\n  const checkSavedStatus = useCallback(async () => {\r\n    if (!token) {\r\n      setIsSaved(false);\r\n      return;\r\n    }\r\n    try {\r\n      const response = await axios.get(`https://price-ua-react-backend.onrender.com/saved-products/${productId}`, {\r\n        headers: { Authorization: `Bearer ${token}`, 'Content-Type': 'application/json' },\r\n      });\r\n      setIsSaved(response.data.isSaved);\r\n    } catch (err) {\r\n      console.error('Помилка перевірки статусу збереження:', err);\r\n      setError('Не вдалося перевірити статус збереження товару.');\r\n    }\r\n  }, [productId, token, setError]);\r\n\r\n  useEffect(() => {\r\n    if (!isLoading && !error && data.product) {\r\n      checkSavedStatus();\r\n    }\r\n  }, [checkSavedStatus, isLoading, error, data.product]);\r\n\r\n  // Отримання координат за замовчуванням для мапи\r\n  const getDefaultCoordinates = useCallback(async () => {\r\n    let coords = [50.4501, 30.5234]; // За замовчуванням Київ\r\n    let zoom = 14;\r\n\r\n    if (userLocation && userLocation !== 'Виберіть місто' && userLocation !== 'denied') {\r\n      if (userLocation in cityCoordinates) {\r\n        coords = cityCoordinates[userLocation];\r\n        console.log(`Використання координат міста ${userLocation}:`, coords);\r\n      } else if (userLocation !== 'За розташуванням') {\r\n        try {\r\n          const response = await axios.get(\r\n            `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(userLocation)}&countrycodes=ua`\r\n          );\r\n          if (response.data.length > 0) {\r\n            coords = [parseFloat(response.data[0].lat), parseFloat(response.data[0].lon)];\r\n            console.log(`Отримані координати для ${userLocation}:`, coords);\r\n          }\r\n        } catch (err) {\r\n          console.error('Помилка отримання координат міста:', err);\r\n        }\r\n      } else if (navigator.geolocation) {\r\n        try {\r\n          const position = await new Promise((resolve, reject) => {\r\n            navigator.geolocation.getCurrentPosition(resolve, reject, {\r\n              enableHighAccuracy: true,\r\n              timeout: 10000,\r\n              maximumAge: 0,\r\n            });\r\n          });\r\n          coords = [position.coords.latitude, position.coords.longitude];\r\n          console.log('Використання координат геолокації:', coords);\r\n        } catch (err) {\r\n          console.error('Помилка отримання геолокації:', err);\r\n        }\r\n      }\r\n    }\r\n\r\n    return { coords, zoom };\r\n  }, [userLocation, cityCoordinates]);\r\n\r\n  // Ініціалізація вбудованої мапи\r\n  const initializeInlineMap = useCallback(async () => {\r\n    if (!mapContainerRef.current) {\r\n      console.error('Контейнер вбудованої мапи не знайдено');\r\n      return;\r\n    }\r\n\r\n    if (mapContainerRef.current.offsetHeight === 0 || mapContainerRef.current.offsetWidth === 0) {\r\n      console.warn('Контейнер мапи має нульові розміри');\r\n      setTimeout(() => initializeInlineMap(), 500);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const { coords, zoom } = await getDefaultCoordinates();\r\n      console.log('Ініціалізація вбудованої мапи з координатами:', coords, 'зум:', zoom);\r\n\r\n      mapRef.current = L.map(mapContainerRef.current, {\r\n        center: coords,\r\n        zoom: zoom,\r\n        scrollWheelZoom: false,\r\n        dragging: true,\r\n      });\r\n\r\n      const tileLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n        attribution: '© <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\r\n      }).addTo(mapRef.current);\r\n\r\n      tileLayer.on('tileerror', (error) => {\r\n        console.error('Помилка завантаження тайлів:', error);\r\n        setError('Помилка завантаження мапи. Перевірте підключення до мережі.');\r\n      });\r\n\r\n      mapRef.current.on('dragstart', () => {\r\n        console.log('Початок перетягування вбудованої мапи');\r\n        setIsDragging(true);\r\n      });\r\n      mapRef.current.on('dragend', () => {\r\n        console.log('Кінець перетягування вбудованої мапи');\r\n        setTimeout(() => setIsDragging(false), 100);\r\n      });\r\n\r\n      // Додавання маркерів\r\n      markersRef.current.forEach(marker => marker.remove());\r\n      markersRef.current = [];\r\n\r\n      if (data.storeLocations.length > 0) {\r\n        markersRef.current = data.storeLocations.map(storeLocation => {\r\n          const marker = L.marker([storeLocation.latitude, storeLocation.longitude], {\r\n            icon: L.icon({\r\n              iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',\r\n              iconRetinaUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',\r\n              shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',\r\n              iconSize: [25, 41],\r\n              iconAnchor: [12, 41],\r\n              popupAnchor: [1, -34],\r\n              shadowSize: [41, 41],\r\n            }),\r\n          }).addTo(mapRef.current);\r\n\r\n          marker.bindTooltip(storeLocation.store_name, {\r\n            permanent: true,\r\n            direction: 'top',\r\n            offset: [0, -40],\r\n            className: 'store-label',\r\n          });\r\n\r\n          return marker;\r\n        });\r\n\r\n        const cityStoreLocations = data.storeLocations.filter(storeLocation => {\r\n          const R = 6371;\r\n          const lat1 = coords[0] * Math.PI / 180;\r\n          const lat2 = storeLocation.latitude * Math.PI / 180;\r\n          const deltaLat = (storeLocation.latitude - coords[0]) * Math.PI / 180;\r\n          const deltaLon = (storeLocation.longitude - coords[1]) * Math.PI / 180;\r\n\r\n          const a = Math.sin(deltaLat / 2) ** 2 +\r\n                    Math.cos(lat1) * Math.cos(lat2) * Math.sin(deltaLon / 2) ** 2;\r\n          const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n          const distance = R * c;\r\n\r\n          return distance < 5;\r\n        });\r\n\r\n        if (cityStoreLocations.length > 0) {\r\n          const bounds = L.latLngBounds(cityStoreLocations.map(loc => [loc.latitude, loc.longitude]));\r\n          mapRef.current.fitBounds(bounds, { padding: [20, 20], maxZoom: 15 });\r\n          console.log('Мапа масштабована до магазинів у місті:', cityStoreLocations.length);\r\n        } else {\r\n          console.log('Немає магазинів у радіусі 5 км, центрування на місті:', userLocation);\r\n          mapRef.current.setView(coords, zoom);\r\n        }\r\n      } else {\r\n        console.log('Немає магазинів, центрування на місті:', userLocation);\r\n        mapRef.current.setView(coords, zoom);\r\n      }\r\n\r\n      setTimeout(() => {\r\n        if (mapRef.current) {\r\n          mapRef.current.invalidateSize();\r\n        }\r\n      }, 200);\r\n    } catch (err) {\r\n      console.error('Не вдалося ініціалізувати вбудовану мапу:', err);\r\n      setError('Не вдалося ініціалізувати мапу.');\r\n    }\r\n  }, [setError, data.storeLocations, userLocation, getDefaultCoordinates]);\r\n\r\n  // Ініціалізація вбудованої мапи лише один раз при монтуванні\r\n  useEffect(() => {\r\n    if (!isLoading && !error && data.product) {\r\n      initializeInlineMap();\r\n    }\r\n\r\n    return () => {\r\n      if (mapRef.current) {\r\n        console.log('Очищення вбудованої мапи');\r\n        mapRef.current.off('dragstart');\r\n        mapRef.current.off('dragend');\r\n        mapRef.current.remove();\r\n        mapRef.current = null;\r\n        markersRef.current.forEach(marker => marker.remove());\r\n        markersRef.current = [];\r\n      }\r\n    };\r\n  }, [isLoading, error, data.product, initializeInlineMap]);\r\n\r\n  // Обробка кліків поза попапом міста\r\n  useEffect(() => {\r\n    const handleClickOutside = (event) => {\r\n      if (cityPopupRef.current && !cityPopupRef.current.contains(event.target) && !event.target.classList.contains('city-search-input')) {\r\n        setShowCityPopup(false);\r\n        setCitySearch('');\r\n      }\r\n    };\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, []);\r\n\r\n  // Ініціалізація повноекранної мапи\r\n  const initializeFullScreenMap = useCallback(async () => {\r\n    if (!fullScreenMapContainerRef.current) {\r\n      console.error('Контейнер повноекранної мапи не знайдено');\r\n      return;\r\n    }\r\n\r\n    if (fullScreenMapContainerRef.current.offsetHeight === 0 || fullScreenMapContainerRef.current.offsetWidth === 0) {\r\n      console.warn('Контейнер повноекранної мапи має нульові розміри');\r\n      setTimeout(() => initializeFullScreenMap(), 500);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const { coords, zoom } = await getDefaultCoordinates();\r\n      console.log('Ініціалізація повноекранної мапи з координатами:', coords, 'зум:', zoom);\r\n\r\n      fullScreenMapRef.current = L.map(fullScreenMapContainerRef.current, {\r\n        center: coords,\r\n        zoom: zoom,\r\n        scrollWheelZoom: true,\r\n        dragging: true,\r\n      });\r\n\r\n      const tileLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n        attribution: '© <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\r\n      }).addTo(fullScreenMapRef.current);\r\n\r\n      tileLayer.on('tileerror', (error) => {\r\n        console.error('Помилка завантаження тайлів повноекранної мапи:', error);\r\n        setError('Помилка завантаження мапи.');\r\n      });\r\n\r\n      fullScreenMarkersRef.current.forEach(marker => marker.remove());\r\n      fullScreenMarkersRef.current = [];\r\n\r\n      if (data.storeLocations.length > 0) {\r\n        fullScreenMarkersRef.current = data.storeLocations.map(storeLocation => {\r\n          const marker = L.marker([storeLocation.latitude, storeLocation.longitude], {\r\n            icon: L.icon({\r\n              iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',\r\n              iconRetinaUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',\r\n              shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',\r\n              iconSize: [25, 41],\r\n              iconAnchor: [12, 41],\r\n              popupAnchor: [1, -34],\r\n              shadowSize: [41, 41],\r\n            }),\r\n          }).addTo(fullScreenMapRef.current);\r\n\r\n          marker.bindTooltip(storeLocation.store_name, {\r\n            permanent: true,\r\n            direction: 'top',\r\n            offset: [0, -40],\r\n            className: 'store-label',\r\n          });\r\n\r\n          return marker;\r\n        });\r\n\r\n        const cityStoreLocations = data.storeLocations.filter(storeLocation => {\r\n          const R = 6371;\r\n          const lat1 = coords[0] * Math.PI / 180;\r\n          const lat2 = storeLocation.latitude * Math.PI / 180;\r\n          const deltaLat = (storeLocation.latitude - coords[0]) * Math.PI / 180;\r\n          const deltaLon = (storeLocation.longitude - coords[1]) * Math.PI / 180;\r\n\r\n          const a = Math.sin(deltaLat / 2) ** 2 +\r\n                    Math.cos(lat1) * Math.cos(lat2) * Math.sin(deltaLon / 2) ** 2;\r\n          const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n          const distance = R * c;\r\n\r\n          return distance < 5;\r\n        });\r\n\r\n        if (cityStoreLocations.length > 0) {\r\n          const bounds = L.latLngBounds(cityStoreLocations.map(loc => [loc.latitude, loc.longitude]));\r\n          fullScreenMapRef.current.fitBounds(bounds, { padding: [20, 20], maxZoom: 15 });\r\n        } else {\r\n          fullScreenMapRef.current.setView(coords, zoom);\r\n        }\r\n      } else {\r\n        fullScreenMapRef.current.setView(coords, zoom);\r\n      }\r\n\r\n      setTimeout(() => {\r\n        if (fullScreenMapRef.current) {\r\n          fullScreenMapRef.current.invalidateSize();\r\n        }\r\n      }, 500);\r\n    } catch (err) {\r\n      console.error('Не вдалося ініціалізувати повноекранну мапу:', err);\r\n      setError('Не вдалося завантажити повноекранну мапу.');\r\n    }\r\n  }, [setError, data.storeLocations, getDefaultCoordinates]);\r\n\r\n  // Обробка вибору міста на повноекранній мапі\r\n  const handleCitySelect = async (cityName) => {\r\n    if (!fullScreenMapRef.current) return;\r\n\r\n    let coords = [50.4501, 30.5234]; // За замовчуванням Київ\r\n    let zoom = 14;\r\n\r\n    if (cityName === 'За розташуванням') {\r\n      if (navigator.geolocation) {\r\n        try {\r\n          const position = await new Promise((resolve, reject) => {\r\n            navigator.geolocation.getCurrentPosition(resolve, reject, {\r\n              enableHighAccuracy: true,\r\n              timeout: 10000,\r\n              maximumAge: 0,\r\n            });\r\n          });\r\n          coords = [position.coords.latitude, position.coords.longitude];\r\n          console.log('Використання координат геолокації:', coords);\r\n        } catch (err) {\r\n          console.error('Помилка отримання геолокації:', err);\r\n          setError('Не вдалося отримати геолокацію.');\r\n          return;\r\n        }\r\n      }\r\n    } else if (cityName in cityCoordinates) {\r\n      coords = cityCoordinates[cityName];\r\n      console.log(`Використання координат для ${cityName}:`, coords);\r\n    } else {\r\n      try {\r\n        const response = await axios.get(\r\n          `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(cityName)}&countrycodes=ua`\r\n        );\r\n        if (response.data.length > 0) {\r\n          coords = [parseFloat(response.data[0].lat), parseFloat(response.data[0].lon)];\r\n          console.log(`Отримані координати для ${cityName}:`, coords);\r\n        } else {\r\n          console.log(`Координати для ${cityName} не знайдено`);\r\n          return;\r\n        }\r\n      } catch (err) {\r\n        console.error('Помилка отримання координат міста:', err);\r\n        setError('Не вдалося знайти координати міста.');\r\n        return;\r\n      }\r\n    }\r\n\r\n    // Анімація переміщення мапи\r\n    fullScreenMapRef.current.flyTo(coords, zoom, {\r\n      animate: true,\r\n      duration: 1,\r\n    });\r\n\r\n    // Оновлення маркерів\r\n    fullScreenMarkersRef.current.forEach(marker => marker.remove());\r\n    fullScreenMarkersRef.current = [];\r\n\r\n    if (data.storeLocations.length > 0) {\r\n      fullScreenMarkersRef.current = data.storeLocations.map(storeLocation => {\r\n        const marker = L.marker([storeLocation.latitude, storeLocation.longitude], {\r\n          icon: L.icon({\r\n            iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',\r\n            iconRetinaUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',\r\n            shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',\r\n            iconSize: [25, 41],\r\n            iconAnchor: [12, 41],\r\n            popupAnchor: [1, -34],\r\n            shadowSize: [41, 41],\r\n          }),\r\n        }).addTo(fullScreenMapRef.current);\r\n\r\n        marker.bindTooltip(storeLocation.store_name, {\r\n          permanent: true,\r\n          direction: 'top',\r\n          offset: [0, -40],\r\n          className: 'store-label',\r\n        });\r\n\r\n        return marker;\r\n      });\r\n\r\n      const cityStoreLocations = data.storeLocations.filter(storeLocation => {\r\n        const R = 6371;\r\n        const lat1 = coords[0] * Math.PI / 180;\r\n        const lat2 = storeLocation.latitude * Math.PI / 180;\r\n        const deltaLat = (storeLocation.latitude - coords[0]) * Math.PI / 180;\r\n        const deltaLon = (storeLocation.longitude - coords[1]) * Math.PI / 180;\r\n\r\n        const a = Math.sin(deltaLat / 2) ** 2 +\r\n                  Math.cos(lat1) * Math.cos(lat2) * Math.sin(deltaLon / 2) ** 2;\r\n        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n        const distance = R * c;\r\n\r\n        return distance < 5;\r\n      });\r\n\r\n      if (cityStoreLocations.length > 0) {\r\n        const bounds = L.latLngBounds(cityStoreLocations.map(loc => [loc.latitude, loc.longitude]));\r\n        fullScreenMapRef.current.fitBounds(bounds, { padding: [20, 20], maxZoom: 15 });\r\n      } else {\r\n        fullScreenMapRef.current.setView(coords, zoom);\r\n      }\r\n    }\r\n\r\n    setShowCityPopup(false);\r\n    setCitySearch('');\r\n  };\r\n\r\n  const filteredCities = citySearch\r\n    ? data.cities.filter(city =>\r\n        city.name_ua.toLowerCase().includes(citySearch.toLowerCase())\r\n      )\r\n    : [\r\n        ...data.cities.filter(city => topCities.slice(0, -1).includes(city.name_ua)),\r\n        { id: 'geolocation', name_ua: 'За розташуванням' }\r\n      ].slice(0, 10);\r\n\r\n  useEffect(() => {\r\n    if (isMapFullScreen) {\r\n      setTimeout(() => {\r\n        initializeFullScreenMap();\r\n      }, 100);\r\n    }\r\n\r\n    return () => {\r\n      if (fullScreenMapRef.current) {\r\n        console.log('Очищення повноекранної мапи');\r\n        fullScreenMapRef.current.remove();\r\n        fullScreenMapRef.current = null;\r\n        fullScreenMarkersRef.current.forEach(marker => marker.remove());\r\n        fullScreenMarkersRef.current = [];\r\n      }\r\n    };\r\n  }, [isMapFullScreen, initializeFullScreenMap]);\r\n\r\n  const images = data.product && data.product.images && data.product.images.length > 0 \r\n    ? data.product.images \r\n    : ['/img/placeholder.webp'];\r\n\r\n  const handlePrevImage = useCallback(\r\n    (e) => {\r\n      e.stopPropagation();\r\n      setDirection('left');\r\n      setPrevImageIndex(currentImageIndex);\r\n      setCurrentImageIndex((prev) => (prev === 0 ? images.length - 1 : prev - 1));\r\n      setTimeout(() => {\r\n        setPrevImageIndex(null);\r\n        setDirection(null);\r\n      }, 500);\r\n    },\r\n    [currentImageIndex, images.length]\r\n  );\r\n\r\n  const handleNextImage = useCallback(\r\n    (e) => {\r\n      e.stopPropagation();\r\n      setDirection('right');\r\n      setPrevImageIndex(currentImageIndex);\r\n      setCurrentImageIndex((prev) => (prev === images.length - 1 ? 0 : prev + 1));\r\n      setTimeout(() => {\r\n        setPrevImageIndex(null);\r\n        setDirection(null);\r\n      }, 500);\r\n    },\r\n    [currentImageIndex, images.length]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (!data.product) return;\r\n\r\n    const handleKeyDown = (e) => {\r\n      if (!isFullScreen && !isMapFullScreen) return;\r\n      if (e.key === 'ArrowLeft' && isFullScreen) {\r\n        handlePrevImage(e);\r\n      } else if (e.key === 'ArrowRight' && isFullScreen) {\r\n        handleNextImage(e);\r\n      } else if (e.key === 'Escape') {\r\n        setIsFullScreen(false);\r\n        setIsMapFullScreen(false);\r\n        setShowCityPopup(false);\r\n        setCitySearch('');\r\n      }\r\n    };\r\n\r\n    window.addEventListener('keydown', handleKeyDown);\r\n    return () => window.removeEventListener('keydown', handleKeyDown);\r\n  }, [isFullScreen, isMapFullScreen, data.product, handlePrevImage, handleNextImage]);\r\n\r\n  const handleSaveToggle = async (e) => {\r\n    e.preventDefault();\r\n    if (!token) {\r\n      setShowLoginPrompt(true);\r\n      setTimeout(() => {\r\n        setShowLoginPrompt(false);\r\n      }, 3000);\r\n      return;\r\n    }\r\n    try {\r\n      if (isSaved) {\r\n        await axios.delete(`https://price-ua-react-backend.onrender.com/saved-products/${productId}`, {\r\n          headers: { Authorization: `Bearer ${token}`, 'Content-Type': 'application/json' },\r\n        });\r\n        setIsSaved(false);\r\n      } else {\r\n        await axios.post(\r\n          'https://price-ua-react-backend.onrender.com/saved-products',\r\n          { productId },\r\n          { headers: { Authorization: `Bearer ${token}`, 'Content-Type': 'application/json' } }\r\n        );\r\n        setIsSaved(true);\r\n      }\r\n    } catch (err) {\r\n      console.error('Помилка перемикання статусу збереження:', err);\r\n      setError('Не вдалося змінити статус збереження товару.');\r\n    }\r\n  };\r\n\r\n  const handleTrashClick = () => {\r\n    setShowDeleteModal(true);\r\n  };\r\n\r\n  const handleEditClick = () => {\r\n    clearError();\r\n    navigate(`/admin/product-edit?productId=${productId}`);\r\n  };\r\n\r\n  const handleDeleteConfirm = async () => {\r\n    if (!token || !productId) return;\r\n\r\n    try {\r\n      await axios.delete(`https://price-ua-react-backend.onrender.com/admin/product/${productId}`, {\r\n        headers: { Authorization: `Bearer ${token}`, 'Content-Type': 'application/json' },\r\n      });\r\n      setShowDeleteModal(false);\r\n      clearError();\r\n      navigate('/products');\r\n    } catch (err) {\r\n      console.error('Помилка видалення товару:', err);\r\n      setError('Не вдалося видалити товар.');\r\n      setShowDeleteModal(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteCancel = () => {\r\n    setShowDeleteModal(false);\r\n  };\r\n\r\n  const handleLoginRedirect = () => {\r\n    clearError();\r\n    navigate('/login');\r\n  };\r\n\r\n  const toggleMapFullScreen = (event) => {\r\n    if (isDragging) {\r\n      console.log('Ігнорування кліку через перетягування');\r\n      return;\r\n    }\r\n    console.log('Перемикання повноекранної мапи');\r\n    setIsMapFullScreen(!isMapFullScreen);\r\n    setShowCityPopup(false);\r\n    setCitySearch('');\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"loading-overlay\">\r\n        <div className=\"spinner-container\">\r\n          <div className=\"spinner\"></div>\r\n          <p>Завантаження...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return <div className=\"error-message\">{error.message || error}</div>;\r\n  }\r\n\r\n  if (!data.product) {\r\n    setError('Товар не знайдено');\r\n    return null;\r\n  }\r\n\r\n  const handleImageClick = (index) => {\r\n    if (index !== currentImageIndex) {\r\n      setDirection(index > currentImageIndex ? 'right' : 'left');\r\n      setPrevImageIndex(currentImageIndex);\r\n      setCurrentImageIndex(index);\r\n      setTimeout(() => {\r\n        setPrevImageIndex(null);\r\n        setDirection(null);\r\n      }, 500);\r\n    }\r\n  };\r\n\r\n  const toggleFullScreen = () => {\r\n    setIsFullScreen(!isFullScreen);\r\n    if (isFullScreen) {\r\n      setPrevImageIndex(null);\r\n      setDirection(null);\r\n    }\r\n  };\r\n\r\n  const renderStars = (rating) => {\r\n    const stars = [];\r\n    const fullStars = Math.floor(rating);\r\n    const hasHalfStar = rating % 1 >= 0.5;\r\n\r\n    for (let i = 0; i < 5; i++) {\r\n      if (i < fullStars) {\r\n        stars.push(<span key={i} className=\"star full\">★</span>);\r\n      } else if (i === fullStars && hasHalfStar) {\r\n        stars.push(<span key={i} className=\"star half\">★</span>);\r\n      } else {\r\n        stars.push(<span key={i} className=\"star empty\">☆</span>);\r\n      }\r\n    }\r\n    return stars;\r\n  };\r\n\r\n  const scrollToSection = (ref) => {\r\n    ref.current.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  const featureList = [\r\n    { key: 'Бренд', value: data.product.features?.brand },\r\n    { key: 'Країна виробництва', value: data.product.features?.country },\r\n    { key: 'Вид', value: data.product.features?.type },\r\n    { key: 'Клас', value: data.product.features?.class },\r\n    { key: 'Тип волосся / проблема', value: data.product.features?.hairType },\r\n    { key: 'Особливості', value: data.product.features?.features },\r\n    { key: 'Група товару', value: data.product.features?.category },\r\n    { key: 'Призначення', value: data.product.features?.purpose },\r\n    { key: 'Стать', value: data.product.features?.gender },\r\n    { key: 'Активний компонент', value: data.product.features?.active_ingredients },\r\n  ].filter(feature => feature.value);\r\n\r\n  const renderFeatureDescription = (desc) => {\r\n    if (!desc) return null;\r\n\r\n    const descSections = desc.split('\\n\\n');\r\n    return descSections.map((section, index) => {\r\n      if (section.startsWith('**') && section.endsWith('**')) {\r\n        const title = section.slice(2, -2);\r\n        return <h4 key={index} className=\"description-section-title\">{title}</h4>;\r\n      }\r\n      return <p key={index} className=\"description-section-text\">{section}</p>;\r\n    });\r\n  };\r\n\r\n  const getMinPrice = () => {\r\n    if (!data.product.store_prices || data.product.store_prices.length === 0) return 'Н/Д';\r\n    return Math.min(...data.product.store_prices.map(sp => sp.price)) + ' грн';\r\n  };\r\n\r\n  return (\r\n    <div className=\"product-detail\">\r\n      <div className=\"tabs\">\r\n        <div className=\"tabs-left\">\r\n          <button\r\n            className=\"tab-button\"\r\n            onClick={() => scrollToSection(featuresRef)}\r\n            aria-label=\"Перейти до характеристик\"\r\n          >\r\n            Характеристики\r\n          </button>\r\n          <button\r\n            className=\"tab-button\"\r\n            onClick={() => scrollToSection(descriptionRef)}\r\n            aria-label=\"Перейти до опису товару\"\r\n          >\r\n            Опис товару\r\n          </button>\r\n          <button\r\n            className=\"tab-button\"\r\n            onClick={() => scrollToSection(storePricesRef)}\r\n            aria-label=\"Перейти до цін у магазинах\"\r\n          >\r\n            Ціни в магазинах\r\n          </button>\r\n        </div>\r\n        {isAdmin && (\r\n          <div className=\"admin-actions\">\r\n            <div\r\n              className=\"edit-icon-product\"\r\n              onClick={handleEditClick}\r\n              title=\"Редагувати товар\"\r\n            >\r\n              <svg\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                width=\"24\"\r\n                height=\"24\"\r\n                viewBox=\"0 0 24 24\"\r\n                fill=\"none\"\r\n                stroke=\"#1976d2\"\r\n                strokeWidth=\"2\"\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n              >\r\n                <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"></path>\r\n                <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\"></path>\r\n              </svg>\r\n            </div>\r\n            <div\r\n              className=\"trash-icon-product\"\r\n              onClick={handleTrashClick}\r\n              title=\"Видалити товар\"\r\n            >\r\n              <svg\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                width=\"24\"\r\n                height=\"24\"\r\n                viewBox=\"0 0 24 24\"\r\n                fill=\"none\"\r\n                stroke=\"#ff0000\"\r\n                strokeWidth=\"2\"\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n              >\r\n                <polyline points=\"3 6 5 6 21 6\" />\r\n                <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\" />\r\n                <line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\" />\r\n                <line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\" />\r\n              </svg>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"product-content\">\r\n        <div className=\"image-gallery\">\r\n          <div className=\"thumbnail-gallery\">\r\n            {images.slice(0, 4).map((img, index) => (\r\n              <div\r\n                key={index}\r\n                className={`thumbnail ${index === currentImageIndex ? 'active' : ''}`}\r\n                onClick={() => handleImageClick(index)}\r\n              >\r\n                <img\r\n                  src={img}\r\n                  alt={`${data.product.name} thumbnail ${index + 1}`}\r\n                  onError={(e) => {\r\n                    console.log(`Помилка завантаження зображення: ${img}`);\r\n                    e.target.src = '/img/placeholder.webp';\r\n                  }}\r\n                />\r\n              </div>\r\n            ))}\r\n            {images.length > 4 && (\r\n              <div className=\"thumbnail more-images\" onClick={() => handleImageClick(4)}>\r\n                <img\r\n                  src={images[4]}\r\n                  alt={`${data.product.name} more`}\r\n                  onError={(e) => {\r\n                    console.log(`Помилка завантаження зображення: ${images[4]}`);\r\n                    e.target.src = '/img/placeholder.webp';\r\n                  }}\r\n                />\r\n                <span className=\"more-count\">+{images.length - 4}</span>\r\n              </div>\r\n            )}\r\n          </div>\r\n          <div className=\"main-image-wrapper\" onClick={toggleFullScreen}>\r\n            <div className=\"image-container\">\r\n              {prevImageIndex !== null && (\r\n                <img\r\n                  src={images[prevImageIndex]}\r\n                  alt={`${data.product.name} ${prevImageIndex + 1}`}\r\n                  className={`main-image main-image-prev ${\r\n                    direction === 'right' ? 'slide-out-left' : 'slide-out-right'\r\n                  }`}\r\n                  onError={(e) => {\r\n                    console.log(`Помилка завантаження зображення: ${images[prevImageIndex]}`);\r\n                    e.target.src = '/img/placeholder.webp';\r\n                  }}\r\n                />\r\n              )}\r\n              <img\r\n                src={images[currentImageIndex]}\r\n                alt={`${data.product.name} ${currentImageIndex + 1}`}\r\n                className={`main-image ${\r\n                  direction === 'right'\r\n                    ? 'slide-in-right'\r\n                    : direction === 'left'\r\n                    ? 'slide-in-left'\r\n                    : ''\r\n                }`}\r\n                onError={(e) => {\r\n                  console.log(`Помилка завантаження зображення: ${images[currentImageIndex]}`);\r\n                  e.target.src = '/img/placeholder.webp';\r\n                }}\r\n              />\r\n            </div>\r\n            {images.length > 1 && (\r\n              <>\r\n                <div className=\"arrow prev-arrow\" onClick={handlePrevImage}>\r\n                  <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"white\">\r\n                    <path d=\"M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6l-1.41-1.41z\" />\r\n                  </svg>\r\n                </div>\r\n                <div className=\"arrow next-arrow\" onClick={handleNextImage}>\r\n                  <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"white\">\r\n                    <path d=\"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6l-1.41-1.41z\" />\r\n                  </svg>\r\n                </div>\r\n              </>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"product-info\">\r\n          <h2>{data.product.name}</h2>\r\n          <div className=\"product-meta\">\r\n            <div className=\"rating\">{renderStars(data.product.rating || 0)}</div>\r\n            <div className=\"views\">{data.product.views || 0} переглядів</div>\r\n            <div className=\"product-code\">Код: {data.product.code || 'Н/Д'}</div>\r\n          </div>\r\n          <div className=\"price-container\">\r\n            <p className=\"price\">{getMinPrice()}</p>\r\n            <button\r\n              className=\"price-view-button\"\r\n              onClick={() => scrollToSection(storePricesRef)}\r\n              aria-label=\"Перейти до цін у магазинах\"\r\n            >\r\n              Перегляд цін\r\n            </button>\r\n            <div className=\"heart-container\">\r\n              <span\r\n                className={`product-detail-heart ${isSaved ? 'saved' : ''}`}\r\n                onClick={handleSaveToggle}\r\n                aria-label={isSaved ? 'Видалити з бажаного' : 'Додати до бажаного'}\r\n              >\r\n                {isSaved ? (\r\n                  <svg width=\"36\" height=\"36\" viewBox=\"0 0 24 24\" fill=\"#ff6f61\" className=\"heart-svg\">\r\n                    <path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\"/>\r\n                  </svg>\r\n                ) : (\r\n                  <svg width=\"36\" height=\"36\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#ff6f61\" strokeWidth=\"2\" className=\"heart-svg\">\r\n                    <path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\"/>\r\n                  </svg>\r\n                )}\r\n              </span>\r\n              {showLoginPrompt && (\r\n                <span className=\"login-prompt\">\r\n                  Увійдіть в <Link to=\"/login\" className=\"login-link\" onClick={handleLoginRedirect}>аккаунт</Link> щоб додати до бажаного\r\n                </span>\r\n              )}\r\n            </div>\r\n          </div>\r\n          <div className=\"map-container\" onClick={toggleMapFullScreen}>\r\n            <div ref={mapContainerRef} className=\"map\" style={{ height: '200px', width: '100%' }}></div>\r\n          </div>\r\n          <p className=\"volume\">Об'єм: {data.product.volume || 'Н/Д'}</p>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"product-features\" ref={featuresRef}>\r\n        <h3>Характеристики</h3>\r\n        {featureList.length > 0 ? (\r\n          <ul>\r\n            {featureList.map((feature, index) => (\r\n              <li key={index}>\r\n                <span className=\"feature-key\">{feature.key}</span>\r\n                <span className=\"feature-value\">{feature.value}</span>\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        ) : (\r\n          <p>Характеристики відсутні</p>\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"product-description\" ref={descriptionRef}>\r\n        <h3>Опис товару</h3>\r\n        <div className=\"description-section\">\r\n          <h4>Опис</h4>\r\n          {data.product.description_full ? (\r\n            renderFeatureDescription(data.product.description_full)\r\n          ) : (\r\n            <p>Опис відсутній</p>\r\n          )}\r\n        </div>\r\n        <div className=\"description-section\">\r\n          <h4>Склад</h4>\r\n          <p>{data.product.composition || 'Н/Д'}</p>\r\n        </div>\r\n        <div className=\"description-section\">\r\n          <h4>Використання</h4>\r\n          <p>{data.product.usage || 'Н/Д'}</p>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"store-prices\" ref={storePricesRef}>\r\n        <h3>Ціни в магазинах</h3>\r\n        <div className=\"store-list\">\r\n          {data.product.store_prices?.length > 0 ? (\r\n            data.product.store_prices.map((store, index) => (\r\n              <div key={index} className=\"store-item\">\r\n                <div className=\"store-name-logo\">\r\n                  <p className=\"store-name\">{store.name}</p>\r\n                  <img\r\n                    src={store.logo}\r\n                    alt={`${store.name} logo`}\r\n                    className=\"store-logo\"\r\n                    onError={(e) => {\r\n                      console.log(`Помилка завантаження логотипу: ${store.logo}`);\r\n                      e.target.src = '/img/placeholder.webp';\r\n                    }}\r\n                  />\r\n                </div>\r\n                <div className=\"store-details\">\r\n                  <p className=\"store-years\">✓ З нами більше {store.years_with_us || '-'} років</p>\r\n                  <p className=\"store-delivery\">• Доставка: {store.delivery}</p>\r\n                </div>\r\n                <div className=\"store-price-buy\">\r\n                  <p className=\"store-price\">{store.price} грн</p>\r\n                  <a href={store.link || '#'} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                    <button className=\"buy-button\">Купити</button>\r\n                  </a>\r\n                </div>\r\n              </div>\r\n            ))\r\n          ) : (\r\n            <p>Ціни в магазинах відсутні</p>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {isFullScreen && (\r\n        <div className=\"fullscreen-modal\" onClick={toggleFullScreen}>\r\n          <div className=\"fullscreen-content\">\r\n            <div className=\"image-container\">\r\n              {prevImageIndex && (\r\n                <img\r\n                  src={images[prevImageIndex]}\r\n                  alt={`${data.product.name} fullscreen ${prevImageIndex + 1}`}\r\n                  className={`fullscreen-image fullscreen-image-prev ${\r\n                    direction === 'right' ? 'slide-out-left' : 'slide-out-right'\r\n                  }`}\r\n                  onError={(e) => {\r\n                    console.log(`Помилка завантаження зображення: ${images[prevImageIndex]}`);\r\n                    e.target.src = '/img/placeholder.webp';\r\n                  }}\r\n                />\r\n              )}\r\n              <img\r\n                src={images[currentImageIndex]}\r\n                alt={`${data.product.name} fullscreen ${currentImageIndex + 1}`}\r\n                className={`fullscreen-image ${\r\n                  direction === 'right'\r\n                    ? 'slide-in-right'\r\n                    : direction === 'left'\r\n                    ? 'slide-in-left'\r\n                    : ''\r\n                }`}\r\n                onError={(e) => {\r\n                  console.log(`Помилка завантаження зображення: ${images[currentImageIndex]}`);\r\n                  e.target.src = '/img/placeholder.webp';\r\n                }}\r\n              />\r\n            </div>\r\n            {images.length > 1 && (\r\n              <>\r\n                <div\r\n                  className=\"fullscreen-arrow fullscreen-prev\"\r\n                  onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    handlePrevImage(e);\r\n                  }}\r\n                >\r\n                  <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"white\">\r\n                    <path d=\"M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6l-1.41-1.41z\" />\r\n                  </svg>\r\n                </div>\r\n                <div\r\n                  className=\"fullscreen-arrow fullscreen-next\"\r\n                  onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    handleNextImage(e);\r\n                  }}\r\n                >\r\n                  <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"white\">\r\n                    <path d=\"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6l-1.41-1.41z\" />\r\n                  </svg>\r\n                </div>\r\n              </>\r\n            )}\r\n            <button className=\"close-fullscreen\" onClick={toggleFullScreen}>\r\n              ✕\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {isMapFullScreen && (\r\n        <div className=\"fullscreen-map-modal\">\r\n          <div className=\"fullscreen-map-content\">\r\n            <div style={{ position: 'absolute', top: '20px', left: '20px', zIndex: 1001, display: 'flex', alignItems: 'center' }}>\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Пошук міста...\"\r\n                value={citySearch}\r\n                onChange={(e) => setCitySearch(e.target.value)}\r\n                className=\"city-map-search-input\"\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  setShowCityPopup(true);\r\n                }}\r\n              />\r\n              {showCityPopup && (\r\n                <div className={`city-map-popup ${showCityPopup ? 'open' : ''}`} ref={cityPopupRef}>\r\n                  <div className=\"city-list\">\r\n                    {filteredCities.map((city) => (\r\n                      <div\r\n                        key={city.id}\r\n                        className=\"city-item\"\r\n                        onClick={() => handleCitySelect(city.name_ua)}\r\n                      >\r\n                        {city.name_ua}\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n            <div ref={fullScreenMapContainerRef} className=\"fullscreen-map\" style={{ height: '100%' }}></div>\r\n            <button className=\"close-fullscreen-map\" onClick={toggleMapFullScreen}>\r\n              ✕\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {showDeleteModal && (\r\n        <div className=\"delete-modal-overlay\">\r\n          <div className=\"delete-modal\">\r\n            <p>Ви точно хочете видалити товар \"{data.product.name} ({data.product.id})\"?</p>\r\n            <div className=\"delete-modal-buttons\">\r\n              <button className=\"delete-confirm-btn\" onClick={handleDeleteConfirm}>\r\n                Так\r\n              </button>\r\n              <button className=\"delete-cancel-btn\" onClick={handleDeleteCancel}>\r\n                Ні\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ProductDetail;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,WAAW,CAAEC,MAAM,CAAEC,OAAO,KAAQ,OAAO,CAChF,OAASC,SAAS,CAAEC,WAAW,CAAEC,IAAI,KAAQ,kBAAkB,CAC/D,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,QAAQ,KAAQ,gBAAgB,CACzC,MAAO,CAAAC,CAAC,KAAM,SAAS,CACvB,MAAO,0BAA0B,CACjC,MAAO,qBAAqB,CAC5B,MAAO,mBAAmB,CAE1B;AAAA,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBACA,MAAO,CAAAN,CAAC,CAACO,IAAI,CAACC,OAAO,CAACC,SAAS,CAACC,WAAW,CAC3CV,CAAC,CAACO,IAAI,CAACC,OAAO,CAACG,YAAY,CAAC,CAC1BC,aAAa,CAAE,gEAAgE,CAC/EC,OAAO,CAAE,6DAA6D,CACtEC,SAAS,CAAE,+DACb,CAAC,CAAC,CAEF,QAAS,CAAAC,aAAaA,CAAA,CAAG,KAAAC,qBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CAAAC,uBAAA,CAAAC,qBAAA,CACvB,KAAM,CAAEC,SAAU,CAAC,CAAGhC,SAAS,CAAC,CAAC,CACjC,KAAM,CAAAiC,QAAQ,CAAGhC,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAEiC,QAAQ,CAAEC,UAAW,CAAC,CAAG/B,QAAQ,CAAC,CAAC,CAC3C,KAAM,CAACgC,IAAI,CAAEC,OAAO,CAAC,CAAG1C,QAAQ,CAAC,CAC/B2C,OAAO,CAAE,IAAI,CACbC,cAAc,CAAE,EAAE,CAClBC,MAAM,CAAE,EACV,CAAC,CAAC,CACF,KAAM,CAACC,SAAS,CAAEC,YAAY,CAAC,CAAG/C,QAAQ,CAAC,IAAI,CAAC,CAChD,KAAM,CAACgD,KAAK,CAAEC,aAAa,CAAC,CAAGjD,QAAQ,CAAC,IAAI,CAAC,CAC7C,KAAM,CAACkD,iBAAiB,CAAEC,oBAAoB,CAAC,CAAGnD,QAAQ,CAAC,CAAC,CAAC,CAC7D,KAAM,CAACoD,cAAc,CAAEC,iBAAiB,CAAC,CAAGrD,QAAQ,CAAC,IAAI,CAAC,CAC1D,KAAM,CAACsD,SAAS,CAAEC,YAAY,CAAC,CAAGvD,QAAQ,CAAC,IAAI,CAAC,CAChD,KAAM,CAACwD,YAAY,CAAEC,eAAe,CAAC,CAAGzD,QAAQ,CAAC,KAAK,CAAC,CACvD,KAAM,CAAC0D,OAAO,CAAEC,UAAU,CAAC,CAAG3D,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAAC4D,eAAe,CAAEC,kBAAkB,CAAC,CAAG7D,QAAQ,CAAC,KAAK,CAAC,CAC7D,KAAM,CAAC8D,eAAe,CAAEC,kBAAkB,CAAC,CAAG/D,QAAQ,CAAC,KAAK,CAAC,CAC7D,KAAM,CAACgE,eAAe,CAAEC,kBAAkB,CAAC,CAAGjE,QAAQ,CAAC,KAAK,CAAC,CAC7D,KAAM,CAACkE,UAAU,CAAEC,aAAa,CAAC,CAAGnE,QAAQ,CAAC,KAAK,CAAC,CACnD,KAAM,CAACoE,UAAU,CAAEC,aAAa,CAAC,CAAGrE,QAAQ,CAAC,EAAE,CAAC,CAChD,KAAM,CAACsE,aAAa,CAAEC,gBAAgB,CAAC,CAAGvE,QAAQ,CAAC,KAAK,CAAC,CACzD,KAAM,CAAAwE,YAAY,CAAGrE,MAAM,CAAC,IAAI,CAAC,CAEjC,KAAM,CAAAsE,WAAW,CAAGtE,MAAM,CAAC,IAAI,CAAC,CAChC,KAAM,CAAAuE,cAAc,CAAGvE,MAAM,CAAC,IAAI,CAAC,CACnC,KAAM,CAAAwE,cAAc,CAAGxE,MAAM,CAAC,IAAI,CAAC,CACnC,KAAM,CAAAyE,MAAM,CAAGzE,MAAM,CAAC,IAAI,CAAC,CAC3B,KAAM,CAAA0E,eAAe,CAAG1E,MAAM,CAAC,IAAI,CAAC,CACpC,KAAM,CAAA2E,gBAAgB,CAAG3E,MAAM,CAAC,IAAI,CAAC,CACrC,KAAM,CAAA4E,yBAAyB,CAAG5E,MAAM,CAAC,IAAI,CAAC,CAC9C,KAAM,CAAA6E,UAAU,CAAG7E,MAAM,CAAC,EAAE,CAAC,CAC7B,KAAM,CAAA8E,oBAAoB,CAAG9E,MAAM,CAAC,EAAE,CAAC,CAEvC,KAAM,CAAA+E,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,KAAM,CAAAC,IAAI,CAAGC,IAAI,CAACC,KAAK,CAACJ,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAAC,EAAI,IAAI,CAC7D,KAAM,CAAAI,OAAO,CAAGH,IAAI,EAAIA,IAAI,CAACI,QAAQ,CACrC,KAAM,CAAAC,YAAY,CAAGP,YAAY,CAACC,OAAO,CAAC,oBAAoB,CAAC,EAAI,gBAAgB,CAEnF,KAAM,CAAAO,eAAe,CAAGvF,OAAO,CAAC,KAAO,CACrC,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,kBAAkB,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACtC,eAAe,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACnC,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,OAAO,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC3B,OAAO,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC3B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,aAAa,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACjC,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,aAAa,CAAE,CAAC,OAAO,CAAE,QAAQ,CAAC,CAClC,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,sBAAsB,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC1C,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,eAAe,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACnC,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,gBAAgB,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACpC,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,aAAa,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACjC,YAAY,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAChC,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,OAAO,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC3B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,YAAY,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAChC,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,OAAO,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC3B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,YAAY,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAChC,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,MAAM,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC1B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,OAAO,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC3B,uBAAuB,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC3C,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,OAAO,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC3B,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,MAAM,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC1B,MAAM,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC1B,YAAY,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAChC,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,YAAY,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAChC,OAAO,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC3B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,aAAa,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACjC,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,aAAa,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACjC,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,OAAO,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC3B,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,YAAY,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAChC,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,OAAO,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC3B,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,OAAO,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC3B,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,OAAO,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC3B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,YAAY,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAChC,MAAM,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC1B,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,qBAAqB,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACzC,YAAY,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAChC,eAAe,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACnC,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,OAAO,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC3B,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,cAAc,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAClC,YAAY,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAChC,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,aAAa,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACjC,cAAc,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAClC,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,OAAO,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC3B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,aAAa,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACjC,gBAAgB,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACpC,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,aAAa,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACjC,aAAa,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACjC,aAAa,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACjC,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,MAAM,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC1B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,OAAO,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC3B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,OAAO,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC3B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,cAAc,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAClC,eAAe,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACnC,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,eAAe,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACnC,cAAc,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAClC,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,OAAO,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC3B,YAAY,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAChC,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,cAAc,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAClC,kBAAkB,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACtC,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,OAAO,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC3B,OAAO,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC3B,MAAM,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC1B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,YAAY,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAChC,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,YAAY,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAChC,YAAY,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAChC,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,OAAO,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC3B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,cAAc,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAClC,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,OAAO,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC3B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,aAAa,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACjC,aAAa,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACjC,UAAU,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC9B,aAAa,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACjC,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,KAAK,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CACzB,SAAS,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC7B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,WAAW,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC/B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,OAAO,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC3B,MAAM,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC1B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAAC,CAC5B,QAAQ,CAAE,CAAC,OAAO,CAAE,OAAO,CAC7B,CAAC,CAAC,CAAE,EAAE,CAAC,CAEP;AACA,KAAM,CAAAwF,SAAS,CAAG,CAChB,MAAM,CAAE,QAAQ,CAAE,OAAO,CAAE,QAAQ,CAAE,QAAQ,CAC7C,WAAW,CAAE,OAAO,CAAE,YAAY,CAAE,UAAU,CAAE,kBAAkB,CACnE,CAED;AACA,KAAM,CAAAC,gBAAgB,CAAG3F,WAAW,CAAC,SAAY,CAC/C6C,YAAY,CAAC,IAAI,CAAC,CAClBP,UAAU,CAAC,CAAC,CACZ,GAAI,CACFsD,OAAO,CAACC,GAAG,CAAC,2CAA2C,CAAE1D,SAAS,CAAC,CACnE,KAAM,CAAC2D,eAAe,CAAEC,cAAc,CAAEC,sBAAsB,CAAC,CAAG,KAAM,CAAAC,OAAO,CAACC,GAAG,CAAC,CAClF5F,KAAK,CAAC6F,GAAG,CAAC,wDAAwDhE,SAAS,EAAE,CAAE,CAC7EiE,OAAO,CAAE,CAAE,cAAc,CAAE,kBAAmB,CAChD,CAAC,CAAC,CACF9F,KAAK,CAAC6F,GAAG,CAAC,oDAAoD,CAAE,CAC9DC,OAAO,CAAE,CAAE,cAAc,CAAE,kBAAmB,CAChD,CAAC,CAAC,CACF9F,KAAK,CAAC6F,GAAG,CAAC,6DAA6D,CAAE,CACvEE,MAAM,CAAE,CAAElE,SAAU,CAAC,CACrBiE,OAAO,CAAE,CAAE,cAAc,CAAE,kBAAmB,CAChD,CAAC,CAAC,CACH,CAAC,CAEF5D,OAAO,CAAC,CACNC,OAAO,CAAEqD,eAAe,CAACvD,IAAI,CAC7BI,MAAM,CAAEoD,cAAc,CAACxD,IAAI,CAC3BG,cAAc,CAAEsD,sBAAsB,CAACzD,IACzC,CAAC,CAAC,CACFqD,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAE,CACzCpD,OAAO,CAAEqD,eAAe,CAACvD,IAAI,CAAC+D,EAAE,CAChC3D,MAAM,CAAEoD,cAAc,CAACxD,IAAI,CAACgE,MAAM,CAClC7D,cAAc,CAAEsD,sBAAsB,CAACzD,IAAI,CAACgE,MAC9C,CAAC,CAAC,CACJ,CAAE,MAAOC,GAAG,CAAE,CACZZ,OAAO,CAAC9C,KAAK,CAAC,wCAAwC,CAAE0D,GAAG,CAAC,CAC5DnE,QAAQ,CAAC,oDAAoD,CAAC,CAC9DU,aAAa,CAAC,oDAAoD,CAAC,CACrE,CAAC,OAAS,CACRF,YAAY,CAAC,KAAK,CAAC,CACrB,CACF,CAAC,CAAE,CAACV,SAAS,CAAEE,QAAQ,CAAEC,UAAU,CAAC,CAAC,CAErCvC,SAAS,CAAC,IAAM,CACd4F,gBAAgB,CAAC,CAAC,CACpB,CAAC,CAAE,CAACA,gBAAgB,CAAC,CAAC,CAEtB;AACA,KAAM,CAAAc,gBAAgB,CAAGzG,WAAW,CAAC,SAAY,CAC/C,GAAI,CAACgF,KAAK,CAAE,CACVvB,UAAU,CAAC,KAAK,CAAC,CACjB,OACF,CACA,GAAI,CACF,KAAM,CAAAiD,QAAQ,CAAG,KAAM,CAAApG,KAAK,CAAC6F,GAAG,CAAC,8DAA8DhE,SAAS,EAAE,CAAE,CAC1GiE,OAAO,CAAE,CAAEO,aAAa,CAAE,UAAU3B,KAAK,EAAE,CAAE,cAAc,CAAE,kBAAmB,CAClF,CAAC,CAAC,CACFvB,UAAU,CAACiD,QAAQ,CAACnE,IAAI,CAACiB,OAAO,CAAC,CACnC,CAAE,MAAOgD,GAAG,CAAE,CACZZ,OAAO,CAAC9C,KAAK,CAAC,uCAAuC,CAAE0D,GAAG,CAAC,CAC3DnE,QAAQ,CAAC,iDAAiD,CAAC,CAC7D,CACF,CAAC,CAAE,CAACF,SAAS,CAAE6C,KAAK,CAAE3C,QAAQ,CAAC,CAAC,CAEhCtC,SAAS,CAAC,IAAM,CACd,GAAI,CAAC6C,SAAS,EAAI,CAACE,KAAK,EAAIP,IAAI,CAACE,OAAO,CAAE,CACxCgE,gBAAgB,CAAC,CAAC,CACpB,CACF,CAAC,CAAE,CAACA,gBAAgB,CAAE7D,SAAS,CAAEE,KAAK,CAAEP,IAAI,CAACE,OAAO,CAAC,CAAC,CAEtD;AACA,KAAM,CAAAmE,qBAAqB,CAAG5G,WAAW,CAAC,SAAY,CACpD,GAAI,CAAA6G,MAAM,CAAG,CAAC,OAAO,CAAE,OAAO,CAAC,CAAE;AACjC,GAAI,CAAAC,IAAI,CAAG,EAAE,CAEb,GAAItB,YAAY,EAAIA,YAAY,GAAK,gBAAgB,EAAIA,YAAY,GAAK,QAAQ,CAAE,CAClF,GAAIA,YAAY,GAAI,CAAAC,eAAe,CAAE,CACnCoB,MAAM,CAAGpB,eAAe,CAACD,YAAY,CAAC,CACtCI,OAAO,CAACC,GAAG,CAAC,gCAAgCL,YAAY,GAAG,CAAEqB,MAAM,CAAC,CACtE,CAAC,IAAM,IAAIrB,YAAY,GAAK,kBAAkB,CAAE,CAC9C,GAAI,CACF,KAAM,CAAAkB,QAAQ,CAAG,KAAM,CAAApG,KAAK,CAAC6F,GAAG,CAC9B,4DAA4DY,kBAAkB,CAACvB,YAAY,CAAC,kBAC9F,CAAC,CACD,GAAIkB,QAAQ,CAACnE,IAAI,CAACgE,MAAM,CAAG,CAAC,CAAE,CAC5BM,MAAM,CAAG,CAACG,UAAU,CAACN,QAAQ,CAACnE,IAAI,CAAC,CAAC,CAAC,CAAC0E,GAAG,CAAC,CAAED,UAAU,CAACN,QAAQ,CAACnE,IAAI,CAAC,CAAC,CAAC,CAAC2E,GAAG,CAAC,CAAC,CAC7EtB,OAAO,CAACC,GAAG,CAAC,2BAA2BL,YAAY,GAAG,CAAEqB,MAAM,CAAC,CACjE,CACF,CAAE,MAAOL,GAAG,CAAE,CACZZ,OAAO,CAAC9C,KAAK,CAAC,oCAAoC,CAAE0D,GAAG,CAAC,CAC1D,CACF,CAAC,IAAM,IAAIW,SAAS,CAACC,WAAW,CAAE,CAChC,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,IAAI,CAAApB,OAAO,CAAC,CAACqB,OAAO,CAAEC,MAAM,GAAK,CACtDJ,SAAS,CAACC,WAAW,CAACI,kBAAkB,CAACF,OAAO,CAAEC,MAAM,CAAE,CACxDE,kBAAkB,CAAE,IAAI,CACxBC,OAAO,CAAE,KAAK,CACdC,UAAU,CAAE,CACd,CAAC,CAAC,CACJ,CAAC,CAAC,CACFd,MAAM,CAAG,CAACQ,QAAQ,CAACR,MAAM,CAACe,QAAQ,CAAEP,QAAQ,CAACR,MAAM,CAACgB,SAAS,CAAC,CAC9DjC,OAAO,CAACC,GAAG,CAAC,oCAAoC,CAAEgB,MAAM,CAAC,CAC3D,CAAE,MAAOL,GAAG,CAAE,CACZZ,OAAO,CAAC9C,KAAK,CAAC,+BAA+B,CAAE0D,GAAG,CAAC,CACrD,CACF,CACF,CAEA,MAAO,CAAEK,MAAM,CAAEC,IAAK,CAAC,CACzB,CAAC,CAAE,CAACtB,YAAY,CAAEC,eAAe,CAAC,CAAC,CAEnC;AACA,KAAM,CAAAqC,mBAAmB,CAAG9H,WAAW,CAAC,SAAY,CAClD,GAAI,CAAC2E,eAAe,CAACoD,OAAO,CAAE,CAC5BnC,OAAO,CAAC9C,KAAK,CAAC,uCAAuC,CAAC,CACtD,OACF,CAEA,GAAI6B,eAAe,CAACoD,OAAO,CAACC,YAAY,GAAK,CAAC,EAAIrD,eAAe,CAACoD,OAAO,CAACE,WAAW,GAAK,CAAC,CAAE,CAC3FrC,OAAO,CAACsC,IAAI,CAAC,oCAAoC,CAAC,CAClDC,UAAU,CAAC,IAAML,mBAAmB,CAAC,CAAC,CAAE,GAAG,CAAC,CAC5C,OACF,CAEA,GAAI,CACF,KAAM,CAAEjB,MAAM,CAAEC,IAAK,CAAC,CAAG,KAAM,CAAAF,qBAAqB,CAAC,CAAC,CACtDhB,OAAO,CAACC,GAAG,CAAC,+CAA+C,CAAEgB,MAAM,CAAE,MAAM,CAAEC,IAAI,CAAC,CAElFpC,MAAM,CAACqD,OAAO,CAAGvH,CAAC,CAAC4H,GAAG,CAACzD,eAAe,CAACoD,OAAO,CAAE,CAC9CM,MAAM,CAAExB,MAAM,CACdC,IAAI,CAAEA,IAAI,CACVwB,eAAe,CAAE,KAAK,CACtBC,QAAQ,CAAE,IACZ,CAAC,CAAC,CAEF,KAAM,CAAAC,SAAS,CAAGhI,CAAC,CAACgI,SAAS,CAAC,oDAAoD,CAAE,CAClFC,WAAW,CAAE,oFACf,CAAC,CAAC,CAACC,KAAK,CAAChE,MAAM,CAACqD,OAAO,CAAC,CAExBS,SAAS,CAACG,EAAE,CAAC,WAAW,CAAG7F,KAAK,EAAK,CACnC8C,OAAO,CAAC9C,KAAK,CAAC,8BAA8B,CAAEA,KAAK,CAAC,CACpDT,QAAQ,CAAC,6DAA6D,CAAC,CACzE,CAAC,CAAC,CAEFqC,MAAM,CAACqD,OAAO,CAACY,EAAE,CAAC,WAAW,CAAE,IAAM,CACnC/C,OAAO,CAACC,GAAG,CAAC,uCAAuC,CAAC,CACpD5B,aAAa,CAAC,IAAI,CAAC,CACrB,CAAC,CAAC,CACFS,MAAM,CAACqD,OAAO,CAACY,EAAE,CAAC,SAAS,CAAE,IAAM,CACjC/C,OAAO,CAACC,GAAG,CAAC,sCAAsC,CAAC,CACnDsC,UAAU,CAAC,IAAMlE,aAAa,CAAC,KAAK,CAAC,CAAE,GAAG,CAAC,CAC7C,CAAC,CAAC,CAEF;AACAa,UAAU,CAACiD,OAAO,CAACa,OAAO,CAACC,MAAM,EAAIA,MAAM,CAACC,MAAM,CAAC,CAAC,CAAC,CACrDhE,UAAU,CAACiD,OAAO,CAAG,EAAE,CAEvB,GAAIxF,IAAI,CAACG,cAAc,CAAC6D,MAAM,CAAG,CAAC,CAAE,CAClCzB,UAAU,CAACiD,OAAO,CAAGxF,IAAI,CAACG,cAAc,CAAC0F,GAAG,CAACW,aAAa,EAAI,CAC5D,KAAM,CAAAF,MAAM,CAAGrI,CAAC,CAACqI,MAAM,CAAC,CAACE,aAAa,CAACnB,QAAQ,CAAEmB,aAAa,CAAClB,SAAS,CAAC,CAAE,CACzEmB,IAAI,CAAExI,CAAC,CAACwI,IAAI,CAAC,CACX3H,OAAO,CAAE,6DAA6D,CACtED,aAAa,CAAE,gEAAgE,CAC/EE,SAAS,CAAE,+DAA+D,CAC1E2H,QAAQ,CAAE,CAAC,EAAE,CAAE,EAAE,CAAC,CAClBC,UAAU,CAAE,CAAC,EAAE,CAAE,EAAE,CAAC,CACpBC,WAAW,CAAE,CAAC,CAAC,CAAE,CAAC,EAAE,CAAC,CACrBC,UAAU,CAAE,CAAC,EAAE,CAAE,EAAE,CACrB,CAAC,CACH,CAAC,CAAC,CAACV,KAAK,CAAChE,MAAM,CAACqD,OAAO,CAAC,CAExBc,MAAM,CAACQ,WAAW,CAACN,aAAa,CAACO,UAAU,CAAE,CAC3CC,SAAS,CAAE,IAAI,CACfnG,SAAS,CAAE,KAAK,CAChBoG,MAAM,CAAE,CAAC,CAAC,CAAE,CAAC,EAAE,CAAC,CAChBC,SAAS,CAAE,aACb,CAAC,CAAC,CAEF,MAAO,CAAAZ,MAAM,CACf,CAAC,CAAC,CAEF,KAAM,CAAAa,kBAAkB,CAAGnH,IAAI,CAACG,cAAc,CAACiH,MAAM,CAACZ,aAAa,EAAI,CACrE,KAAM,CAAAa,CAAC,CAAG,IAAI,CACd,KAAM,CAAAC,IAAI,CAAGhD,MAAM,CAAC,CAAC,CAAC,CAAGiD,IAAI,CAACC,EAAE,CAAG,GAAG,CACtC,KAAM,CAAAC,IAAI,CAAGjB,aAAa,CAACnB,QAAQ,CAAGkC,IAAI,CAACC,EAAE,CAAG,GAAG,CACnD,KAAM,CAAAE,QAAQ,CAAG,CAAClB,aAAa,CAACnB,QAAQ,CAAGf,MAAM,CAAC,CAAC,CAAC,EAAIiD,IAAI,CAACC,EAAE,CAAG,GAAG,CACrE,KAAM,CAAAG,QAAQ,CAAG,CAACnB,aAAa,CAAClB,SAAS,CAAGhB,MAAM,CAAC,CAAC,CAAC,EAAIiD,IAAI,CAACC,EAAE,CAAG,GAAG,CAEtE,KAAM,CAAAI,CAAC,CAAGL,IAAI,CAACM,GAAG,CAACH,QAAQ,CAAG,CAAC,CAAC,EAAI,CAAC,CAC3BH,IAAI,CAACO,GAAG,CAACR,IAAI,CAAC,CAAGC,IAAI,CAACO,GAAG,CAACL,IAAI,CAAC,CAAGF,IAAI,CAACM,GAAG,CAACF,QAAQ,CAAG,CAAC,CAAC,EAAI,CAAC,CACvE,KAAM,CAAAI,CAAC,CAAG,CAAC,CAAGR,IAAI,CAACS,KAAK,CAACT,IAAI,CAACU,IAAI,CAACL,CAAC,CAAC,CAAEL,IAAI,CAACU,IAAI,CAAC,CAAC,CAAGL,CAAC,CAAC,CAAC,CACxD,KAAM,CAAAM,QAAQ,CAAGb,CAAC,CAAGU,CAAC,CAEtB,MAAO,CAAAG,QAAQ,CAAG,CAAC,CACrB,CAAC,CAAC,CAEF,GAAIf,kBAAkB,CAACnD,MAAM,CAAG,CAAC,CAAE,CACjC,KAAM,CAAAmE,MAAM,CAAGlK,CAAC,CAACmK,YAAY,CAACjB,kBAAkB,CAACtB,GAAG,CAACwC,GAAG,EAAI,CAACA,GAAG,CAAChD,QAAQ,CAAEgD,GAAG,CAAC/C,SAAS,CAAC,CAAC,CAAC,CAC3FnD,MAAM,CAACqD,OAAO,CAAC8C,SAAS,CAACH,MAAM,CAAE,CAAEI,OAAO,CAAE,CAAC,EAAE,CAAE,EAAE,CAAC,CAAEC,OAAO,CAAE,EAAG,CAAC,CAAC,CACpEnF,OAAO,CAACC,GAAG,CAAC,yCAAyC,CAAE6D,kBAAkB,CAACnD,MAAM,CAAC,CACnF,CAAC,IAAM,CACLX,OAAO,CAACC,GAAG,CAAC,uDAAuD,CAAEL,YAAY,CAAC,CAClFd,MAAM,CAACqD,OAAO,CAACiD,OAAO,CAACnE,MAAM,CAAEC,IAAI,CAAC,CACtC,CACF,CAAC,IAAM,CACLlB,OAAO,CAACC,GAAG,CAAC,wCAAwC,CAAEL,YAAY,CAAC,CACnEd,MAAM,CAACqD,OAAO,CAACiD,OAAO,CAACnE,MAAM,CAAEC,IAAI,CAAC,CACtC,CAEAqB,UAAU,CAAC,IAAM,CACf,GAAIzD,MAAM,CAACqD,OAAO,CAAE,CAClBrD,MAAM,CAACqD,OAAO,CAACkD,cAAc,CAAC,CAAC,CACjC,CACF,CAAC,CAAE,GAAG,CAAC,CACT,CAAE,MAAOzE,GAAG,CAAE,CACZZ,OAAO,CAAC9C,KAAK,CAAC,2CAA2C,CAAE0D,GAAG,CAAC,CAC/DnE,QAAQ,CAAC,iCAAiC,CAAC,CAC7C,CACF,CAAC,CAAE,CAACA,QAAQ,CAAEE,IAAI,CAACG,cAAc,CAAE8C,YAAY,CAAEoB,qBAAqB,CAAC,CAAC,CAExE;AACA7G,SAAS,CAAC,IAAM,CACd,GAAI,CAAC6C,SAAS,EAAI,CAACE,KAAK,EAAIP,IAAI,CAACE,OAAO,CAAE,CACxCqF,mBAAmB,CAAC,CAAC,CACvB,CAEA,MAAO,IAAM,CACX,GAAIpD,MAAM,CAACqD,OAAO,CAAE,CAClBnC,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC,CACvCnB,MAAM,CAACqD,OAAO,CAACmD,GAAG,CAAC,WAAW,CAAC,CAC/BxG,MAAM,CAACqD,OAAO,CAACmD,GAAG,CAAC,SAAS,CAAC,CAC7BxG,MAAM,CAACqD,OAAO,CAACe,MAAM,CAAC,CAAC,CACvBpE,MAAM,CAACqD,OAAO,CAAG,IAAI,CACrBjD,UAAU,CAACiD,OAAO,CAACa,OAAO,CAACC,MAAM,EAAIA,MAAM,CAACC,MAAM,CAAC,CAAC,CAAC,CACrDhE,UAAU,CAACiD,OAAO,CAAG,EAAE,CACzB,CACF,CAAC,CACH,CAAC,CAAE,CAACnF,SAAS,CAAEE,KAAK,CAAEP,IAAI,CAACE,OAAO,CAAEqF,mBAAmB,CAAC,CAAC,CAEzD;AACA/H,SAAS,CAAC,IAAM,CACd,KAAM,CAAAoL,kBAAkB,CAAIC,KAAK,EAAK,CACpC,GAAI9G,YAAY,CAACyD,OAAO,EAAI,CAACzD,YAAY,CAACyD,OAAO,CAACsD,QAAQ,CAACD,KAAK,CAACE,MAAM,CAAC,EAAI,CAACF,KAAK,CAACE,MAAM,CAACC,SAAS,CAACF,QAAQ,CAAC,mBAAmB,CAAC,CAAE,CACjIhH,gBAAgB,CAAC,KAAK,CAAC,CACvBF,aAAa,CAAC,EAAE,CAAC,CACnB,CACF,CAAC,CACDqH,QAAQ,CAACC,gBAAgB,CAAC,WAAW,CAAEN,kBAAkB,CAAC,CAC1D,MAAO,IAAMK,QAAQ,CAACE,mBAAmB,CAAC,WAAW,CAAEP,kBAAkB,CAAC,CAC5E,CAAC,CAAE,EAAE,CAAC,CAEN;AACA,KAAM,CAAAQ,uBAAuB,CAAG3L,WAAW,CAAC,SAAY,CACtD,GAAI,CAAC6E,yBAAyB,CAACkD,OAAO,CAAE,CACtCnC,OAAO,CAAC9C,KAAK,CAAC,0CAA0C,CAAC,CACzD,OACF,CAEA,GAAI+B,yBAAyB,CAACkD,OAAO,CAACC,YAAY,GAAK,CAAC,EAAInD,yBAAyB,CAACkD,OAAO,CAACE,WAAW,GAAK,CAAC,CAAE,CAC/GrC,OAAO,CAACsC,IAAI,CAAC,kDAAkD,CAAC,CAChEC,UAAU,CAAC,IAAMwD,uBAAuB,CAAC,CAAC,CAAE,GAAG,CAAC,CAChD,OACF,CAEA,GAAI,CACF,KAAM,CAAE9E,MAAM,CAAEC,IAAK,CAAC,CAAG,KAAM,CAAAF,qBAAqB,CAAC,CAAC,CACtDhB,OAAO,CAACC,GAAG,CAAC,kDAAkD,CAAEgB,MAAM,CAAE,MAAM,CAAEC,IAAI,CAAC,CAErFlC,gBAAgB,CAACmD,OAAO,CAAGvH,CAAC,CAAC4H,GAAG,CAACvD,yBAAyB,CAACkD,OAAO,CAAE,CAClEM,MAAM,CAAExB,MAAM,CACdC,IAAI,CAAEA,IAAI,CACVwB,eAAe,CAAE,IAAI,CACrBC,QAAQ,CAAE,IACZ,CAAC,CAAC,CAEF,KAAM,CAAAC,SAAS,CAAGhI,CAAC,CAACgI,SAAS,CAAC,oDAAoD,CAAE,CAClFC,WAAW,CAAE,oFACf,CAAC,CAAC,CAACC,KAAK,CAAC9D,gBAAgB,CAACmD,OAAO,CAAC,CAElCS,SAAS,CAACG,EAAE,CAAC,WAAW,CAAG7F,KAAK,EAAK,CACnC8C,OAAO,CAAC9C,KAAK,CAAC,iDAAiD,CAAEA,KAAK,CAAC,CACvET,QAAQ,CAAC,4BAA4B,CAAC,CACxC,CAAC,CAAC,CAEF0C,oBAAoB,CAACgD,OAAO,CAACa,OAAO,CAACC,MAAM,EAAIA,MAAM,CAACC,MAAM,CAAC,CAAC,CAAC,CAC/D/D,oBAAoB,CAACgD,OAAO,CAAG,EAAE,CAEjC,GAAIxF,IAAI,CAACG,cAAc,CAAC6D,MAAM,CAAG,CAAC,CAAE,CAClCxB,oBAAoB,CAACgD,OAAO,CAAGxF,IAAI,CAACG,cAAc,CAAC0F,GAAG,CAACW,aAAa,EAAI,CACtE,KAAM,CAAAF,MAAM,CAAGrI,CAAC,CAACqI,MAAM,CAAC,CAACE,aAAa,CAACnB,QAAQ,CAAEmB,aAAa,CAAClB,SAAS,CAAC,CAAE,CACzEmB,IAAI,CAAExI,CAAC,CAACwI,IAAI,CAAC,CACX3H,OAAO,CAAE,6DAA6D,CACtED,aAAa,CAAE,gEAAgE,CAC/EE,SAAS,CAAE,+DAA+D,CAC1E2H,QAAQ,CAAE,CAAC,EAAE,CAAE,EAAE,CAAC,CAClBC,UAAU,CAAE,CAAC,EAAE,CAAE,EAAE,CAAC,CACpBC,WAAW,CAAE,CAAC,CAAC,CAAE,CAAC,EAAE,CAAC,CACrBC,UAAU,CAAE,CAAC,EAAE,CAAE,EAAE,CACrB,CAAC,CACH,CAAC,CAAC,CAACV,KAAK,CAAC9D,gBAAgB,CAACmD,OAAO,CAAC,CAElCc,MAAM,CAACQ,WAAW,CAACN,aAAa,CAACO,UAAU,CAAE,CAC3CC,SAAS,CAAE,IAAI,CACfnG,SAAS,CAAE,KAAK,CAChBoG,MAAM,CAAE,CAAC,CAAC,CAAE,CAAC,EAAE,CAAC,CAChBC,SAAS,CAAE,aACb,CAAC,CAAC,CAEF,MAAO,CAAAZ,MAAM,CACf,CAAC,CAAC,CAEF,KAAM,CAAAa,kBAAkB,CAAGnH,IAAI,CAACG,cAAc,CAACiH,MAAM,CAACZ,aAAa,EAAI,CACrE,KAAM,CAAAa,CAAC,CAAG,IAAI,CACd,KAAM,CAAAC,IAAI,CAAGhD,MAAM,CAAC,CAAC,CAAC,CAAGiD,IAAI,CAACC,EAAE,CAAG,GAAG,CACtC,KAAM,CAAAC,IAAI,CAAGjB,aAAa,CAACnB,QAAQ,CAAGkC,IAAI,CAACC,EAAE,CAAG,GAAG,CACnD,KAAM,CAAAE,QAAQ,CAAG,CAAClB,aAAa,CAACnB,QAAQ,CAAGf,MAAM,CAAC,CAAC,CAAC,EAAIiD,IAAI,CAACC,EAAE,CAAG,GAAG,CACrE,KAAM,CAAAG,QAAQ,CAAG,CAACnB,aAAa,CAAClB,SAAS,CAAGhB,MAAM,CAAC,CAAC,CAAC,EAAIiD,IAAI,CAACC,EAAE,CAAG,GAAG,CAEtE,KAAM,CAAAI,CAAC,CAAGL,IAAI,CAACM,GAAG,CAACH,QAAQ,CAAG,CAAC,CAAC,EAAI,CAAC,CAC3BH,IAAI,CAACO,GAAG,CAACR,IAAI,CAAC,CAAGC,IAAI,CAACO,GAAG,CAACL,IAAI,CAAC,CAAGF,IAAI,CAACM,GAAG,CAACF,QAAQ,CAAG,CAAC,CAAC,EAAI,CAAC,CACvE,KAAM,CAAAI,CAAC,CAAG,CAAC,CAAGR,IAAI,CAACS,KAAK,CAACT,IAAI,CAACU,IAAI,CAACL,CAAC,CAAC,CAAEL,IAAI,CAACU,IAAI,CAAC,CAAC,CAAGL,CAAC,CAAC,CAAC,CACxD,KAAM,CAAAM,QAAQ,CAAGb,CAAC,CAAGU,CAAC,CAEtB,MAAO,CAAAG,QAAQ,CAAG,CAAC,CACrB,CAAC,CAAC,CAEF,GAAIf,kBAAkB,CAACnD,MAAM,CAAG,CAAC,CAAE,CACjC,KAAM,CAAAmE,MAAM,CAAGlK,CAAC,CAACmK,YAAY,CAACjB,kBAAkB,CAACtB,GAAG,CAACwC,GAAG,EAAI,CAACA,GAAG,CAAChD,QAAQ,CAAEgD,GAAG,CAAC/C,SAAS,CAAC,CAAC,CAAC,CAC3FjD,gBAAgB,CAACmD,OAAO,CAAC8C,SAAS,CAACH,MAAM,CAAE,CAAEI,OAAO,CAAE,CAAC,EAAE,CAAE,EAAE,CAAC,CAAEC,OAAO,CAAE,EAAG,CAAC,CAAC,CAChF,CAAC,IAAM,CACLnG,gBAAgB,CAACmD,OAAO,CAACiD,OAAO,CAACnE,MAAM,CAAEC,IAAI,CAAC,CAChD,CACF,CAAC,IAAM,CACLlC,gBAAgB,CAACmD,OAAO,CAACiD,OAAO,CAACnE,MAAM,CAAEC,IAAI,CAAC,CAChD,CAEAqB,UAAU,CAAC,IAAM,CACf,GAAIvD,gBAAgB,CAACmD,OAAO,CAAE,CAC5BnD,gBAAgB,CAACmD,OAAO,CAACkD,cAAc,CAAC,CAAC,CAC3C,CACF,CAAC,CAAE,GAAG,CAAC,CACT,CAAE,MAAOzE,GAAG,CAAE,CACZZ,OAAO,CAAC9C,KAAK,CAAC,8CAA8C,CAAE0D,GAAG,CAAC,CAClEnE,QAAQ,CAAC,2CAA2C,CAAC,CACvD,CACF,CAAC,CAAE,CAACA,QAAQ,CAAEE,IAAI,CAACG,cAAc,CAAEkE,qBAAqB,CAAC,CAAC,CAE1D;AACA,KAAM,CAAAgF,gBAAgB,CAAG,KAAO,CAAAC,QAAQ,EAAK,CAC3C,GAAI,CAACjH,gBAAgB,CAACmD,OAAO,CAAE,OAE/B,GAAI,CAAAlB,MAAM,CAAG,CAAC,OAAO,CAAE,OAAO,CAAC,CAAE;AACjC,GAAI,CAAAC,IAAI,CAAG,EAAE,CAEb,GAAI+E,QAAQ,GAAK,kBAAkB,CAAE,CACnC,GAAI1E,SAAS,CAACC,WAAW,CAAE,CACzB,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,IAAI,CAAApB,OAAO,CAAC,CAACqB,OAAO,CAAEC,MAAM,GAAK,CACtDJ,SAAS,CAACC,WAAW,CAACI,kBAAkB,CAACF,OAAO,CAAEC,MAAM,CAAE,CACxDE,kBAAkB,CAAE,IAAI,CACxBC,OAAO,CAAE,KAAK,CACdC,UAAU,CAAE,CACd,CAAC,CAAC,CACJ,CAAC,CAAC,CACFd,MAAM,CAAG,CAACQ,QAAQ,CAACR,MAAM,CAACe,QAAQ,CAAEP,QAAQ,CAACR,MAAM,CAACgB,SAAS,CAAC,CAC9DjC,OAAO,CAACC,GAAG,CAAC,oCAAoC,CAAEgB,MAAM,CAAC,CAC3D,CAAE,MAAOL,GAAG,CAAE,CACZZ,OAAO,CAAC9C,KAAK,CAAC,+BAA+B,CAAE0D,GAAG,CAAC,CACnDnE,QAAQ,CAAC,iCAAiC,CAAC,CAC3C,OACF,CACF,CACF,CAAC,IAAM,IAAIwJ,QAAQ,GAAI,CAAApG,eAAe,CAAE,CACtCoB,MAAM,CAAGpB,eAAe,CAACoG,QAAQ,CAAC,CAClCjG,OAAO,CAACC,GAAG,CAAC,8BAA8BgG,QAAQ,GAAG,CAAEhF,MAAM,CAAC,CAChE,CAAC,IAAM,CACL,GAAI,CACF,KAAM,CAAAH,QAAQ,CAAG,KAAM,CAAApG,KAAK,CAAC6F,GAAG,CAC9B,4DAA4DY,kBAAkB,CAAC8E,QAAQ,CAAC,kBAC1F,CAAC,CACD,GAAInF,QAAQ,CAACnE,IAAI,CAACgE,MAAM,CAAG,CAAC,CAAE,CAC5BM,MAAM,CAAG,CAACG,UAAU,CAACN,QAAQ,CAACnE,IAAI,CAAC,CAAC,CAAC,CAAC0E,GAAG,CAAC,CAAED,UAAU,CAACN,QAAQ,CAACnE,IAAI,CAAC,CAAC,CAAC,CAAC2E,GAAG,CAAC,CAAC,CAC7EtB,OAAO,CAACC,GAAG,CAAC,2BAA2BgG,QAAQ,GAAG,CAAEhF,MAAM,CAAC,CAC7D,CAAC,IAAM,CACLjB,OAAO,CAACC,GAAG,CAAC,kBAAkBgG,QAAQ,cAAc,CAAC,CACrD,OACF,CACF,CAAE,MAAOrF,GAAG,CAAE,CACZZ,OAAO,CAAC9C,KAAK,CAAC,oCAAoC,CAAE0D,GAAG,CAAC,CACxDnE,QAAQ,CAAC,qCAAqC,CAAC,CAC/C,OACF,CACF,CAEA;AACAuC,gBAAgB,CAACmD,OAAO,CAAC+D,KAAK,CAACjF,MAAM,CAAEC,IAAI,CAAE,CAC3CiF,OAAO,CAAE,IAAI,CACbC,QAAQ,CAAE,CACZ,CAAC,CAAC,CAEF;AACAjH,oBAAoB,CAACgD,OAAO,CAACa,OAAO,CAACC,MAAM,EAAIA,MAAM,CAACC,MAAM,CAAC,CAAC,CAAC,CAC/D/D,oBAAoB,CAACgD,OAAO,CAAG,EAAE,CAEjC,GAAIxF,IAAI,CAACG,cAAc,CAAC6D,MAAM,CAAG,CAAC,CAAE,CAClCxB,oBAAoB,CAACgD,OAAO,CAAGxF,IAAI,CAACG,cAAc,CAAC0F,GAAG,CAACW,aAAa,EAAI,CACtE,KAAM,CAAAF,MAAM,CAAGrI,CAAC,CAACqI,MAAM,CAAC,CAACE,aAAa,CAACnB,QAAQ,CAAEmB,aAAa,CAAClB,SAAS,CAAC,CAAE,CACzEmB,IAAI,CAAExI,CAAC,CAACwI,IAAI,CAAC,CACX3H,OAAO,CAAE,6DAA6D,CACtED,aAAa,CAAE,gEAAgE,CAC/EE,SAAS,CAAE,+DAA+D,CAC1E2H,QAAQ,CAAE,CAAC,EAAE,CAAE,EAAE,CAAC,CAClBC,UAAU,CAAE,CAAC,EAAE,CAAE,EAAE,CAAC,CACpBC,WAAW,CAAE,CAAC,CAAC,CAAE,CAAC,EAAE,CAAC,CACrBC,UAAU,CAAE,CAAC,EAAE,CAAE,EAAE,CACrB,CAAC,CACH,CAAC,CAAC,CAACV,KAAK,CAAC9D,gBAAgB,CAACmD,OAAO,CAAC,CAElCc,MAAM,CAACQ,WAAW,CAACN,aAAa,CAACO,UAAU,CAAE,CAC3CC,SAAS,CAAE,IAAI,CACfnG,SAAS,CAAE,KAAK,CAChBoG,MAAM,CAAE,CAAC,CAAC,CAAE,CAAC,EAAE,CAAC,CAChBC,SAAS,CAAE,aACb,CAAC,CAAC,CAEF,MAAO,CAAAZ,MAAM,CACf,CAAC,CAAC,CAEF,KAAM,CAAAa,kBAAkB,CAAGnH,IAAI,CAACG,cAAc,CAACiH,MAAM,CAACZ,aAAa,EAAI,CACrE,KAAM,CAAAa,CAAC,CAAG,IAAI,CACd,KAAM,CAAAC,IAAI,CAAGhD,MAAM,CAAC,CAAC,CAAC,CAAGiD,IAAI,CAACC,EAAE,CAAG,GAAG,CACtC,KAAM,CAAAC,IAAI,CAAGjB,aAAa,CAACnB,QAAQ,CAAGkC,IAAI,CAACC,EAAE,CAAG,GAAG,CACnD,KAAM,CAAAE,QAAQ,CAAG,CAAClB,aAAa,CAACnB,QAAQ,CAAGf,MAAM,CAAC,CAAC,CAAC,EAAIiD,IAAI,CAACC,EAAE,CAAG,GAAG,CACrE,KAAM,CAAAG,QAAQ,CAAG,CAACnB,aAAa,CAAClB,SAAS,CAAGhB,MAAM,CAAC,CAAC,CAAC,EAAIiD,IAAI,CAACC,EAAE,CAAG,GAAG,CAEtE,KAAM,CAAAI,CAAC,CAAGL,IAAI,CAACM,GAAG,CAACH,QAAQ,CAAG,CAAC,CAAC,EAAI,CAAC,CAC3BH,IAAI,CAACO,GAAG,CAACR,IAAI,CAAC,CAAGC,IAAI,CAACO,GAAG,CAACL,IAAI,CAAC,CAAGF,IAAI,CAACM,GAAG,CAACF,QAAQ,CAAG,CAAC,CAAC,EAAI,CAAC,CACvE,KAAM,CAAAI,CAAC,CAAG,CAAC,CAAGR,IAAI,CAACS,KAAK,CAACT,IAAI,CAACU,IAAI,CAACL,CAAC,CAAC,CAAEL,IAAI,CAACU,IAAI,CAAC,CAAC,CAAGL,CAAC,CAAC,CAAC,CACxD,KAAM,CAAAM,QAAQ,CAAGb,CAAC,CAAGU,CAAC,CAEtB,MAAO,CAAAG,QAAQ,CAAG,CAAC,CACrB,CAAC,CAAC,CAEF,GAAIf,kBAAkB,CAACnD,MAAM,CAAG,CAAC,CAAE,CACjC,KAAM,CAAAmE,MAAM,CAAGlK,CAAC,CAACmK,YAAY,CAACjB,kBAAkB,CAACtB,GAAG,CAACwC,GAAG,EAAI,CAACA,GAAG,CAAChD,QAAQ,CAAEgD,GAAG,CAAC/C,SAAS,CAAC,CAAC,CAAC,CAC3FjD,gBAAgB,CAACmD,OAAO,CAAC8C,SAAS,CAACH,MAAM,CAAE,CAAEI,OAAO,CAAE,CAAC,EAAE,CAAE,EAAE,CAAC,CAAEC,OAAO,CAAE,EAAG,CAAC,CAAC,CAChF,CAAC,IAAM,CACLnG,gBAAgB,CAACmD,OAAO,CAACiD,OAAO,CAACnE,MAAM,CAAEC,IAAI,CAAC,CAChD,CACF,CAEAzC,gBAAgB,CAAC,KAAK,CAAC,CACvBF,aAAa,CAAC,EAAE,CAAC,CACnB,CAAC,CAED,KAAM,CAAA8H,cAAc,CAAG/H,UAAU,CAC7B3B,IAAI,CAACI,MAAM,CAACgH,MAAM,CAACuC,IAAI,EACrBA,IAAI,CAACC,OAAO,CAACC,WAAW,CAAC,CAAC,CAACC,QAAQ,CAACnI,UAAU,CAACkI,WAAW,CAAC,CAAC,CAC9D,CAAC,CACD,CACE,GAAG7J,IAAI,CAACI,MAAM,CAACgH,MAAM,CAACuC,IAAI,EAAIxG,SAAS,CAAC4G,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CAAC,CAACD,QAAQ,CAACH,IAAI,CAACC,OAAO,CAAC,CAAC,CAC5E,CAAE7F,EAAE,CAAE,aAAa,CAAE6F,OAAO,CAAE,kBAAmB,CAAC,CACnD,CAACG,KAAK,CAAC,CAAC,CAAE,EAAE,CAAC,CAElBvM,SAAS,CAAC,IAAM,CACd,GAAI+D,eAAe,CAAE,CACnBqE,UAAU,CAAC,IAAM,CACfwD,uBAAuB,CAAC,CAAC,CAC3B,CAAC,CAAE,GAAG,CAAC,CACT,CAEA,MAAO,IAAM,CACX,GAAI/G,gBAAgB,CAACmD,OAAO,CAAE,CAC5BnC,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAC,CAC1CjB,gBAAgB,CAACmD,OAAO,CAACe,MAAM,CAAC,CAAC,CACjClE,gBAAgB,CAACmD,OAAO,CAAG,IAAI,CAC/BhD,oBAAoB,CAACgD,OAAO,CAACa,OAAO,CAACC,MAAM,EAAIA,MAAM,CAACC,MAAM,CAAC,CAAC,CAAC,CAC/D/D,oBAAoB,CAACgD,OAAO,CAAG,EAAE,CACnC,CACF,CAAC,CACH,CAAC,CAAE,CAACjE,eAAe,CAAE6H,uBAAuB,CAAC,CAAC,CAE9C,KAAM,CAAAY,MAAM,CAAGhK,IAAI,CAACE,OAAO,EAAIF,IAAI,CAACE,OAAO,CAAC8J,MAAM,EAAIhK,IAAI,CAACE,OAAO,CAAC8J,MAAM,CAAChG,MAAM,CAAG,CAAC,CAChFhE,IAAI,CAACE,OAAO,CAAC8J,MAAM,CACnB,CAAC,uBAAuB,CAAC,CAE7B,KAAM,CAAAC,eAAe,CAAGxM,WAAW,CAChCyM,CAAC,EAAK,CACLA,CAAC,CAACC,eAAe,CAAC,CAAC,CACnBrJ,YAAY,CAAC,MAAM,CAAC,CACpBF,iBAAiB,CAACH,iBAAiB,CAAC,CACpCC,oBAAoB,CAAE0J,IAAI,EAAMA,IAAI,GAAK,CAAC,CAAGJ,MAAM,CAAChG,MAAM,CAAG,CAAC,CAAGoG,IAAI,CAAG,CAAE,CAAC,CAC3ExE,UAAU,CAAC,IAAM,CACfhF,iBAAiB,CAAC,IAAI,CAAC,CACvBE,YAAY,CAAC,IAAI,CAAC,CACpB,CAAC,CAAE,GAAG,CAAC,CACT,CAAC,CACD,CAACL,iBAAiB,CAAEuJ,MAAM,CAAChG,MAAM,CACnC,CAAC,CAED,KAAM,CAAAqG,eAAe,CAAG5M,WAAW,CAChCyM,CAAC,EAAK,CACLA,CAAC,CAACC,eAAe,CAAC,CAAC,CACnBrJ,YAAY,CAAC,OAAO,CAAC,CACrBF,iBAAiB,CAACH,iBAAiB,CAAC,CACpCC,oBAAoB,CAAE0J,IAAI,EAAMA,IAAI,GAAKJ,MAAM,CAAChG,MAAM,CAAG,CAAC,CAAG,CAAC,CAAGoG,IAAI,CAAG,CAAE,CAAC,CAC3ExE,UAAU,CAAC,IAAM,CACfhF,iBAAiB,CAAC,IAAI,CAAC,CACvBE,YAAY,CAAC,IAAI,CAAC,CACpB,CAAC,CAAE,GAAG,CAAC,CACT,CAAC,CACD,CAACL,iBAAiB,CAAEuJ,MAAM,CAAChG,MAAM,CACnC,CAAC,CAEDxG,SAAS,CAAC,IAAM,CACd,GAAI,CAACwC,IAAI,CAACE,OAAO,CAAE,OAEnB,KAAM,CAAAoK,aAAa,CAAIJ,CAAC,EAAK,CAC3B,GAAI,CAACnJ,YAAY,EAAI,CAACQ,eAAe,CAAE,OACvC,GAAI2I,CAAC,CAACK,GAAG,GAAK,WAAW,EAAIxJ,YAAY,CAAE,CACzCkJ,eAAe,CAACC,CAAC,CAAC,CACpB,CAAC,IAAM,IAAIA,CAAC,CAACK,GAAG,GAAK,YAAY,EAAIxJ,YAAY,CAAE,CACjDsJ,eAAe,CAACH,CAAC,CAAC,CACpB,CAAC,IAAM,IAAIA,CAAC,CAACK,GAAG,GAAK,QAAQ,CAAE,CAC7BvJ,eAAe,CAAC,KAAK,CAAC,CACtBQ,kBAAkB,CAAC,KAAK,CAAC,CACzBM,gBAAgB,CAAC,KAAK,CAAC,CACvBF,aAAa,CAAC,EAAE,CAAC,CACnB,CACF,CAAC,CAED4I,MAAM,CAACtB,gBAAgB,CAAC,SAAS,CAAEoB,aAAa,CAAC,CACjD,MAAO,IAAME,MAAM,CAACrB,mBAAmB,CAAC,SAAS,CAAEmB,aAAa,CAAC,CACnE,CAAC,CAAE,CAACvJ,YAAY,CAAEQ,eAAe,CAAEvB,IAAI,CAACE,OAAO,CAAE+J,eAAe,CAAEI,eAAe,CAAC,CAAC,CAEnF,KAAM,CAAAI,gBAAgB,CAAG,KAAO,CAAAP,CAAC,EAAK,CACpCA,CAAC,CAACQ,cAAc,CAAC,CAAC,CAClB,GAAI,CAACjI,KAAK,CAAE,CACVrB,kBAAkB,CAAC,IAAI,CAAC,CACxBwE,UAAU,CAAC,IAAM,CACfxE,kBAAkB,CAAC,KAAK,CAAC,CAC3B,CAAC,CAAE,IAAI,CAAC,CACR,OACF,CACA,GAAI,CACF,GAAIH,OAAO,CAAE,CACX,KAAM,CAAAlD,KAAK,CAAC4M,MAAM,CAAC,8DAA8D/K,SAAS,EAAE,CAAE,CAC5FiE,OAAO,CAAE,CAAEO,aAAa,CAAE,UAAU3B,KAAK,EAAE,CAAE,cAAc,CAAE,kBAAmB,CAClF,CAAC,CAAC,CACFvB,UAAU,CAAC,KAAK,CAAC,CACnB,CAAC,IAAM,CACL,KAAM,CAAAnD,KAAK,CAAC6M,IAAI,CACd,4DAA4D,CAC5D,CAAEhL,SAAU,CAAC,CACb,CAAEiE,OAAO,CAAE,CAAEO,aAAa,CAAE,UAAU3B,KAAK,EAAE,CAAE,cAAc,CAAE,kBAAmB,CAAE,CACtF,CAAC,CACDvB,UAAU,CAAC,IAAI,CAAC,CAClB,CACF,CAAE,MAAO+C,GAAG,CAAE,CACZZ,OAAO,CAAC9C,KAAK,CAAC,yCAAyC,CAAE0D,GAAG,CAAC,CAC7DnE,QAAQ,CAAC,8CAA8C,CAAC,CAC1D,CACF,CAAC,CAED,KAAM,CAAA+K,gBAAgB,CAAGA,CAAA,GAAM,CAC7BvJ,kBAAkB,CAAC,IAAI,CAAC,CAC1B,CAAC,CAED,KAAM,CAAAwJ,eAAe,CAAGA,CAAA,GAAM,CAC5B/K,UAAU,CAAC,CAAC,CACZF,QAAQ,CAAC,iCAAiCD,SAAS,EAAE,CAAC,CACxD,CAAC,CAED,KAAM,CAAAmL,mBAAmB,CAAG,KAAAA,CAAA,GAAY,CACtC,GAAI,CAACtI,KAAK,EAAI,CAAC7C,SAAS,CAAE,OAE1B,GAAI,CACF,KAAM,CAAA7B,KAAK,CAAC4M,MAAM,CAAC,6DAA6D/K,SAAS,EAAE,CAAE,CAC3FiE,OAAO,CAAE,CAAEO,aAAa,CAAE,UAAU3B,KAAK,EAAE,CAAE,cAAc,CAAE,kBAAmB,CAClF,CAAC,CAAC,CACFnB,kBAAkB,CAAC,KAAK,CAAC,CACzBvB,UAAU,CAAC,CAAC,CACZF,QAAQ,CAAC,WAAW,CAAC,CACvB,CAAE,MAAOoE,GAAG,CAAE,CACZZ,OAAO,CAAC9C,KAAK,CAAC,2BAA2B,CAAE0D,GAAG,CAAC,CAC/CnE,QAAQ,CAAC,4BAA4B,CAAC,CACtCwB,kBAAkB,CAAC,KAAK,CAAC,CAC3B,CACF,CAAC,CAED,KAAM,CAAA0J,kBAAkB,CAAGA,CAAA,GAAM,CAC/B1J,kBAAkB,CAAC,KAAK,CAAC,CAC3B,CAAC,CAED,KAAM,CAAA2J,mBAAmB,CAAGA,CAAA,GAAM,CAChClL,UAAU,CAAC,CAAC,CACZF,QAAQ,CAAC,QAAQ,CAAC,CACpB,CAAC,CAED,KAAM,CAAAqL,mBAAmB,CAAIrC,KAAK,EAAK,CACrC,GAAIpH,UAAU,CAAE,CACd4B,OAAO,CAACC,GAAG,CAAC,uCAAuC,CAAC,CACpD,OACF,CACAD,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAC,CAC7C9B,kBAAkB,CAAC,CAACD,eAAe,CAAC,CACpCO,gBAAgB,CAAC,KAAK,CAAC,CACvBF,aAAa,CAAC,EAAE,CAAC,CACnB,CAAC,CAED,GAAIvB,SAAS,CAAE,CACb,mBACElC,IAAA,QAAK+I,SAAS,CAAC,iBAAiB,CAAAiE,QAAA,cAC9B9M,KAAA,QAAK6I,SAAS,CAAC,mBAAmB,CAAAiE,QAAA,eAChChN,IAAA,QAAK+I,SAAS,CAAC,SAAS,CAAM,CAAC,cAC/B/I,IAAA,MAAAgN,QAAA,CAAG,6EAAe,CAAG,CAAC,EACnB,CAAC,CACH,CAAC,CAEV,CAEA,GAAI5K,KAAK,CAAE,CACT,mBAAOpC,IAAA,QAAK+I,SAAS,CAAC,eAAe,CAAAiE,QAAA,CAAE5K,KAAK,CAAC6K,OAAO,EAAI7K,KAAK,CAAM,CAAC,CACtE,CAEA,GAAI,CAACP,IAAI,CAACE,OAAO,CAAE,CACjBJ,QAAQ,CAAC,mBAAmB,CAAC,CAC7B,MAAO,KAAI,CACb,CAEA,KAAM,CAAAuL,gBAAgB,CAAIC,KAAK,EAAK,CAClC,GAAIA,KAAK,GAAK7K,iBAAiB,CAAE,CAC/BK,YAAY,CAACwK,KAAK,CAAG7K,iBAAiB,CAAG,OAAO,CAAG,MAAM,CAAC,CAC1DG,iBAAiB,CAACH,iBAAiB,CAAC,CACpCC,oBAAoB,CAAC4K,KAAK,CAAC,CAC3B1F,UAAU,CAAC,IAAM,CACfhF,iBAAiB,CAAC,IAAI,CAAC,CACvBE,YAAY,CAAC,IAAI,CAAC,CACpB,CAAC,CAAE,GAAG,CAAC,CACT,CACF,CAAC,CAED,KAAM,CAAAyK,gBAAgB,CAAGA,CAAA,GAAM,CAC7BvK,eAAe,CAAC,CAACD,YAAY,CAAC,CAC9B,GAAIA,YAAY,CAAE,CAChBH,iBAAiB,CAAC,IAAI,CAAC,CACvBE,YAAY,CAAC,IAAI,CAAC,CACpB,CACF,CAAC,CAED,KAAM,CAAA0K,WAAW,CAAIC,MAAM,EAAK,CAC9B,KAAM,CAAAC,KAAK,CAAG,EAAE,CAChB,KAAM,CAAAC,SAAS,CAAGpE,IAAI,CAACqE,KAAK,CAACH,MAAM,CAAC,CACpC,KAAM,CAAAI,WAAW,CAAGJ,MAAM,CAAG,CAAC,EAAI,GAAG,CAErC,IAAK,GAAI,CAAAK,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAG,CAAC,CAAEA,CAAC,EAAE,CAAE,CAC1B,GAAIA,CAAC,CAAGH,SAAS,CAAE,CACjBD,KAAK,CAACK,IAAI,cAAC5N,IAAA,SAAc+I,SAAS,CAAC,WAAW,CAAAiE,QAAA,CAAC,QAAC,EAA1BW,CAAgC,CAAC,CAAC,CAC1D,CAAC,IAAM,IAAIA,CAAC,GAAKH,SAAS,EAAIE,WAAW,CAAE,CACzCH,KAAK,CAACK,IAAI,cAAC5N,IAAA,SAAc+I,SAAS,CAAC,WAAW,CAAAiE,QAAA,CAAC,QAAC,EAA1BW,CAAgC,CAAC,CAAC,CAC1D,CAAC,IAAM,CACLJ,KAAK,CAACK,IAAI,cAAC5N,IAAA,SAAc+I,SAAS,CAAC,YAAY,CAAAiE,QAAA,CAAC,QAAC,EAA3BW,CAAiC,CAAC,CAAC,CAC3D,CACF,CACA,MAAO,CAAAJ,KAAK,CACd,CAAC,CAED,KAAM,CAAAM,eAAe,CAAIC,GAAG,EAAK,CAC/BA,GAAG,CAACzG,OAAO,CAAC0G,cAAc,CAAC,CAAEC,QAAQ,CAAE,QAAS,CAAC,CAAC,CACpD,CAAC,CAED,KAAM,CAAAC,WAAW,CAAG,CAClB,CAAE7B,GAAG,CAAE,OAAO,CAAE8B,KAAK,EAAApN,qBAAA,CAAEe,IAAI,CAACE,OAAO,CAACoM,QAAQ,UAAArN,qBAAA,iBAArBA,qBAAA,CAAuBsN,KAAM,CAAC,CACrD,CAAEhC,GAAG,CAAE,oBAAoB,CAAE8B,KAAK,EAAAnN,sBAAA,CAAEc,IAAI,CAACE,OAAO,CAACoM,QAAQ,UAAApN,sBAAA,iBAArBA,sBAAA,CAAuBsN,OAAQ,CAAC,CACpE,CAAEjC,GAAG,CAAE,KAAK,CAAE8B,KAAK,EAAAlN,sBAAA,CAAEa,IAAI,CAACE,OAAO,CAACoM,QAAQ,UAAAnN,sBAAA,iBAArBA,sBAAA,CAAuBsN,IAAK,CAAC,CAClD,CAAElC,GAAG,CAAE,MAAM,CAAE8B,KAAK,EAAAjN,sBAAA,CAAEY,IAAI,CAACE,OAAO,CAACoM,QAAQ,UAAAlN,sBAAA,iBAArBA,sBAAA,CAAuBsN,KAAM,CAAC,CACpD,CAAEnC,GAAG,CAAE,wBAAwB,CAAE8B,KAAK,EAAAhN,sBAAA,CAAEW,IAAI,CAACE,OAAO,CAACoM,QAAQ,UAAAjN,sBAAA,iBAArBA,sBAAA,CAAuBsN,QAAS,CAAC,CACzE,CAAEpC,GAAG,CAAE,aAAa,CAAE8B,KAAK,EAAA/M,sBAAA,CAAEU,IAAI,CAACE,OAAO,CAACoM,QAAQ,UAAAhN,sBAAA,iBAArBA,sBAAA,CAAuBgN,QAAS,CAAC,CAC9D,CAAE/B,GAAG,CAAE,cAAc,CAAE8B,KAAK,EAAA9M,sBAAA,CAAES,IAAI,CAACE,OAAO,CAACoM,QAAQ,UAAA/M,sBAAA,iBAArBA,sBAAA,CAAuBqN,QAAS,CAAC,CAC/D,CAAErC,GAAG,CAAE,aAAa,CAAE8B,KAAK,EAAA7M,sBAAA,CAAEQ,IAAI,CAACE,OAAO,CAACoM,QAAQ,UAAA9M,sBAAA,iBAArBA,sBAAA,CAAuBqN,OAAQ,CAAC,CAC7D,CAAEtC,GAAG,CAAE,OAAO,CAAE8B,KAAK,EAAA5M,sBAAA,CAAEO,IAAI,CAACE,OAAO,CAACoM,QAAQ,UAAA7M,sBAAA,iBAArBA,sBAAA,CAAuBqN,MAAO,CAAC,CACtD,CAAEvC,GAAG,CAAE,oBAAoB,CAAE8B,KAAK,EAAA3M,uBAAA,CAAEM,IAAI,CAACE,OAAO,CAACoM,QAAQ,UAAA5M,uBAAA,iBAArBA,uBAAA,CAAuBqN,kBAAmB,CAAC,CAChF,CAAC3F,MAAM,CAAC4F,OAAO,EAAIA,OAAO,CAACX,KAAK,CAAC,CAElC,KAAM,CAAAY,wBAAwB,CAAIC,IAAI,EAAK,CACzC,GAAI,CAACA,IAAI,CAAE,MAAO,KAAI,CAEtB,KAAM,CAAAC,YAAY,CAAGD,IAAI,CAACE,KAAK,CAAC,MAAM,CAAC,CACvC,MAAO,CAAAD,YAAY,CAACtH,GAAG,CAAC,CAACwH,OAAO,CAAE/B,KAAK,GAAK,CAC1C,GAAI+B,OAAO,CAACC,UAAU,CAAC,IAAI,CAAC,EAAID,OAAO,CAACE,QAAQ,CAAC,IAAI,CAAC,CAAE,CACtD,KAAM,CAAAC,KAAK,CAAGH,OAAO,CAACtD,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CAAC,CAClC,mBAAO5L,IAAA,OAAgB+I,SAAS,CAAC,2BAA2B,CAAAiE,QAAA,CAAEqC,KAAK,EAAnDlC,KAAwD,CAAC,CAC3E,CACA,mBAAOnN,IAAA,MAAe+I,SAAS,CAAC,0BAA0B,CAAAiE,QAAA,CAAEkC,OAAO,EAApD/B,KAAwD,CAAC,CAC1E,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAmC,WAAW,CAAGA,CAAA,GAAM,CACxB,GAAI,CAACzN,IAAI,CAACE,OAAO,CAACwN,YAAY,EAAI1N,IAAI,CAACE,OAAO,CAACwN,YAAY,CAAC1J,MAAM,GAAK,CAAC,CAAE,MAAO,KAAK,CACtF,MAAO,CAAAuD,IAAI,CAACoG,GAAG,CAAC,GAAG3N,IAAI,CAACE,OAAO,CAACwN,YAAY,CAAC7H,GAAG,CAAC+H,EAAE,EAAIA,EAAE,CAACC,KAAK,CAAC,CAAC,CAAG,MAAM,CAC5E,CAAC,CAED,mBACExP,KAAA,QAAK6I,SAAS,CAAC,gBAAgB,CAAAiE,QAAA,eAC7B9M,KAAA,QAAK6I,SAAS,CAAC,MAAM,CAAAiE,QAAA,eACnB9M,KAAA,QAAK6I,SAAS,CAAC,WAAW,CAAAiE,QAAA,eACxBhN,IAAA,WACE+I,SAAS,CAAC,YAAY,CACtB4G,OAAO,CAAEA,CAAA,GAAM9B,eAAe,CAAChK,WAAW,CAAE,CAC5C,aAAW,wIAA0B,CAAAmJ,QAAA,CACtC,sFAED,CAAQ,CAAC,cACThN,IAAA,WACE+I,SAAS,CAAC,YAAY,CACtB4G,OAAO,CAAEA,CAAA,GAAM9B,eAAe,CAAC/J,cAAc,CAAE,CAC/C,aAAW,6HAAyB,CAAAkJ,QAAA,CACrC,+DAED,CAAQ,CAAC,cACThN,IAAA,WACE+I,SAAS,CAAC,YAAY,CACtB4G,OAAO,CAAEA,CAAA,GAAM9B,eAAe,CAAC9J,cAAc,CAAE,CAC/C,aAAW,0IAA4B,CAAAiJ,QAAA,CACxC,wFAED,CAAQ,CAAC,EACN,CAAC,CACLpI,OAAO,eACN1E,KAAA,QAAK6I,SAAS,CAAC,eAAe,CAAAiE,QAAA,eAC5BhN,IAAA,QACE+I,SAAS,CAAC,mBAAmB,CAC7B4G,OAAO,CAAEhD,eAAgB,CACzB0C,KAAK,CAAC,6FAAkB,CAAArC,QAAA,cAExB9M,KAAA,QACE0P,KAAK,CAAC,4BAA4B,CAClCC,KAAK,CAAC,IAAI,CACVC,MAAM,CAAC,IAAI,CACXC,OAAO,CAAC,WAAW,CACnBC,IAAI,CAAC,MAAM,CACXC,MAAM,CAAC,SAAS,CAChBC,WAAW,CAAC,GAAG,CACfC,aAAa,CAAC,OAAO,CACrBC,cAAc,CAAC,OAAO,CAAApD,QAAA,eAEtBhN,IAAA,SAAMqQ,CAAC,CAAC,4DAA4D,CAAO,CAAC,cAC5ErQ,IAAA,SAAMqQ,CAAC,CAAC,yDAAyD,CAAO,CAAC,EACtE,CAAC,CACH,CAAC,cACNrQ,IAAA,QACE+I,SAAS,CAAC,oBAAoB,CAC9B4G,OAAO,CAAEjD,gBAAiB,CAC1B2C,KAAK,CAAC,iFAAgB,CAAArC,QAAA,cAEtB9M,KAAA,QACE0P,KAAK,CAAC,4BAA4B,CAClCC,KAAK,CAAC,IAAI,CACVC,MAAM,CAAC,IAAI,CACXC,OAAO,CAAC,WAAW,CACnBC,IAAI,CAAC,MAAM,CACXC,MAAM,CAAC,SAAS,CAChBC,WAAW,CAAC,GAAG,CACfC,aAAa,CAAC,OAAO,CACrBC,cAAc,CAAC,OAAO,CAAApD,QAAA,eAEtBhN,IAAA,aAAUsQ,MAAM,CAAC,cAAc,CAAE,CAAC,cAClCtQ,IAAA,SAAMqQ,CAAC,CAAC,gFAAgF,CAAE,CAAC,cAC3FrQ,IAAA,SAAMuQ,EAAE,CAAC,IAAI,CAACC,EAAE,CAAC,IAAI,CAACC,EAAE,CAAC,IAAI,CAACC,EAAE,CAAC,IAAI,CAAE,CAAC,cACxC1Q,IAAA,SAAMuQ,EAAE,CAAC,IAAI,CAACC,EAAE,CAAC,IAAI,CAACC,EAAE,CAAC,IAAI,CAACC,EAAE,CAAC,IAAI,CAAE,CAAC,EACrC,CAAC,CACH,CAAC,EACH,CACN,EACE,CAAC,cAENxQ,KAAA,QAAK6I,SAAS,CAAC,iBAAiB,CAAAiE,QAAA,eAC9B9M,KAAA,QAAK6I,SAAS,CAAC,eAAe,CAAAiE,QAAA,eAC5B9M,KAAA,QAAK6I,SAAS,CAAC,mBAAmB,CAAAiE,QAAA,EAC/BnB,MAAM,CAACD,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CAAClE,GAAG,CAAC,CAACiJ,GAAG,CAAExD,KAAK,gBACjCnN,IAAA,QAEE+I,SAAS,CAAE,aAAaoE,KAAK,GAAK7K,iBAAiB,CAAG,QAAQ,CAAG,EAAE,EAAG,CACtEqN,OAAO,CAAEA,CAAA,GAAMzC,gBAAgB,CAACC,KAAK,CAAE,CAAAH,QAAA,cAEvChN,IAAA,QACE4Q,GAAG,CAAED,GAAI,CACTE,GAAG,CAAE,GAAGhP,IAAI,CAACE,OAAO,CAAC+O,IAAI,cAAc3D,KAAK,CAAG,CAAC,EAAG,CACnD4D,OAAO,CAAGhF,CAAC,EAAK,CACd7G,OAAO,CAACC,GAAG,CAAC,oCAAoCwL,GAAG,EAAE,CAAC,CACtD5E,CAAC,CAACnB,MAAM,CAACgG,GAAG,CAAG,uBAAuB,CACxC,CAAE,CACH,CAAC,EAXGzD,KAYF,CACN,CAAC,CACDtB,MAAM,CAAChG,MAAM,CAAG,CAAC,eAChB3F,KAAA,QAAK6I,SAAS,CAAC,uBAAuB,CAAC4G,OAAO,CAAEA,CAAA,GAAMzC,gBAAgB,CAAC,CAAC,CAAE,CAAAF,QAAA,eACxEhN,IAAA,QACE4Q,GAAG,CAAE/E,MAAM,CAAC,CAAC,CAAE,CACfgF,GAAG,CAAE,GAAGhP,IAAI,CAACE,OAAO,CAAC+O,IAAI,OAAQ,CACjCC,OAAO,CAAGhF,CAAC,EAAK,CACd7G,OAAO,CAACC,GAAG,CAAC,oCAAoC0G,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAC5DE,CAAC,CAACnB,MAAM,CAACgG,GAAG,CAAG,uBAAuB,CACxC,CAAE,CACH,CAAC,cACF1Q,KAAA,SAAM6I,SAAS,CAAC,YAAY,CAAAiE,QAAA,EAAC,GAAC,CAACnB,MAAM,CAAChG,MAAM,CAAG,CAAC,EAAO,CAAC,EACrD,CACN,EACE,CAAC,cACN3F,KAAA,QAAK6I,SAAS,CAAC,oBAAoB,CAAC4G,OAAO,CAAEvC,gBAAiB,CAAAJ,QAAA,eAC5D9M,KAAA,QAAK6I,SAAS,CAAC,iBAAiB,CAAAiE,QAAA,EAC7BxK,cAAc,GAAK,IAAI,eACtBxC,IAAA,QACE4Q,GAAG,CAAE/E,MAAM,CAACrJ,cAAc,CAAE,CAC5BqO,GAAG,CAAE,GAAGhP,IAAI,CAACE,OAAO,CAAC+O,IAAI,IAAItO,cAAc,CAAG,CAAC,EAAG,CAClDuG,SAAS,CAAE,8BACTrG,SAAS,GAAK,OAAO,CAAG,gBAAgB,CAAG,iBAAiB,EAC3D,CACHqO,OAAO,CAAGhF,CAAC,EAAK,CACd7G,OAAO,CAACC,GAAG,CAAC,oCAAoC0G,MAAM,CAACrJ,cAAc,CAAC,EAAE,CAAC,CACzEuJ,CAAC,CAACnB,MAAM,CAACgG,GAAG,CAAG,uBAAuB,CACxC,CAAE,CACH,CACF,cACD5Q,IAAA,QACE4Q,GAAG,CAAE/E,MAAM,CAACvJ,iBAAiB,CAAE,CAC/BuO,GAAG,CAAE,GAAGhP,IAAI,CAACE,OAAO,CAAC+O,IAAI,IAAIxO,iBAAiB,CAAG,CAAC,EAAG,CACrDyG,SAAS,CAAE,cACTrG,SAAS,GAAK,OAAO,CACjB,gBAAgB,CAChBA,SAAS,GAAK,MAAM,CACpB,eAAe,CACf,EAAE,EACL,CACHqO,OAAO,CAAGhF,CAAC,EAAK,CACd7G,OAAO,CAACC,GAAG,CAAC,oCAAoC0G,MAAM,CAACvJ,iBAAiB,CAAC,EAAE,CAAC,CAC5EyJ,CAAC,CAACnB,MAAM,CAACgG,GAAG,CAAG,uBAAuB,CACxC,CAAE,CACH,CAAC,EACC,CAAC,CACL/E,MAAM,CAAChG,MAAM,CAAG,CAAC,eAChB3F,KAAA,CAAAE,SAAA,EAAA4M,QAAA,eACEhN,IAAA,QAAK+I,SAAS,CAAC,kBAAkB,CAAC4G,OAAO,CAAE7D,eAAgB,CAAAkB,QAAA,cACzDhN,IAAA,QAAK6P,KAAK,CAAC,IAAI,CAACC,MAAM,CAAC,IAAI,CAACC,OAAO,CAAC,WAAW,CAACC,IAAI,CAAC,OAAO,CAAAhD,QAAA,cAC1DhN,IAAA,SAAMqQ,CAAC,CAAC,2DAA2D,CAAE,CAAC,CACnE,CAAC,CACH,CAAC,cACNrQ,IAAA,QAAK+I,SAAS,CAAC,kBAAkB,CAAC4G,OAAO,CAAEzD,eAAgB,CAAAc,QAAA,cACzDhN,IAAA,QAAK6P,KAAK,CAAC,IAAI,CAACC,MAAM,CAAC,IAAI,CAACC,OAAO,CAAC,WAAW,CAACC,IAAI,CAAC,OAAO,CAAAhD,QAAA,cAC1DhN,IAAA,SAAMqQ,CAAC,CAAC,yDAAyD,CAAE,CAAC,CACjE,CAAC,CACH,CAAC,EACN,CACH,EACE,CAAC,EACH,CAAC,cAENnQ,KAAA,QAAK6I,SAAS,CAAC,cAAc,CAAAiE,QAAA,eAC3BhN,IAAA,OAAAgN,QAAA,CAAKnL,IAAI,CAACE,OAAO,CAAC+O,IAAI,CAAK,CAAC,cAC5B5Q,KAAA,QAAK6I,SAAS,CAAC,cAAc,CAAAiE,QAAA,eAC3BhN,IAAA,QAAK+I,SAAS,CAAC,QAAQ,CAAAiE,QAAA,CAAEK,WAAW,CAACxL,IAAI,CAACE,OAAO,CAACuL,MAAM,EAAI,CAAC,CAAC,CAAM,CAAC,cACrEpN,KAAA,QAAK6I,SAAS,CAAC,OAAO,CAAAiE,QAAA,EAAEnL,IAAI,CAACE,OAAO,CAACiP,KAAK,EAAI,CAAC,CAAC,+DAAW,EAAK,CAAC,cACjE9Q,KAAA,QAAK6I,SAAS,CAAC,cAAc,CAAAiE,QAAA,EAAC,sBAAK,CAACnL,IAAI,CAACE,OAAO,CAACkP,IAAI,EAAI,KAAK,EAAM,CAAC,EAClE,CAAC,cACN/Q,KAAA,QAAK6I,SAAS,CAAC,iBAAiB,CAAAiE,QAAA,eAC9BhN,IAAA,MAAG+I,SAAS,CAAC,OAAO,CAAAiE,QAAA,CAAEsC,WAAW,CAAC,CAAC,CAAI,CAAC,cACxCtP,IAAA,WACE+I,SAAS,CAAC,mBAAmB,CAC7B4G,OAAO,CAAEA,CAAA,GAAM9B,eAAe,CAAC9J,cAAc,CAAE,CAC/C,aAAW,0IAA4B,CAAAiJ,QAAA,CACxC,qEAED,CAAQ,CAAC,cACT9M,KAAA,QAAK6I,SAAS,CAAC,iBAAiB,CAAAiE,QAAA,eAC9BhN,IAAA,SACE+I,SAAS,CAAE,wBAAwBjG,OAAO,CAAG,OAAO,CAAG,EAAE,EAAG,CAC5D6M,OAAO,CAAErD,gBAAiB,CAC1B,aAAYxJ,OAAO,CAAG,qBAAqB,CAAG,oBAAqB,CAAAkK,QAAA,CAElElK,OAAO,cACN9C,IAAA,QAAK6P,KAAK,CAAC,IAAI,CAACC,MAAM,CAAC,IAAI,CAACC,OAAO,CAAC,WAAW,CAACC,IAAI,CAAC,SAAS,CAACjH,SAAS,CAAC,WAAW,CAAAiE,QAAA,cAClFhN,IAAA,SAAMqQ,CAAC,CAAC,gLAAgL,CAAC,CAAC,CACvL,CAAC,cAENrQ,IAAA,QAAK6P,KAAK,CAAC,IAAI,CAACC,MAAM,CAAC,IAAI,CAACC,OAAO,CAAC,WAAW,CAACC,IAAI,CAAC,MAAM,CAACC,MAAM,CAAC,SAAS,CAACC,WAAW,CAAC,GAAG,CAACnH,SAAS,CAAC,WAAW,CAAAiE,QAAA,cAChHhN,IAAA,SAAMqQ,CAAC,CAAC,gLAAgL,CAAC,CAAC,CACvL,CACN,CACG,CAAC,CACNrN,eAAe,eACd9C,KAAA,SAAM6I,SAAS,CAAC,cAAc,CAAAiE,QAAA,EAAC,0DAClB,cAAAhN,IAAA,CAACL,IAAI,EAACuR,EAAE,CAAC,QAAQ,CAACnI,SAAS,CAAC,YAAY,CAAC4G,OAAO,CAAE7C,mBAAoB,CAAAE,QAAA,CAAC,4CAAO,CAAM,CAAC,yHAClG,EAAM,CACP,EACE,CAAC,EACH,CAAC,cACNhN,IAAA,QAAK+I,SAAS,CAAC,eAAe,CAAC4G,OAAO,CAAE5C,mBAAoB,CAAAC,QAAA,cAC1DhN,IAAA,QAAK8N,GAAG,CAAE7J,eAAgB,CAAC8E,SAAS,CAAC,KAAK,CAACoI,KAAK,CAAE,CAAErB,MAAM,CAAE,OAAO,CAAED,KAAK,CAAE,MAAO,CAAE,CAAM,CAAC,CACzF,CAAC,cACN3P,KAAA,MAAG6I,SAAS,CAAC,QAAQ,CAAAiE,QAAA,EAAC,6BAAO,CAACnL,IAAI,CAACE,OAAO,CAACqP,MAAM,EAAI,KAAK,EAAI,CAAC,EAC5D,CAAC,EACH,CAAC,cAENlR,KAAA,QAAK6I,SAAS,CAAC,kBAAkB,CAAC+E,GAAG,CAAEjK,WAAY,CAAAmJ,QAAA,eACjDhN,IAAA,OAAAgN,QAAA,CAAI,sFAAc,CAAI,CAAC,CACtBiB,WAAW,CAACpI,MAAM,CAAG,CAAC,cACrB7F,IAAA,OAAAgN,QAAA,CACGiB,WAAW,CAACvG,GAAG,CAAC,CAACmH,OAAO,CAAE1B,KAAK,gBAC9BjN,KAAA,OAAA8M,QAAA,eACEhN,IAAA,SAAM+I,SAAS,CAAC,aAAa,CAAAiE,QAAA,CAAE6B,OAAO,CAACzC,GAAG,CAAO,CAAC,cAClDpM,IAAA,SAAM+I,SAAS,CAAC,eAAe,CAAAiE,QAAA,CAAE6B,OAAO,CAACX,KAAK,CAAO,CAAC,GAF/Cf,KAGL,CACL,CAAC,CACA,CAAC,cAELnN,IAAA,MAAAgN,QAAA,CAAG,uIAAuB,CAAG,CAC9B,EACE,CAAC,cAEN9M,KAAA,QAAK6I,SAAS,CAAC,qBAAqB,CAAC+E,GAAG,CAAEhK,cAAe,CAAAkJ,QAAA,eACvDhN,IAAA,OAAAgN,QAAA,CAAI,+DAAW,CAAI,CAAC,cACpB9M,KAAA,QAAK6I,SAAS,CAAC,qBAAqB,CAAAiE,QAAA,eAClChN,IAAA,OAAAgN,QAAA,CAAI,0BAAI,CAAI,CAAC,CACZnL,IAAI,CAACE,OAAO,CAACsP,gBAAgB,CAC5BvC,wBAAwB,CAACjN,IAAI,CAACE,OAAO,CAACsP,gBAAgB,CAAC,cAEvDrR,IAAA,MAAAgN,QAAA,CAAG,iFAAc,CAAG,CACrB,EACE,CAAC,cACN9M,KAAA,QAAK6I,SAAS,CAAC,qBAAqB,CAAAiE,QAAA,eAClChN,IAAA,OAAAgN,QAAA,CAAI,gCAAK,CAAI,CAAC,cACdhN,IAAA,MAAAgN,QAAA,CAAInL,IAAI,CAACE,OAAO,CAACuP,WAAW,EAAI,KAAK,CAAI,CAAC,EACvC,CAAC,cACNpR,KAAA,QAAK6I,SAAS,CAAC,qBAAqB,CAAAiE,QAAA,eAClChN,IAAA,OAAAgN,QAAA,CAAI,0EAAY,CAAI,CAAC,cACrBhN,IAAA,MAAAgN,QAAA,CAAInL,IAAI,CAACE,OAAO,CAACwP,KAAK,EAAI,KAAK,CAAI,CAAC,EACjC,CAAC,EACH,CAAC,cAENrR,KAAA,QAAK6I,SAAS,CAAC,cAAc,CAAC+E,GAAG,CAAE/J,cAAe,CAAAiJ,QAAA,eAChDhN,IAAA,OAAAgN,QAAA,CAAI,wFAAgB,CAAI,CAAC,cACzBhN,IAAA,QAAK+I,SAAS,CAAC,YAAY,CAAAiE,QAAA,CACxB,EAAAxL,qBAAA,CAAAK,IAAI,CAACE,OAAO,CAACwN,YAAY,UAAA/N,qBAAA,iBAAzBA,qBAAA,CAA2BqE,MAAM,EAAG,CAAC,CACpChE,IAAI,CAACE,OAAO,CAACwN,YAAY,CAAC7H,GAAG,CAAC,CAAC8J,KAAK,CAAErE,KAAK,gBACzCjN,KAAA,QAAiB6I,SAAS,CAAC,YAAY,CAAAiE,QAAA,eACrC9M,KAAA,QAAK6I,SAAS,CAAC,iBAAiB,CAAAiE,QAAA,eAC9BhN,IAAA,MAAG+I,SAAS,CAAC,YAAY,CAAAiE,QAAA,CAAEwE,KAAK,CAACV,IAAI,CAAI,CAAC,cAC1C9Q,IAAA,QACE4Q,GAAG,CAAEY,KAAK,CAACC,IAAK,CAChBZ,GAAG,CAAE,GAAGW,KAAK,CAACV,IAAI,OAAQ,CAC1B/H,SAAS,CAAC,YAAY,CACtBgI,OAAO,CAAGhF,CAAC,EAAK,CACd7G,OAAO,CAACC,GAAG,CAAC,kCAAkCqM,KAAK,CAACC,IAAI,EAAE,CAAC,CAC3D1F,CAAC,CAACnB,MAAM,CAACgG,GAAG,CAAG,uBAAuB,CACxC,CAAE,CACH,CAAC,EACC,CAAC,cACN1Q,KAAA,QAAK6I,SAAS,CAAC,eAAe,CAAAiE,QAAA,eAC5B9M,KAAA,MAAG6I,SAAS,CAAC,aAAa,CAAAiE,QAAA,EAAC,8EAAgB,CAACwE,KAAK,CAACE,aAAa,EAAI,GAAG,CAAC,iCAAM,EAAG,CAAC,cACjFxR,KAAA,MAAG6I,SAAS,CAAC,gBAAgB,CAAAiE,QAAA,EAAC,2DAAY,CAACwE,KAAK,CAACG,QAAQ,EAAI,CAAC,EAC3D,CAAC,cACNzR,KAAA,QAAK6I,SAAS,CAAC,iBAAiB,CAAAiE,QAAA,eAC9B9M,KAAA,MAAG6I,SAAS,CAAC,aAAa,CAAAiE,QAAA,EAAEwE,KAAK,CAAC9B,KAAK,CAAC,qBAAI,EAAG,CAAC,cAChD1P,IAAA,MAAG4R,IAAI,CAAEJ,KAAK,CAACK,IAAI,EAAI,GAAI,CAACjH,MAAM,CAAC,QAAQ,CAACkH,GAAG,CAAC,qBAAqB,CAAA9E,QAAA,cACnEhN,IAAA,WAAQ+I,SAAS,CAAC,YAAY,CAAAiE,QAAA,CAAC,sCAAM,CAAQ,CAAC,CAC7C,CAAC,EACD,CAAC,GAtBEG,KAuBL,CACN,CAAC,cAEFnN,IAAA,MAAAgN,QAAA,CAAG,yIAAyB,CAAG,CAChC,CACE,CAAC,EACH,CAAC,CAELpK,YAAY,eACX5C,IAAA,QAAK+I,SAAS,CAAC,kBAAkB,CAAC4G,OAAO,CAAEvC,gBAAiB,CAAAJ,QAAA,cAC1D9M,KAAA,QAAK6I,SAAS,CAAC,oBAAoB,CAAAiE,QAAA,eACjC9M,KAAA,QAAK6I,SAAS,CAAC,iBAAiB,CAAAiE,QAAA,EAC7BxK,cAAc,eACbxC,IAAA,QACE4Q,GAAG,CAAE/E,MAAM,CAACrJ,cAAc,CAAE,CAC5BqO,GAAG,CAAE,GAAGhP,IAAI,CAACE,OAAO,CAAC+O,IAAI,eAAetO,cAAc,CAAG,CAAC,EAAG,CAC7DuG,SAAS,CAAE,0CACTrG,SAAS,GAAK,OAAO,CAAG,gBAAgB,CAAG,iBAAiB,EAC3D,CACHqO,OAAO,CAAGhF,CAAC,EAAK,CACd7G,OAAO,CAACC,GAAG,CAAC,oCAAoC0G,MAAM,CAACrJ,cAAc,CAAC,EAAE,CAAC,CACzEuJ,CAAC,CAACnB,MAAM,CAACgG,GAAG,CAAG,uBAAuB,CACxC,CAAE,CACH,CACF,cACD5Q,IAAA,QACE4Q,GAAG,CAAE/E,MAAM,CAACvJ,iBAAiB,CAAE,CAC/BuO,GAAG,CAAE,GAAGhP,IAAI,CAACE,OAAO,CAAC+O,IAAI,eAAexO,iBAAiB,CAAG,CAAC,EAAG,CAChEyG,SAAS,CAAE,oBACTrG,SAAS,GAAK,OAAO,CACjB,gBAAgB,CAChBA,SAAS,GAAK,MAAM,CACpB,eAAe,CACf,EAAE,EACL,CACHqO,OAAO,CAAGhF,CAAC,EAAK,CACd7G,OAAO,CAACC,GAAG,CAAC,oCAAoC0G,MAAM,CAACvJ,iBAAiB,CAAC,EAAE,CAAC,CAC5EyJ,CAAC,CAACnB,MAAM,CAACgG,GAAG,CAAG,uBAAuB,CACxC,CAAE,CACH,CAAC,EACC,CAAC,CACL/E,MAAM,CAAChG,MAAM,CAAG,CAAC,eAChB3F,KAAA,CAAAE,SAAA,EAAA4M,QAAA,eACEhN,IAAA,QACE+I,SAAS,CAAC,kCAAkC,CAC5C4G,OAAO,CAAG5D,CAAC,EAAK,CACdA,CAAC,CAACC,eAAe,CAAC,CAAC,CACnBF,eAAe,CAACC,CAAC,CAAC,CACpB,CAAE,CAAAiB,QAAA,cAEFhN,IAAA,QAAK6P,KAAK,CAAC,IAAI,CAACC,MAAM,CAAC,IAAI,CAACC,OAAO,CAAC,WAAW,CAACC,IAAI,CAAC,OAAO,CAAAhD,QAAA,cAC1DhN,IAAA,SAAMqQ,CAAC,CAAC,2DAA2D,CAAE,CAAC,CACnE,CAAC,CACH,CAAC,cACNrQ,IAAA,QACE+I,SAAS,CAAC,kCAAkC,CAC5C4G,OAAO,CAAG5D,CAAC,EAAK,CACdA,CAAC,CAACC,eAAe,CAAC,CAAC,CACnBE,eAAe,CAACH,CAAC,CAAC,CACpB,CAAE,CAAAiB,QAAA,cAEFhN,IAAA,QAAK6P,KAAK,CAAC,IAAI,CAACC,MAAM,CAAC,IAAI,CAACC,OAAO,CAAC,WAAW,CAACC,IAAI,CAAC,OAAO,CAAAhD,QAAA,cAC1DhN,IAAA,SAAMqQ,CAAC,CAAC,yDAAyD,CAAE,CAAC,CACjE,CAAC,CACH,CAAC,EACN,CACH,cACDrQ,IAAA,WAAQ+I,SAAS,CAAC,kBAAkB,CAAC4G,OAAO,CAAEvC,gBAAiB,CAAAJ,QAAA,CAAC,QAEhE,CAAQ,CAAC,EACN,CAAC,CACH,CACN,CAEA5J,eAAe,eACdpD,IAAA,QAAK+I,SAAS,CAAC,sBAAsB,CAAAiE,QAAA,cACnC9M,KAAA,QAAK6I,SAAS,CAAC,wBAAwB,CAAAiE,QAAA,eACrC9M,KAAA,QAAKiR,KAAK,CAAE,CAAExK,QAAQ,CAAE,UAAU,CAAEoL,GAAG,CAAE,MAAM,CAAEC,IAAI,CAAE,MAAM,CAAEC,MAAM,CAAE,IAAI,CAAEC,OAAO,CAAE,MAAM,CAAEC,UAAU,CAAE,QAAS,CAAE,CAAAnF,QAAA,eACnHhN,IAAA,UACEsO,IAAI,CAAC,MAAM,CACX8D,WAAW,CAAC,kEAAgB,CAC5BlE,KAAK,CAAE1K,UAAW,CAClB6O,QAAQ,CAAGtG,CAAC,EAAKtI,aAAa,CAACsI,CAAC,CAACnB,MAAM,CAACsD,KAAK,CAAE,CAC/CnF,SAAS,CAAC,uBAAuB,CACjC4G,OAAO,CAAG5D,CAAC,EAAK,CACdA,CAAC,CAACC,eAAe,CAAC,CAAC,CACnBrI,gBAAgB,CAAC,IAAI,CAAC,CACxB,CAAE,CACH,CAAC,CACDD,aAAa,eACZ1D,IAAA,QAAK+I,SAAS,CAAE,kBAAkBrF,aAAa,CAAG,MAAM,CAAG,EAAE,EAAG,CAACoK,GAAG,CAAElK,YAAa,CAAAoJ,QAAA,cACjFhN,IAAA,QAAK+I,SAAS,CAAC,WAAW,CAAAiE,QAAA,CACvBzB,cAAc,CAAC7D,GAAG,CAAE8D,IAAI,eACvBxL,IAAA,QAEE+I,SAAS,CAAC,WAAW,CACrB4G,OAAO,CAAEA,CAAA,GAAMzE,gBAAgB,CAACM,IAAI,CAACC,OAAO,CAAE,CAAAuB,QAAA,CAE7CxB,IAAI,CAACC,OAAO,EAJRD,IAAI,CAAC5F,EAKP,CACN,CAAC,CACC,CAAC,CACH,CACN,EACE,CAAC,cACN5F,IAAA,QAAK8N,GAAG,CAAE3J,yBAA0B,CAAC4E,SAAS,CAAC,gBAAgB,CAACoI,KAAK,CAAE,CAAErB,MAAM,CAAE,MAAO,CAAE,CAAM,CAAC,cACjG9P,IAAA,WAAQ+I,SAAS,CAAC,sBAAsB,CAAC4G,OAAO,CAAE5C,mBAAoB,CAAAC,QAAA,CAAC,QAEvE,CAAQ,CAAC,EACN,CAAC,CACH,CACN,CAEA9J,eAAe,eACdlD,IAAA,QAAK+I,SAAS,CAAC,sBAAsB,CAAAiE,QAAA,cACnC9M,KAAA,QAAK6I,SAAS,CAAC,cAAc,CAAAiE,QAAA,eAC3B9M,KAAA,MAAA8M,QAAA,EAAG,qKAAgC,CAACnL,IAAI,CAACE,OAAO,CAAC+O,IAAI,CAAC,IAAE,CAACjP,IAAI,CAACE,OAAO,CAAC6D,EAAE,CAAC,MAAG,EAAG,CAAC,cAChF1F,KAAA,QAAK6I,SAAS,CAAC,sBAAsB,CAAAiE,QAAA,eACnChN,IAAA,WAAQ+I,SAAS,CAAC,oBAAoB,CAAC4G,OAAO,CAAE/C,mBAAoB,CAAAI,QAAA,CAAC,oBAErE,CAAQ,CAAC,cACThN,IAAA,WAAQ+I,SAAS,CAAC,mBAAmB,CAAC4G,OAAO,CAAE9C,kBAAmB,CAAAG,QAAA,CAAC,cAEnE,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,CACH,CACN,EACE,CAAC,CAEV,CAEA,cAAe,CAAAnM,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}