{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate,Link}from'react-router-dom';import axios from'axios';import{useDrag,useDrop,useDragLayer}from'react-dnd';import'./Wishlist.css';import'./ProductList.css';// Import ProductList.css for shared styles\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ItemTypes={PRODUCT:'product'};function ProductCard(_ref){let{product,savedProductIds,toggleSavedProduct,getProductName,getMinPrice,setDraggedProductId}=_ref;const[{isDragging},drag]=useDrag(()=>({type:ItemTypes.PRODUCT,item:{productId:product.id},end:()=>setDraggedProductId(null),// Reset draggedProductId when drag ends\ncollect:monitor=>({isDragging:!!monitor.isDragging()})}));return/*#__PURE__*/_jsx(\"div\",{ref:drag,className:\"product-card-container\",style:{opacity:isDragging?0.5:1},onDragStart:()=>{console.log('Drag started, productId:',product.id);setDraggedProductId(product.id);},children:/*#__PURE__*/_jsxs(Link,{to:`/product/${product.id}`,className:\"product-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:getProductName(product)}),/*#__PURE__*/_jsxs(\"div\",{className:\"image-container\",children:[/*#__PURE__*/_jsx(\"img\",{src:product.images&&product.images.length>0?product.images[0]:'/img/placeholder.webp',alt:product.name,onError:e=>e.target.src='/img/placeholder.webp'}),/*#__PURE__*/_jsx(\"div\",{className:`wishlist-heart ${savedProductIds.includes(product.id)?'saved':''}`,onClick:e=>{e.preventDefault();// Prevent Link navigation on heart click\ntoggleSavedProduct(product.id);},children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:savedProductIds.includes(product.id)?'#ff0000':'none',stroke:\"#ff0000\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z\"})})})]}),/*#__PURE__*/_jsx(\"p\",{className:\"price\",children:getMinPrice(product.store_prices)}),/*#__PURE__*/_jsx(\"p\",{children:product.description||'Опис відсутній'})]})});}function CategorySection(_ref2){let{category,editingCategoryId,editedCategoryName,setEditedCategoryName,handleUpdateCategory,startEditingCategory,openDeleteModal,draggedProductId,moveProductToCategory,products,savedProductIds,toggleSavedProduct,getProductName,getMinPrice,setDraggedProductId}=_ref2;const[{isOver:isOverPlaceholder},placeholderDrop]=useDrop(()=>({accept:ItemTypes.PRODUCT,drop:item=>moveProductToCategory(item.productId,category.id),collect:monitor=>({isOver:!!monitor.isOver()})}));const categoryProducts=products.filter(product=>product.saved_category_id===category.id);return/*#__PURE__*/_jsxs(\"div\",{className:\"category-section\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"category-header\",children:editingCategoryId===category.id?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editedCategoryName,onChange:e=>setEditedCategoryName(e.target.value),className:\"category-edit-input\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"category-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"confirm-edit-btn\",onClick:()=>handleUpdateCategory(category.id),children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"#008000\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M20 6L9 17l-5-5\"})})}),/*#__PURE__*/_jsx(\"button\",{className:\"edit-category-btn\",onClick:()=>startEditingCategory(category),children:/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"#333\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M20 14.66V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h5.34\"}),/*#__PURE__*/_jsx(\"polygon\",{points:\"18 2 22 6 12 16 8 16 8 12 18 2\"})]})}),/*#__PURE__*/_jsx(\"button\",{className:\"delete-category-btn\",onClick:()=>openDeleteModal(category),children:/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"#333\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M3 6h18\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"10\",y1:\"11\",x2:\"10\",y2:\"17\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"14\",y1:\"11\",x2:\"14\",y2:\"17\"})]})})]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h3\",{children:category.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"category-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"edit-category-btn\",onClick:()=>startEditingCategory(category),children:/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"#333\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M20 14.66V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h5.34\"}),/*#__PURE__*/_jsx(\"polygon\",{points:\"18 2 22 6 12 16 8 16 8 12 18 2\"})]})}),/*#__PURE__*/_jsx(\"button\",{className:\"delete-category-btn\",onClick:()=>openDeleteModal(category),children:/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"#333\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M3 6h18\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"10\",y1:\"11\",x2:\"10\",y2:\"17\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"14\",y1:\"11\",x2:\"14\",y2:\"17\"})]})})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"drop-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"category-products products-list loaded\",children:[categoryProducts.length>0?categoryProducts.map(product=>/*#__PURE__*/_jsx(ProductCard,{product:product,savedProductIds:savedProductIds,toggleSavedProduct:toggleSavedProduct,getProductName:getProductName,getMinPrice:getMinPrice,setDraggedProductId:setDraggedProductId},product.id)):/*#__PURE__*/_jsx(\"p\",{className:\"no-products-text\",children:\"\\u041D\\u0435\\u043C\\u0430\\u0454 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0456\\u0432 \\u0443 \\u0446\\u0456\\u0439 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0456\\u0457\"}),draggedProductId&&/*#__PURE__*/_jsx(\"div\",{ref:placeholderDrop,className:`placeholder-card ${isOverPlaceholder?'drop-target':''}`,children:/*#__PURE__*/_jsx(\"span\",{className:\"plus-icon\",children:\"+\"})})]})})]});}function Wishlist(){const[products,setProducts]=useState([]);const[savedProductIds,setSavedProductIds]=useState([]);const[isLoading,setIsLoading]=useState(true);const[productError,setProductError]=useState(null);const[categoryError,setCategoryError]=useState(null);const[categories,setCategories]=useState([]);const[newCategoryName,setNewCategoryName]=useState('');const[isModalOpen,setIsModalOpen]=useState(false);const[editingCategoryId,setEditingCategoryId]=useState(null);const[editedCategoryName,setEditedCategoryName]=useState('');const[deleteCategory,setDeleteCategory]=useState(null);const[isDeleteModalOpen,setIsDeleteModalOpen]=useState(false);const[isDeleteWithProductsModalOpen,setIsDeleteWithProductsModalOpen]=useState(false);const[draggedProductId,setDraggedProductId]=useState(null);const navigate=useNavigate();// Custom auto-scroll during drag\nconst{clientOffset,isDragging}=useDragLayer(monitor=>({clientOffset:monitor.getClientOffset(),isDragging:monitor.isDragging()}));useEffect(()=>{if(!isDragging||!clientOffset)return;const zoneHeight=200;// Height of top/bottom auto-scroll zones (pixels)\nconst scrollSpeed=10;// Pixels per frame (~60fps, 16ms)\nlet scrollInterval=null;const checkScroll=()=>{const y=clientOffset.y;const windowHeight=window.innerHeight;if(y<zoneHeight){console.log('Scrolling up, y:',y);window.scrollBy(0,-scrollSpeed);}else if(y>windowHeight-zoneHeight){console.log('Scrolling down, y:',y);window.scrollBy(0,scrollSpeed);}};scrollInterval=setInterval(checkScroll,16);// ~60fps\nreturn()=>{if(scrollInterval){console.log('Stopping auto-scroll');clearInterval(scrollInterval);}};},[clientOffset,isDragging]);// Function to format product name consistently with ProductList\nconst getProductName=product=>{return`${product.name} (${product.volume||'Об’єм не вказано'})`;};// Function to get minimum price from store_prices\nconst getMinPrice=storePrices=>{if(!storePrices||storePrices.length===0)return'Немає в наявності';return`${Math.min(...storePrices.map(sp=>sp.price))} грн`;};// Drop hook for uncategorized placeholder card\nconst[{isOver:isOverUncategorizedPlaceholder},uncategorizedPlaceholderDrop]=useDrop(()=>({accept:ItemTypes.PRODUCT,drop:item=>moveProductToCategory(item.productId,null),collect:monitor=>({isOver:!!monitor.isOver()})}));// Fetch wishlist and categories\nuseEffect(()=>{const fetchWishlistAndCategories=async()=>{const token=localStorage.getItem('token');if(!token){navigate('/login');return;}setIsLoading(true);// Clean up nameless categories\ntry{await axios.delete('https://price-ua-react-backend.onrender.com/categories/cleanup',{headers:{Authorization:`Bearer ${token}`}});console.log('Nameless categories cleaned up');}catch(err){console.error('Error cleaning up nameless categories:',err);setCategoryError('Не вдалося очистити безіменні категорії');}// Fetch saved products with category IDs\ntry{const savedResponse=await axios.get('https://price-ua-react-backend.onrender.com/saved-products',{headers:{Authorization:`Bearer ${token}`}});const savedProducts=savedResponse.data.savedProducts||[];const savedIds=savedProducts.map(sp=>sp.product_id);setSavedProductIds(savedIds);if(savedIds.length===0){setProducts([]);}else{const productPromises=savedIds.map(id=>axios.get(`https://price-ua-react-backend.onrender.com/products/${id}`));const productResponses=await Promise.all(productPromises);const fetchedProducts=productResponses.map((response,index)=>{var _savedProducts$find;return{...response.data,saved_category_id:((_savedProducts$find=savedProducts.find(sp=>sp.product_id===response.data.id))===null||_savedProducts$find===void 0?void 0:_savedProducts$find.saved_category_id)||null};});setProducts(fetchedProducts);}}catch(err){var _err$response,_err$response2;console.error('Error fetching wishlist:',err);setProductError('Не вдалося завантажити список бажаного');if(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status)===401||((_err$response2=err.response)===null||_err$response2===void 0?void 0:_err$response2.status)===403){navigate('/login');}}// Fetch categories\ntry{const categoriesResponse=await axios.get('https://price-ua-react-backend.onrender.com/categories',{headers:{Authorization:`Bearer ${token}`}});setCategories(categoriesResponse.data||[]);}catch(err){var _err$response3,_err$response4;console.error('Error fetching categories:',err);setCategoryError('Не вдалося завантажити категорії');if(((_err$response3=err.response)===null||_err$response3===void 0?void 0:_err$response3.status)===401||((_err$response4=err.response)===null||_err$response4===void 0?void 0:_err$response4.status)===403){navigate('/login');}}setIsLoading(false);};fetchWishlistAndCategories();},[navigate]);// Toggle saved product\nconst toggleSavedProduct=async productId=>{const token=localStorage.getItem('token');if(!token){navigate('/login');return;}try{await axios.delete(`https://price-ua-react-backend.onrender.com/saved-products/${productId}`,{headers:{Authorization:`Bearer ${token}`}});setSavedProductIds(savedProductIds.filter(id=>id!==productId));setProducts(products.filter(product=>product.id!==productId));}catch(err){console.error('Error removing product from wishlist:',err);setProductError('Не вдалося видалити товар із бажаного');}};// Handle category creation\nconst handleAddCategory=async()=>{const token=localStorage.getItem('token');if(!token||!newCategoryName.trim()){setCategoryError('Введіть назву категорії');return;}try{const response=await axios.post('https://price-ua-react-backend.onrender.com/categories',{name:newCategoryName.trim()},{headers:{Authorization:`Bearer ${token}`}});setCategories([...categories,response.data]);setNewCategoryName('');setIsModalOpen(false);setCategoryError(null);}catch(err){console.error('Error adding category:',err);setCategoryError('Не вдалося додати категорію');}};// Handle start editing category\nconst startEditingCategory=category=>{setEditingCategoryId(category.id);setEditedCategoryName(category.name);};// Handle category name update\nconst handleUpdateCategory=async categoryId=>{const token=localStorage.getItem('token');if(!token||!editedCategoryName.trim()){setCategoryError('Введіть назву категорії');return;}const originalCategories=[...categories];const updatedCategories=categories.map(cat=>cat.id===categoryId?{...cat,name:editedCategoryName.trim()}:cat);setCategories(updatedCategories);setEditingCategoryId(null);setEditedCategoryName('');setCategoryError(null);try{await axios.put(`https://price-ua-react-backend.onrender.com/categories/${categoryId}`,{name:editedCategoryName.trim()},{headers:{Authorization:`Bearer ${token}`}});}catch(err){console.error('Error updating category:',err);setCategoryError('Не вдалося оновити категорію');setCategories(originalCategories);// Revert on failure\n}};// Handle open delete confirmation modal\nconst openDeleteModal=category=>{setDeleteCategory(category);const categoryProducts=products.filter(p=>p.saved_category_id===category.id);if(categoryProducts.length>0){setIsDeleteWithProductsModalOpen(true);}else{setIsDeleteModalOpen(true);}};// Handle close delete confirmation modals\nconst closeDeleteModal=()=>{setDeleteCategory(null);setIsDeleteModalOpen(false);setIsDeleteWithProductsModalOpen(false);setCategoryError(null);};// Handle category deletion (empty category)\nconst handleDeleteCategory=async()=>{const token=localStorage.getItem('token');if(!token||!deleteCategory){setCategoryError('Помилка видалення категорії');closeDeleteModal();return;}const originalCategories=[...categories];setCategories(categories.filter(cat=>cat.id!==deleteCategory.id));closeDeleteModal();try{await axios.delete(`https://price-ua-react-backend.onrender.com/categories/${deleteCategory.id}`,{headers:{Authorization:`Bearer ${token}`}});console.log('Empty category deleted:',deleteCategory.id);}catch(err){console.error('Error deleting category:',err);setCategoryError('Не вдалося видалити категорію');setCategories(originalCategories);}};// Handle category deletion with products (save products)\nconst handleDeleteCategorySaveProducts=async()=>{const token=localStorage.getItem('token');if(!token||!deleteCategory){setCategoryError('Помилка видалення категорії');closeDeleteModal();return;}const originalCategories=[...categories];const originalProducts=[...products];setCategories(categories.filter(cat=>cat.id!==deleteCategory.id));setProducts(products.map(p=>p.saved_category_id===deleteCategory.id?{...p,saved_category_id:null}:p));closeDeleteModal();try{// Update products to uncategorized\nconst categoryProducts=originalProducts.filter(p=>p.saved_category_id===deleteCategory.id);await Promise.all(categoryProducts.map(product=>axios.patch(`https://price-ua-react-backend.onrender.com/saved-products/${product.id}`,{saved_category_id:null},{headers:{Authorization:`Bearer ${token}`}})));// Delete category\nawait axios.delete(`https://price-ua-react-backend.onrender.com/categories/${deleteCategory.id}`,{headers:{Authorization:`Bearer ${token}`}});console.log('Category deleted, products moved to uncategorized:',deleteCategory.id);}catch(err){console.error('Error deleting category or moving products:',err);setCategoryError('Не вдалося видалити категорію або перемістити товари');setCategories(originalCategories);setProducts(originalProducts);}};// Handle category deletion with products (delete products and category)\nconst handleDeleteCategoryDeleteProducts=async()=>{const token=localStorage.getItem('token');if(!token||!deleteCategory){setCategoryError('Помилка видалення категорії');closeDeleteModal();return;}const originalCategories=[...categories];const originalProducts=[...products];const originalSavedProductIds=[...savedProductIds];const categoryProducts=products.filter(p=>p.saved_category_id===deleteCategory.id);const categoryProductIds=categoryProducts.map(p=>p.id);// Update UI\nsetCategories(categories.filter(cat=>cat.id!==deleteCategory.id));setProducts(products.filter(p=>!categoryProductIds.includes(p.id)));setSavedProductIds(savedProductIds.filter(id=>!categoryProductIds.includes(id)));closeDeleteModal();try{// Delete products\nawait Promise.all(categoryProductIds.map(productId=>axios.delete(`https://price-ua-react-backend.onrender.com/saved-products/${productId}`,{headers:{Authorization:`Bearer ${token}`}})));// Delete category\nawait axios.delete(`https://price-ua-react-backend.onrender.com/categories/${deleteCategory.id}`,{headers:{Authorization:`Bearer ${token}`}});console.log('Category and products deleted:',{categoryId:deleteCategory.id,productIds:categoryProductIds});}catch(err){console.error('Error deleting category or products:',err);setCategoryError('Не вдалося видалити категорію або товари');setCategories(originalCategories);setProducts(originalProducts);setSavedProductIds(originalSavedProductIds);}};// Handle moving product to category (or uncategorized)\nconst moveProductToCategory=async(productId,categoryId)=>{const token=localStorage.getItem('token');if(!token){navigate('/login');return;}setProducts(prevProducts=>{const updatedProducts=prevProducts.map(p=>p.id===productId?{...p,saved_category_id:categoryId}:p);return updatedProducts;});setDraggedProductId(null);try{await axios.patch(`https://price-ua-react-backend.onrender.com/saved-products/${productId}`,{saved_category_id:categoryId},{headers:{Authorization:`Bearer ${token}`}});}catch(err){console.error('Error moving product to category:',err);setCategoryError('Не вдалося перемістити товар до категорії');setProducts(prevProducts=>[...prevProducts]);setDraggedProductId(null);}};// Handle modal open/close\nconst openModal=()=>setIsModalOpen(true);const closeModal=()=>{setNewCategoryName('');setIsModalOpen(false);setCategoryError(null);};// Filter uncategorized products\nconst uncategorizedProducts=products.filter(product=>!product.saved_category_id);return/*#__PURE__*/_jsxs(\"div\",{className:\"wishlist\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"wishlist-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0421\\u043F\\u0438\\u0441\\u043E\\u043A \\u0431\\u0430\\u0436\\u0430\\u043D\\u043E\\u0433\\u043E\"}),/*#__PURE__*/_jsx(\"button\",{className:\"add-category-btn\",onClick:openModal,children:\"\\u0414\\u043E\\u0434\\u0430\\u0442\\u0438 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0456\\u044E\"})]}),isLoading&&/*#__PURE__*/_jsx(\"div\",{className:\"loading-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"spinner-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u0417\\u0430\\u0432\\u0430\\u043D\\u0442\\u0430\\u0436\\u0435\\u043D\\u043D\\u044F...\"})]})}),productError&&!products.length&&/*#__PURE__*/_jsx(\"div\",{className:\"wishlist-error\",children:productError}),categoryError&&/*#__PURE__*/_jsx(\"div\",{className:\"wishlist-error\",children:categoryError}),!isLoading&&products.length===0&&!productError&&/*#__PURE__*/_jsxs(\"div\",{className:\"wishlist-empty\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0412\\u0430\\u0448 \\u0441\\u043F\\u0438\\u0441\\u043E\\u043A \\u0431\\u0430\\u0436\\u0430\\u043D\\u043E\\u0433\\u043E \\u043F\\u043E\\u0440\\u043E\\u0436\\u043D\\u0456\\u0439\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u0414\\u043E\\u0434\\u0430\\u0439\\u0442\\u0435 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0438 \\u0434\\u043E \\u0441\\u043F\\u0438\\u0441\\u043A\\u0443 \\u0431\\u0430\\u0436\\u0430\\u043D\\u043E\\u0433\\u043E, \\u0449\\u043E\\u0431 \\u043F\\u043E\\u0431\\u0430\\u0447\\u0438\\u0442\\u0438 \\u0457\\u0445 \\u0442\\u0443\\u0442.\"})]}),!isLoading&&uncategorizedProducts.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"wishlist-products products-list loaded\",children:[uncategorizedProducts.map(product=>/*#__PURE__*/_jsx(ProductCard,{product:product,savedProductIds:savedProductIds,toggleSavedProduct:toggleSavedProduct,getProductName:getProductName,getMinPrice:getMinPrice,setDraggedProductId:setDraggedProductId},product.id)),draggedProductId&&/*#__PURE__*/_jsx(\"div\",{ref:uncategorizedPlaceholderDrop,className:`placeholder-card ${isOverUncategorizedPlaceholder?'drop-target':''}`,children:/*#__PURE__*/_jsx(\"span\",{className:\"plus-icon\",children:\"+\"})})]}),!isLoading&&categories.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"category-sections\",children:categories.map(category=>/*#__PURE__*/_jsx(CategorySection,{category:category,editingCategoryId:editingCategoryId,editedCategoryName:editedCategoryName,setEditedCategoryName:setEditedCategoryName,handleUpdateCategory:handleUpdateCategory,startEditingCategory:startEditingCategory,openDeleteModal:openDeleteModal,draggedProductId:draggedProductId,moveProductToCategory:moveProductToCategory,products:products,savedProductIds:savedProductIds,toggleSavedProduct:toggleSavedProduct,getProductName:getProductName,getMinPrice:getMinPrice,setDraggedProductId:setDraggedProductId},category.id))}),isModalOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"category-name\",children:\"\\u041D\\u0430\\u0437\\u0432\\u0430 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0456\\u0457:\"}),/*#__PURE__*/_jsx(\"input\",{id:\"category-name\",type:\"text\",value:newCategoryName,onChange:e=>setNewCategoryName(e.target.value),placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0456\\u0442\\u044C \\u043D\\u0430\\u0437\\u0432\\u0443 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0456\\u0457\"}),categoryError&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-error\",children:categoryError}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"wishlist-modal-add-btn\",onClick:handleAddCategory,children:\"\\u0414\\u043E\\u0434\\u0430\\u0442\\u0438\"}),/*#__PURE__*/_jsx(\"button\",{className:\"wishlist-modal-cancel-btn\",onClick:closeModal,children:\"\\u0421\\u043A\\u0430\\u0441\\u0443\\u0432\\u0430\\u0442\\u0438\"})]})]})}),isDeleteModalOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"delete-modal\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\u0412\\u0438 \\u0442\\u043E\\u0447\\u043D\\u043E \\u0445\\u043E\\u0447\\u0435\\u0442\\u0435 \\u0432\\u0438\\u0434\\u0430\\u043B\\u0438\\u0442\\u0438 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0456\\u044E?\"}),categoryError&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-error\",children:categoryError}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"wishlist-modal-confirm-delete-btn\",onClick:handleDeleteCategory,children:\"\\u0422\\u0430\\u043A\"}),/*#__PURE__*/_jsx(\"button\",{className:\"wishlist-modal-cancel-btn\",onClick:closeDeleteModal,children:\"\\u041D\\u0456\"})]})]})}),isDeleteWithProductsModalOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"delete-with-products-modal\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\u0423 \\u0446\\u0456\\u0439 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0456\\u0457 \\u0454 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0438, \\u0445\\u043E\\u0447\\u0435\\u0442\\u0435 \\u0457\\u0445 \\u0437\\u0431\\u0435\\u0440\\u0435\\u0433\\u0442\\u0438?\"}),categoryError&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-error\",children:categoryError}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"wishlist-modal-add-btn\",onClick:handleDeleteCategorySaveProducts,children:\"\\u0422\\u0430\\u043A, \\u0437\\u0431\\u0435\\u0440\\u0435\\u0433\\u0442\\u0438\"}),/*#__PURE__*/_jsx(\"button\",{className:\"wishlist-modal-delete-btn\",onClick:handleDeleteCategoryDeleteProducts,children:\"\\u041D\\u0456, \\u0432\\u0438\\u0434\\u0430\\u043B\\u0438\\u0442\\u0438\"}),/*#__PURE__*/_jsx(\"button\",{className:\"wishlist-modal-cancel-btn\",onClick:closeDeleteModal,children:\"\\u041D\\u0430\\u0437\\u0430\\u0434\"})]})]})})]});}export default Wishlist;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","Link","axios","useDrag","useDrop","useDragLayer","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ItemTypes","PRODUCT","ProductCard","_ref","product","savedProductIds","toggleSavedProduct","getProductName","getMinPrice","setDraggedProductId","isDragging","drag","type","item","productId","id","end","collect","monitor","ref","className","style","opacity","onDragStart","console","log","children","to","src","images","length","alt","name","onError","e","target","includes","onClick","preventDefault","xmlns","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","d","store_prices","description","CategorySection","_ref2","category","editingCategoryId","editedCategoryName","setEditedCategoryName","handleUpdateCategory","startEditingCategory","openDeleteModal","draggedProductId","moveProductToCategory","products","isOver","isOverPlaceholder","placeholderDrop","accept","drop","categoryProducts","filter","saved_category_id","value","onChange","points","x1","y1","x2","y2","map","Wishlist","setProducts","setSavedProductIds","isLoading","setIsLoading","productError","setProductError","categoryError","setCategoryError","categories","setCategories","newCategoryName","setNewCategoryName","isModalOpen","setIsModalOpen","setEditingCategoryId","deleteCategory","setDeleteCategory","isDeleteModalOpen","setIsDeleteModalOpen","isDeleteWithProductsModalOpen","setIsDeleteWithProductsModalOpen","navigate","clientOffset","getClientOffset","zoneHeight","scrollSpeed","scrollInterval","checkScroll","y","windowHeight","window","innerHeight","scrollBy","setInterval","clearInterval","volume","storePrices","Math","min","sp","price","isOverUncategorizedPlaceholder","uncategorizedPlaceholderDrop","fetchWishlistAndCategories","token","localStorage","getItem","delete","headers","Authorization","err","error","savedResponse","get","savedProducts","data","savedIds","product_id","productPromises","productResponses","Promise","all","fetchedProducts","response","index","_savedProducts$find","find","_err$response","_err$response2","status","categoriesResponse","_err$response3","_err$response4","handleAddCategory","trim","post","categoryId","originalCategories","updatedCategories","cat","put","p","closeDeleteModal","handleDeleteCategory","handleDeleteCategorySaveProducts","originalProducts","patch","handleDeleteCategoryDeleteProducts","originalSavedProductIds","categoryProductIds","productIds","prevProducts","updatedProducts","openModal","closeModal","uncategorizedProducts","htmlFor","placeholder"],"sources":["C:/Users/pushy/Documents/GitHub/price-ua-react/price-ua-react-frontend/src/components/Wishlist.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate, Link } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { useDrag, useDrop, useDragLayer } from 'react-dnd';\r\nimport './Wishlist.css';\r\nimport './ProductList.css'; // Import ProductList.css for shared styles\r\n\r\nconst ItemTypes = {\r\n  PRODUCT: 'product',\r\n};\r\n\r\nfunction ProductCard({ product, savedProductIds, toggleSavedProduct, getProductName, getMinPrice, setDraggedProductId }) {\r\n  const [{ isDragging }, drag] = useDrag(() => ({\r\n    type: ItemTypes.PRODUCT,\r\n    item: { productId: product.id },\r\n    end: () => setDraggedProductId(null), // Reset draggedProductId when drag ends\r\n    collect: (monitor) => ({\r\n      isDragging: !!monitor.isDragging(),\r\n    }),\r\n  }));\r\n\r\n  return (\r\n    <div\r\n      ref={drag}\r\n      className=\"product-card-container\"\r\n      style={{ opacity: isDragging ? 0.5 : 1 }}\r\n      onDragStart={() => {\r\n        console.log('Drag started, productId:', product.id);\r\n        setDraggedProductId(product.id);\r\n      }}\r\n    >\r\n      <Link to={`/product/${product.id}`} className=\"product-card\">\r\n        <h3>{getProductName(product)}</h3>\r\n        <div className=\"image-container\">\r\n          <img\r\n            src={product.images && product.images.length > 0 ? product.images[0] : '/img/placeholder.webp'}\r\n            alt={product.name}\r\n            onError={(e) => (e.target.src = '/img/placeholder.webp')}\r\n          />\r\n          <div\r\n            className={`wishlist-heart ${savedProductIds.includes(product.id) ? 'saved' : ''}`}\r\n            onClick={(e) => {\r\n              e.preventDefault(); // Prevent Link navigation on heart click\r\n              toggleSavedProduct(product.id);\r\n            }}\r\n          >\r\n            <svg\r\n              xmlns=\"http://www.w3.org/2000/svg\"\r\n              width=\"24\"\r\n              height=\"24\"\r\n              viewBox=\"0 0 24 24\"\r\n              fill={savedProductIds.includes(product.id) ? '#ff0000' : 'none'}\r\n              stroke=\"#ff0000\"\r\n              strokeWidth=\"2\"\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n            >\r\n              <path d=\"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z\"></path>\r\n            </svg>\r\n          </div>\r\n        </div>\r\n        <p className=\"price\">{getMinPrice(product.store_prices)}</p>\r\n        <p>{product.description || 'Опис відсутній'}</p>\r\n      </Link>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction CategorySection({ category, editingCategoryId, editedCategoryName, setEditedCategoryName, handleUpdateCategory, startEditingCategory, openDeleteModal, draggedProductId, moveProductToCategory, products, savedProductIds, toggleSavedProduct, getProductName, getMinPrice, setDraggedProductId }) {\r\n  const [{ isOver: isOverPlaceholder }, placeholderDrop] = useDrop(() => ({\r\n    accept: ItemTypes.PRODUCT,\r\n    drop: (item) => moveProductToCategory(item.productId, category.id),\r\n    collect: (monitor) => ({\r\n      isOver: !!monitor.isOver(),\r\n    }),\r\n  }));\r\n\r\n  const categoryProducts = products.filter((product) => product.saved_category_id === category.id);\r\n\r\n  return (\r\n    <div className=\"category-section\">\r\n      <div className=\"category-header\">\r\n        {editingCategoryId === category.id ? (\r\n          <>\r\n            <input\r\n              type=\"text\"\r\n              value={editedCategoryName}\r\n              onChange={(e) => setEditedCategoryName(e.target.value)}\r\n              className=\"category-edit-input\"\r\n            />\r\n            <div className=\"category-buttons\">\r\n              <button\r\n                className=\"confirm-edit-btn\"\r\n                onClick={() => handleUpdateCategory(category.id)}\r\n              >\r\n                <svg\r\n                  xmlns=\"http://www.w3.org/2000/svg\"\r\n                  width=\"20\"\r\n                  height=\"20\"\r\n                  viewBox=\"0 0 24 24\"\r\n                  fill=\"none\"\r\n                  stroke=\"#008000\"\r\n                  strokeWidth=\"2\"\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                >\r\n                  <path d=\"M20 6L9 17l-5-5\"></path>\r\n                </svg>\r\n              </button>\r\n              <button\r\n                className=\"edit-category-btn\"\r\n                onClick={() => startEditingCategory(category)}\r\n              >\r\n                <svg\r\n                  xmlns=\"http://www.w3.org/2000/svg\"\r\n                  width=\"20\"\r\n                  height=\"20\"\r\n                  viewBox=\"0 0 24 24\"\r\n                  fill=\"none\"\r\n                  stroke=\"#333\"\r\n                  strokeWidth=\"2\"\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                >\r\n                  <path d=\"M20 14.66V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h5.34\"></path>\r\n                  <polygon points=\"18 2 22 6 12 16 8 16 8 12 18 2\"></polygon>\r\n                </svg>\r\n              </button>\r\n              <button\r\n                className=\"delete-category-btn\"\r\n                onClick={() => openDeleteModal(category)}\r\n              >\r\n                <svg\r\n                  xmlns=\"http://www.w3.org/2000/svg\"\r\n                  width=\"20\"\r\n                  height=\"20\"\r\n                  viewBox=\"0 0 24 24\"\r\n                  fill=\"none\"\r\n                  stroke=\"#333\"\r\n                  strokeWidth=\"2\"\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                >\r\n                  <path d=\"M3 6h18\"></path>\r\n                  <path d=\"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6\"></path>\r\n                  <path d=\"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2\"></path>\r\n                  <line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\"></line>\r\n                  <line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\"></line>\r\n                </svg>\r\n              </button>\r\n            </div>\r\n          </>\r\n        ) : (\r\n          <>\r\n            <h3>{category.name}</h3>\r\n            <div className=\"category-buttons\">\r\n              <button\r\n                className=\"edit-category-btn\"\r\n                onClick={() => startEditingCategory(category)}\r\n              >\r\n                <svg\r\n                  xmlns=\"http://www.w3.org/2000/svg\"\r\n                  width=\"20\"\r\n                  height=\"20\"\r\n                  viewBox=\"0 0 24 24\"\r\n                  fill=\"none\"\r\n                  stroke=\"#333\"\r\n                  strokeWidth=\"2\"\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                >\r\n                  <path d=\"M20 14.66V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h5.34\"></path>\r\n                  <polygon points=\"18 2 22 6 12 16 8 16 8 12 18 2\"></polygon>\r\n                </svg>\r\n              </button>\r\n              <button\r\n                className=\"delete-category-btn\"\r\n                onClick={() => openDeleteModal(category)}\r\n              >\r\n                <svg\r\n                  xmlns=\"http://www.w3.org/2000/svg\"\r\n                  width=\"20\"\r\n                  height=\"20\"\r\n                  viewBox=\"0 0 24 24\"\r\n                  fill=\"none\"\r\n                  stroke=\"#333\"\r\n                  strokeWidth=\"2\"\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                >\r\n                  <path d=\"M3 6h18\"></path>\r\n                  <path d=\"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6\"></path>\r\n                  <path d=\"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2\"></path>\r\n                  <line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\"></line>\r\n                  <line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\"></line>\r\n                </svg>\r\n              </button>\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n      <div className=\"drop-container\">\r\n        <div className=\"category-products products-list loaded\">\r\n          {categoryProducts.length > 0 ? (\r\n            categoryProducts.map((product) => (\r\n              <ProductCard\r\n                key={product.id}\r\n                product={product}\r\n                savedProductIds={savedProductIds}\r\n                toggleSavedProduct={toggleSavedProduct}\r\n                getProductName={getProductName}\r\n                getMinPrice={getMinPrice}\r\n                setDraggedProductId={setDraggedProductId}\r\n              />\r\n            ))\r\n          ) : (\r\n            <p className=\"no-products-text\">Немає товарів у цій категорії</p>\r\n          )}\r\n          {draggedProductId && (\r\n            <div ref={placeholderDrop} className={`placeholder-card ${isOverPlaceholder ? 'drop-target' : ''}`}>\r\n              <span className=\"plus-icon\">+</span>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction Wishlist() {\r\n  const [products, setProducts] = useState([]);\r\n  const [savedProductIds, setSavedProductIds] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [productError, setProductError] = useState(null);\r\n  const [categoryError, setCategoryError] = useState(null);\r\n  const [categories, setCategories] = useState([]);\r\n  const [newCategoryName, setNewCategoryName] = useState('');\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [editingCategoryId, setEditingCategoryId] = useState(null);\r\n  const [editedCategoryName, setEditedCategoryName] = useState('');\r\n  const [deleteCategory, setDeleteCategory] = useState(null);\r\n  const [isDeleteModalOpen, setIsDeleteModalOpen] = useState(false);\r\n  const [isDeleteWithProductsModalOpen, setIsDeleteWithProductsModalOpen] = useState(false);\r\n  const [draggedProductId, setDraggedProductId] = useState(null);\r\n  const navigate = useNavigate();\r\n\r\n  // Custom auto-scroll during drag\r\n  const { clientOffset, isDragging } = useDragLayer((monitor) => ({\r\n    clientOffset: monitor.getClientOffset(),\r\n    isDragging: monitor.isDragging(),\r\n  }));\r\n\r\n  useEffect(() => {\r\n    if (!isDragging || !clientOffset) return;\r\n\r\n    const zoneHeight = 200; // Height of top/bottom auto-scroll zones (pixels)\r\n    const scrollSpeed = 10; // Pixels per frame (~60fps, 16ms)\r\n    let scrollInterval = null;\r\n\r\n    const checkScroll = () => {\r\n      const y = clientOffset.y;\r\n      const windowHeight = window.innerHeight;\r\n\r\n      if (y < zoneHeight) {\r\n        console.log('Scrolling up, y:', y);\r\n        window.scrollBy(0, -scrollSpeed);\r\n      } else if (y > windowHeight - zoneHeight) {\r\n        console.log('Scrolling down, y:', y);\r\n        window.scrollBy(0, scrollSpeed);\r\n      }\r\n    };\r\n\r\n    scrollInterval = setInterval(checkScroll, 16); // ~60fps\r\n\r\n    return () => {\r\n      if (scrollInterval) {\r\n        console.log('Stopping auto-scroll');\r\n        clearInterval(scrollInterval);\r\n      }\r\n    };\r\n  }, [clientOffset, isDragging]);\r\n\r\n  // Function to format product name consistently with ProductList\r\n  const getProductName = (product) => {\r\n    return `${product.name} (${product.volume || 'Об’єм не вказано'})`;\r\n  };\r\n\r\n  // Function to get minimum price from store_prices\r\n  const getMinPrice = (storePrices) => {\r\n    if (!storePrices || storePrices.length === 0) return 'Немає в наявності';\r\n    return `${Math.min(...storePrices.map(sp => sp.price))} грн`;\r\n  };\r\n\r\n  // Drop hook for uncategorized placeholder card\r\n  const [{ isOver: isOverUncategorizedPlaceholder }, uncategorizedPlaceholderDrop] = useDrop(() => ({\r\n    accept: ItemTypes.PRODUCT,\r\n    drop: (item) => moveProductToCategory(item.productId, null),\r\n    collect: (monitor) => ({\r\n      isOver: !!monitor.isOver(),\r\n    }),\r\n  }));\r\n\r\n  // Fetch wishlist and categories\r\n  useEffect(() => {\r\n    const fetchWishlistAndCategories = async () => {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        navigate('/login');\r\n        return;\r\n      }\r\n\r\n      setIsLoading(true);\r\n\r\n      // Clean up nameless categories\r\n      try {\r\n        await axios.delete('https://price-ua-react-backend.onrender.com/categories/cleanup', {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n        console.log('Nameless categories cleaned up');\r\n      } catch (err) {\r\n        console.error('Error cleaning up nameless categories:', err);\r\n        setCategoryError('Не вдалося очистити безіменні категорії');\r\n      }\r\n\r\n      // Fetch saved products with category IDs\r\n      try {\r\n        const savedResponse = await axios.get(\r\n          'https://price-ua-react-backend.onrender.com/saved-products',\r\n          { headers: { Authorization: `Bearer ${token}` } }\r\n        );\r\n        const savedProducts = savedResponse.data.savedProducts || [];\r\n        const savedIds = savedProducts.map((sp) => sp.product_id);\r\n        setSavedProductIds(savedIds);\r\n\r\n        if (savedIds.length === 0) {\r\n          setProducts([]);\r\n        } else {\r\n          const productPromises = savedIds.map((id) =>\r\n            axios.get(`https://price-ua-react-backend.onrender.com/products/${id}`)\r\n          );\r\n          const productResponses = await Promise.all(productPromises);\r\n          const fetchedProducts = productResponses.map((response, index) => ({\r\n            ...response.data,\r\n            saved_category_id: savedProducts.find((sp) => sp.product_id === response.data.id)?.saved_category_id || null,\r\n          }));\r\n          setProducts(fetchedProducts);\r\n        }\r\n      } catch (err) {\r\n        console.error('Error fetching wishlist:', err);\r\n        setProductError('Не вдалося завантажити список бажаного');\r\n        if (err.response?.status === 401 || err.response?.status === 403) {\r\n          navigate('/login');\r\n        }\r\n      }\r\n\r\n      // Fetch categories\r\n      try {\r\n        const categoriesResponse = await axios.get(\r\n          'https://price-ua-react-backend.onrender.com/categories',\r\n          { headers: { Authorization: `Bearer ${token}` } }\r\n        );\r\n        setCategories(categoriesResponse.data || []);\r\n      } catch (err) {\r\n        console.error('Error fetching categories:', err);\r\n        setCategoryError('Не вдалося завантажити категорії');\r\n        if (err.response?.status === 401 || err.response?.status === 403) {\r\n          navigate('/login');\r\n        }\r\n      }\r\n\r\n      setIsLoading(false);\r\n    };\r\n\r\n    fetchWishlistAndCategories();\r\n  }, [navigate]);\r\n\r\n  // Toggle saved product\r\n  const toggleSavedProduct = async (productId) => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      navigate('/login');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await axios.delete(`https://price-ua-react-backend.onrender.com/saved-products/${productId}`, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      setSavedProductIds(savedProductIds.filter((id) => id !== productId));\r\n      setProducts(products.filter((product) => product.id !== productId));\r\n    } catch (err) {\r\n      console.error('Error removing product from wishlist:', err);\r\n      setProductError('Не вдалося видалити товар із бажаного');\r\n    }\r\n  };\r\n\r\n  // Handle category creation\r\n  const handleAddCategory = async () => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token || !newCategoryName.trim()) {\r\n      setCategoryError('Введіть назву категорії');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await axios.post(\r\n        'https://price-ua-react-backend.onrender.com/categories',\r\n        { name: newCategoryName.trim() },\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n      setCategories([...categories, response.data]);\r\n      setNewCategoryName('');\r\n      setIsModalOpen(false);\r\n      setCategoryError(null);\r\n    } catch (err) {\r\n      console.error('Error adding category:', err);\r\n      setCategoryError('Не вдалося додати категорію');\r\n    }\r\n  };\r\n\r\n  // Handle start editing category\r\n  const startEditingCategory = (category) => {\r\n    setEditingCategoryId(category.id);\r\n    setEditedCategoryName(category.name);\r\n  };\r\n\r\n  // Handle category name update\r\n  const handleUpdateCategory = async (categoryId) => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token || !editedCategoryName.trim()) {\r\n      setCategoryError('Введіть назву категорії');\r\n      return;\r\n    }\r\n\r\n    const originalCategories = [...categories];\r\n    const updatedCategories = categories.map((cat) =>\r\n      cat.id === categoryId ? { ...cat, name: editedCategoryName.trim() } : cat\r\n    );\r\n    setCategories(updatedCategories);\r\n    setEditingCategoryId(null);\r\n    setEditedCategoryName('');\r\n    setCategoryError(null);\r\n\r\n    try {\r\n      await axios.put(\r\n        `https://price-ua-react-backend.onrender.com/categories/${categoryId}`,\r\n        { name: editedCategoryName.trim() },\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n    } catch (err) {\r\n      console.error('Error updating category:', err);\r\n      setCategoryError('Не вдалося оновити категорію');\r\n      setCategories(originalCategories); // Revert on failure\r\n    }\r\n  };\r\n\r\n  // Handle open delete confirmation modal\r\n  const openDeleteModal = (category) => {\r\n    setDeleteCategory(category);\r\n    const categoryProducts = products.filter((p) => p.saved_category_id === category.id);\r\n    if (categoryProducts.length > 0) {\r\n      setIsDeleteWithProductsModalOpen(true);\r\n    } else {\r\n      setIsDeleteModalOpen(true);\r\n    }\r\n  };\r\n\r\n  // Handle close delete confirmation modals\r\n  const closeDeleteModal = () => {\r\n    setDeleteCategory(null);\r\n    setIsDeleteModalOpen(false);\r\n    setIsDeleteWithProductsModalOpen(false);\r\n    setCategoryError(null);\r\n  };\r\n\r\n  // Handle category deletion (empty category)\r\n  const handleDeleteCategory = async () => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token || !deleteCategory) {\r\n      setCategoryError('Помилка видалення категорії');\r\n      closeDeleteModal();\r\n      return;\r\n    }\r\n\r\n    const originalCategories = [...categories];\r\n    setCategories(categories.filter((cat) => cat.id !== deleteCategory.id));\r\n    closeDeleteModal();\r\n\r\n    try {\r\n      await axios.delete(\r\n        `https://price-ua-react-backend.onrender.com/categories/${deleteCategory.id}`,\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n      console.log('Empty category deleted:', deleteCategory.id);\r\n    } catch (err) {\r\n      console.error('Error deleting category:', err);\r\n      setCategoryError('Не вдалося видалити категорію');\r\n      setCategories(originalCategories);\r\n    }\r\n  };\r\n\r\n  // Handle category deletion with products (save products)\r\n  const handleDeleteCategorySaveProducts = async () => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token || !deleteCategory) {\r\n      setCategoryError('Помилка видалення категорії');\r\n      closeDeleteModal();\r\n      return;\r\n    }\r\n\r\n    const originalCategories = [...categories];\r\n    const originalProducts = [...products];\r\n    setCategories(categories.filter((cat) => cat.id !== deleteCategory.id));\r\n    setProducts(\r\n      products.map((p) =>\r\n        p.saved_category_id === deleteCategory.id ? { ...p, saved_category_id: null } : p\r\n      )\r\n    );\r\n    closeDeleteModal();\r\n\r\n    try {\r\n      // Update products to uncategorized\r\n      const categoryProducts = originalProducts.filter((p) => p.saved_category_id === deleteCategory.id);\r\n      await Promise.all(\r\n        categoryProducts.map((product) =>\r\n          axios.patch(\r\n            `https://price-ua-react-backend.onrender.com/saved-products/${product.id}`,\r\n            { saved_category_id: null },\r\n            { headers: { Authorization: `Bearer ${token}` } }\r\n          )\r\n        )\r\n      );\r\n      // Delete category\r\n      await axios.delete(\r\n        `https://price-ua-react-backend.onrender.com/categories/${deleteCategory.id}`,\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n      console.log('Category deleted, products moved to uncategorized:', deleteCategory.id);\r\n    } catch (err) {\r\n      console.error('Error deleting category or moving products:', err);\r\n      setCategoryError('Не вдалося видалити категорію або перемістити товари');\r\n      setCategories(originalCategories);\r\n      setProducts(originalProducts);\r\n    }\r\n  };\r\n\r\n  // Handle category deletion with products (delete products and category)\r\n  const handleDeleteCategoryDeleteProducts = async () => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token || !deleteCategory) {\r\n      setCategoryError('Помилка видалення категорії');\r\n      closeDeleteModal();\r\n      return;\r\n    }\r\n\r\n    const originalCategories = [...categories];\r\n    const originalProducts = [...products];\r\n    const originalSavedProductIds = [...savedProductIds];\r\n    const categoryProducts = products.filter((p) => p.saved_category_id === deleteCategory.id);\r\n    const categoryProductIds = categoryProducts.map((p) => p.id);\r\n\r\n    // Update UI\r\n    setCategories(categories.filter((cat) => cat.id !== deleteCategory.id));\r\n    setProducts(products.filter((p) => !categoryProductIds.includes(p.id)));\r\n    setSavedProductIds(savedProductIds.filter((id) => !categoryProductIds.includes(id)));\r\n    closeDeleteModal();\r\n\r\n    try {\r\n      // Delete products\r\n      await Promise.all(\r\n        categoryProductIds.map((productId) =>\r\n          axios.delete(\r\n            `https://price-ua-react-backend.onrender.com/saved-products/${productId}`,\r\n            { headers: { Authorization: `Bearer ${token}` } }\r\n          )\r\n        )\r\n      );\r\n      // Delete category\r\n      await axios.delete(\r\n        `https://price-ua-react-backend.onrender.com/categories/${deleteCategory.id}`,\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n      console.log('Category and products deleted:', { categoryId: deleteCategory.id, productIds: categoryProductIds });\r\n    } catch (err) {\r\n      console.error('Error deleting category or products:', err);\r\n      setCategoryError('Не вдалося видалити категорію або товари');\r\n      setCategories(originalCategories);\r\n      setProducts(originalProducts);\r\n      setSavedProductIds(originalSavedProductIds);\r\n    }\r\n  };\r\n\r\n  // Handle moving product to category (or uncategorized)\r\n  const moveProductToCategory = async (productId, categoryId) => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      navigate('/login');\r\n      return;\r\n    }\r\n\r\n    setProducts((prevProducts) => {\r\n      const updatedProducts = prevProducts.map((p) =>\r\n        p.id === productId ? { ...p, saved_category_id: categoryId } : p\r\n      );\r\n      return updatedProducts;\r\n    });\r\n    setDraggedProductId(null);\r\n\r\n    try {\r\n      await axios.patch(\r\n        `https://price-ua-react-backend.onrender.com/saved-products/${productId}`,\r\n        { saved_category_id: categoryId },\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n    } catch (err) {\r\n      console.error('Error moving product to category:', err);\r\n      setCategoryError('Не вдалося перемістити товар до категорії');\r\n      setProducts((prevProducts) => [...prevProducts]);\r\n      setDraggedProductId(null);\r\n    }\r\n  };\r\n\r\n  // Handle modal open/close\r\n  const openModal = () => setIsModalOpen(true);\r\n  const closeModal = () => {\r\n    setNewCategoryName('');\r\n    setIsModalOpen(false);\r\n    setCategoryError(null);\r\n  };\r\n\r\n  // Filter uncategorized products\r\n  const uncategorizedProducts = products.filter((product) => !product.saved_category_id);\r\n\r\n  return (\r\n    <div className=\"wishlist\">\r\n      <div className=\"wishlist-header\">\r\n        <h2>Список бажаного</h2>\r\n        <button className=\"add-category-btn\" onClick={openModal}>\r\n          Додати категорію\r\n        </button>\r\n      </div>\r\n      {isLoading && (\r\n        <div className=\"loading-overlay\">\r\n          <div className=\"spinner-container\">\r\n            <div className=\"spinner\"></div>\r\n            <p>Завантаження...</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {productError && !products.length && <div className=\"wishlist-error\">{productError}</div>}\r\n      {categoryError && <div className=\"wishlist-error\">{categoryError}</div>}\r\n      {!isLoading && products.length === 0 && !productError && (\r\n        <div className=\"wishlist-empty\">\r\n          <h2>Ваш список бажаного порожній</h2>\r\n          <p>Додайте товари до списку бажаного, щоб побачити їх тут.</p>\r\n        </div>\r\n      )}\r\n      {!isLoading && uncategorizedProducts.length > 0 && (\r\n        <div className=\"wishlist-products products-list loaded\">\r\n          {uncategorizedProducts.map((product) => (\r\n            <ProductCard\r\n              key={product.id}\r\n              product={product}\r\n              savedProductIds={savedProductIds}\r\n              toggleSavedProduct={toggleSavedProduct}\r\n              getProductName={getProductName}\r\n              getMinPrice={getMinPrice}\r\n              setDraggedProductId={setDraggedProductId}\r\n            />\r\n          ))}\r\n          {draggedProductId && (\r\n            <div ref={uncategorizedPlaceholderDrop} className={`placeholder-card ${isOverUncategorizedPlaceholder ? 'drop-target' : ''}`}>\r\n              <span className=\"plus-icon\">+</span>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n      {!isLoading && categories.length > 0 && (\r\n        <div className=\"category-sections\">\r\n          {categories.map((category) => (\r\n            <CategorySection\r\n              key={category.id}\r\n              category={category}\r\n              editingCategoryId={editingCategoryId}\r\n              editedCategoryName={editedCategoryName}\r\n              setEditedCategoryName={setEditedCategoryName}\r\n              handleUpdateCategory={handleUpdateCategory}\r\n              startEditingCategory={startEditingCategory}\r\n              openDeleteModal={openDeleteModal}\r\n              draggedProductId={draggedProductId}\r\n              moveProductToCategory={moveProductToCategory}\r\n              products={products}\r\n              savedProductIds={savedProductIds}\r\n              toggleSavedProduct={toggleSavedProduct}\r\n              getProductName={getProductName}\r\n              getMinPrice={getMinPrice}\r\n              setDraggedProductId={setDraggedProductId}\r\n            />\r\n          ))}\r\n        </div>\r\n      )}\r\n      {isModalOpen && (\r\n        <div className=\"modal-overlay\">\r\n          <div className=\"modal\">\r\n            <label htmlFor=\"category-name\">Назва категорії:</label>\r\n            <input\r\n              id=\"category-name\"\r\n              type=\"text\"\r\n              value={newCategoryName}\r\n              onChange={(e) => setNewCategoryName(e.target.value)}\r\n              placeholder=\"Введіть назву категорії\"\r\n            />\r\n            {categoryError && <div className=\"modal-error\">{categoryError}</div>}\r\n            <div className=\"modal-buttons\">\r\n              <button className=\"wishlist-modal-add-btn\" onClick={handleAddCategory}>Додати</button>\r\n              <button className=\"wishlist-modal-cancel-btn\" onClick={closeModal}>Скасувати</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {isDeleteModalOpen && (\r\n        <div className=\"modal-overlay\">\r\n          <div className=\"delete-modal\">\r\n            <p>Ви точно хочете видалити категорію?</p>\r\n            {categoryError && <div className=\"modal-error\">{categoryError}</div>}\r\n            <div className=\"modal-buttons\">\r\n              <button className=\"wishlist-modal-confirm-delete-btn\" onClick={handleDeleteCategory}>Так</button>\r\n              <button className=\"wishlist-modal-cancel-btn\" onClick={closeDeleteModal}>Ні</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {isDeleteWithProductsModalOpen && (\r\n        <div className=\"modal-overlay\">\r\n          <div className=\"delete-with-products-modal\">\r\n            <p>У цій категорії є товари, хочете їх зберегти?</p>\r\n            {categoryError && <div className=\"modal-error\">{categoryError}</div>}\r\n            <div className=\"modal-buttons\">\r\n              <button className=\"wishlist-modal-add-btn\" onClick={handleDeleteCategorySaveProducts}>Так, зберегти</button>\r\n              <button className=\"wishlist-modal-delete-btn\" onClick={handleDeleteCategoryDeleteProducts}>Ні, видалити</button>\r\n              <button className=\"wishlist-modal-cancel-btn\" onClick={closeDeleteModal}>Назад</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Wishlist;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}