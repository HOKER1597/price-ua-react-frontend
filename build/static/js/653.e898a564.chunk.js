"use strict";(self.webpackChunkprice_ua=self.webpackChunkprice_ua||[]).push([[653],{3388:(e,r,t)=>{t.d(r,{$:()=>m});var a=t(2555),s=t(3986),n=t(5043),i=t(917),o=t(8557),l=t(2024),c=t(579);const d=["className","variant","size","isLoading","leftIcon","rightIcon","children","disabled"],u=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-medium transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 active:scale-[0.98]",{variants:{variant:{primary:"bg-primary-500 text-white shadow-md hover:bg-primary-600 hover:shadow-lg focus-visible:ring-primary-500",secondary:"bg-primary-100 text-primary-700 shadow-sm hover:bg-primary-200 hover:shadow-md focus-visible:ring-primary-500 dark:bg-primary-900/30 dark:text-primary-300 dark:hover:bg-primary-900/50",accent:"bg-primary-500 text-white shadow-md hover:bg-primary-600 hover:shadow-lg focus-visible:ring-primary-500",outline:"border-2 border-primary-500 text-primary-500 hover:bg-primary-50 dark:hover:bg-primary-900/20 focus-visible:ring-primary-500",ghost:"text-foreground/70 hover:bg-primary-50 dark:hover:bg-card-dark focus-visible:ring-primary-500",link:"text-primary-500 underline-offset-4 hover:underline focus-visible:ring-primary-500",danger:"bg-error-500 text-white shadow-md hover:bg-error-600 hover:shadow-lg focus-visible:ring-error-500",success:"bg-success-500 text-white shadow-md hover:bg-success-600 hover:shadow-lg focus-visible:ring-success-500"},size:{xs:"h-7 px-2 text-xs rounded-md",sm:"h-8 px-3 text-xs",md:"h-10 px-4",lg:"h-12 px-6 text-base",xl:"h-14 px-8 text-lg",icon:"h-10 w-10","icon-sm":"h-8 w-8","icon-lg":"h-12 w-12"}},defaultVariants:{variant:"primary",size:"md"}}),m=(0,n.forwardRef)(((e,r)=>{let{className:t,variant:n,size:i,isLoading:m,leftIcon:x,rightIcon:h,children:g,disabled:p}=e,f=(0,s.A)(e,d);return(0,c.jsxs)("button",(0,a.A)((0,a.A)({className:(0,o.cn)(u({variant:n,size:i,className:t})),ref:r,disabled:p||m},f),{},{children:[m?(0,c.jsx)(l.A,{className:"h-4 w-4 animate-spin"}):x||null,g,!m&&h]}))}));m.displayName="Button"},4049:(e,r,t)=>{t.d(r,{B:()=>c});var a=t(5043),s=t(9002),n=t(3658),i=t(8326),o=t(8557),l=t(579);function c(e){let{items:r,className:t}=e;return(0,l.jsxs)("nav",{className:(0,o.cn)("flex items-center gap-1.5 text-sm",t),"aria-label":"Breadcrumb",children:[(0,l.jsx)(s.N_,{to:"/",className:"flex items-center text-foreground/40 transition-colors hover:text-primary-500",children:(0,l.jsx)(n.A,{className:"h-4 w-4"})}),r.map(((e,r)=>(0,l.jsxs)(a.Fragment,{children:[(0,l.jsx)(i.A,{className:"h-3.5 w-3.5 text-foreground/30"}),e.href?(0,l.jsx)(s.N_,{to:e.href,className:"text-foreground/50 transition-colors hover:text-primary-500",children:e.label}):(0,l.jsx)("span",{className:"text-foreground/70 font-medium",children:e.label})]},r)))]})}},9057:(e,r,t)=>{t.r(r),t.d(r,{default:()=>q});var a=t(5043),s=t(9002),n=t(4227),i=t(9570),o=t(8006),l=t(9722),c=t(9688);var d=t(1531),u=t(9463),m=t(8326),x=t(614),h=t(8557),g=t(579);function p(e){let{images:r,productName:t}=e;const[s,o]=(0,a.useState)(0),[l,c]=(0,a.useState)(!1),[p,f]=(0,a.useState)(null),b=(0,a.useCallback)((e=>{null===e||void 0===e||e.stopPropagation(),f("left"),o((e=>0===e?r.length-1:e-1))}),[r.length]),v=(0,a.useCallback)((e=>{null===e||void 0===e||e.stopPropagation(),f("right"),o((e=>e===r.length-1?0:e+1))}),[r.length]),y=e=>{e!==s&&(f(e>s?"right":"left"),o(e))};(0,a.useEffect)((()=>{const e=e=>{l&&("ArrowLeft"===e.key?b():"ArrowRight"===e.key?v():"Escape"===e.key&&c(!1))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[l,b,v]),(0,a.useEffect)((()=>(document.body.style.overflow=l?"hidden":"",()=>{document.body.style.overflow=""})),[l]);const j={enter:e=>({x:"right"===e?300:"left"===e?-300:0,opacity:0}),center:{x:0,opacity:1},exit:e=>({x:"right"===e?-300:"left"===e?300:0,opacity:0})};return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,g.jsxs)("div",{onClick:()=>c(!0),className:"group relative aspect-square w-full cursor-zoom-in overflow-hidden rounded-2xl bg-surface-light dark:bg-card-dark",children:[(0,g.jsx)(i.N,{mode:"wait",custom:p,children:(0,g.jsx)(n.P.img,{src:r[s],alt:"".concat(t," ").concat(s+1),custom:p,variants:j,initial:"enter",animate:"center",exit:"exit",transition:{duration:.3,ease:"easeInOut"},className:"h-full w-full object-contain",onError:e=>{e.target.src="/img/placeholder.webp"}},s)}),(0,g.jsx)("div",{className:"absolute bottom-4 right-4 rounded-full bg-surface-dark/50 p-2 opacity-0 transition-opacity group-hover:opacity-100",children:(0,g.jsx)(d.A,{className:"h-5 w-5 text-white"})}),r.length>1&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("button",{onClick:b,className:"absolute left-2 top-1/2 -translate-y-1/2 rounded-full bg-card-light/80 p-2 shadow-lg opacity-0 transition-all hover:bg-card-light group-hover:opacity-100 dark:bg-card-dark/80 dark:hover:bg-card-dark",children:(0,g.jsx)(u.A,{className:"h-5 w-5 text-foreground/70"})}),(0,g.jsx)("button",{onClick:v,className:"absolute right-2 top-1/2 -translate-y-1/2 rounded-full bg-card-light/80 p-2 shadow-lg opacity-0 transition-all hover:bg-card-light group-hover:opacity-100 dark:bg-card-dark/80 dark:hover:bg-card-dark",children:(0,g.jsx)(m.A,{className:"h-5 w-5 text-foreground/70"})})]})]}),r.length>1&&(0,g.jsxs)("div",{className:"flex gap-2 overflow-x-auto pb-1",children:[r.slice(0,5).map(((e,r)=>(0,g.jsx)("button",{onClick:()=>y(r),className:(0,h.cn)("relative h-16 w-16 flex-shrink-0 overflow-hidden rounded-lg border-2 transition-all",r===s?"border-primary-500 ring-2 ring-primary-500/30":"border-border hover:border-primary-300"),children:(0,g.jsx)("img",{src:e,alt:"".concat(t," ").concat(r+1),className:"h-full w-full object-cover",onError:e=>{e.target.src="/img/placeholder.webp"}})},r))),r.length>5&&(0,g.jsxs)("button",{onClick:()=>y(5),className:"relative h-16 w-16 flex-shrink-0 overflow-hidden rounded-lg border-2 border-border transition-all hover:border-primary-300",children:[(0,g.jsx)("img",{src:r[5],alt:"".concat(t," more"),className:"h-full w-full object-cover opacity-50",onError:e=>{e.target.src="/img/placeholder.webp"}}),(0,g.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/40 text-sm font-bold text-white",children:["+",r.length-5]})]})]})]}),(0,g.jsx)(i.N,{children:l&&(0,g.jsxs)(n.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90",onClick:()=>c(!1),children:[(0,g.jsx)("button",{onClick:()=>c(!1),className:"absolute right-4 top-4 z-10 rounded-full bg-white/10 p-3 text-white transition-colors hover:bg-white/20",children:(0,g.jsx)(x.A,{className:"h-6 w-6"})}),(0,g.jsx)(i.N,{mode:"wait",custom:p,children:(0,g.jsx)(n.P.img,{src:r[s],alt:"".concat(t," ").concat(s+1),custom:p,variants:j,initial:"enter",animate:"center",exit:"exit",transition:{duration:.3,ease:"easeInOut"},className:"max-h-[90vh] max-w-[90vw] object-contain",onClick:e=>e.stopPropagation(),onError:e=>{e.target.src="/img/placeholder.webp"}},s)}),r.length>1&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("button",{onClick:e=>{e.stopPropagation(),b()},className:"absolute left-4 top-1/2 -translate-y-1/2 rounded-full bg-white/10 p-4 text-white transition-colors hover:bg-white/20",children:(0,g.jsx)(u.A,{className:"h-8 w-8"})}),(0,g.jsx)("button",{onClick:e=>{e.stopPropagation(),v()},className:"absolute right-4 top-1/2 -translate-y-1/2 rounded-full bg-white/10 p-4 text-white transition-colors hover:bg-white/20",children:(0,g.jsx)(m.A,{className:"h-8 w-8"})})]}),(0,g.jsxs)("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 rounded-full bg-surface-dark/50 px-4 py-2 text-sm text-white",children:[s+1," / ",r.length]})]})})]})}var f=t(3944),b=t(9989),v=t(9855),y=t(5087),j=t(8306),w=t(2054),N=t(9996),k=t(764),A=t(4918),C=t(3388);function _(e){var r,t;let{product:i,minPrice:o,isSaved:l,onToggleSave:c,onDelete:d,onScrollToPrices:u,isAdmin:m}=e;const x=(0,s.Zp)(),[p,_]=(0,a.useState)(!1),[S,z]=(0,a.useState)(!1),P=localStorage.getItem("token"),E=Number(i.rating)||0,I=Number(i.review_count)||0,L=(null===(r=i.store_prices)||void 0===r?void 0:r.length)||0,R=i.store_prices?[...i.store_prices].sort(((e,r)=>e.price-r.price)):[],T=R[0],M=R.length>1?null===(t=R[R.length-1])||void 0===t?void 0:t.price:0,H=T&&M>0?Math.round((M-T.price)/M*100):0;return(0,g.jsxs)("div",{className:"flex flex-col gap-4",children:[m&&(0,g.jsxs)("div",{className:"flex gap-2",children:[(0,g.jsx)(C.$,{variant:"outline",size:"sm",onClick:()=>{x("/admin/product-edit?productId=".concat(i.id))},leftIcon:(0,g.jsx)(b.A,{className:"h-4 w-4"}),children:"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438"}),(0,g.jsx)(C.$,{variant:"danger",size:"sm",onClick:d,leftIcon:(0,g.jsx)(v.A,{className:"h-4 w-4"}),children:"\u0412\u0438\u0434\u0430\u043b\u0438\u0442\u0438"})]}),i.brand_name&&(0,g.jsx)(s.N_,{to:"/search?query=".concat(encodeURIComponent(i.brand_name)),className:"text-sm font-semibold text-primary-500 hover:text-primary-600",children:i.brand_name}),(0,g.jsx)("h1",{className:"font-serif text-2xl font-bold text-foreground lg:text-3xl",children:i.name}),(0,g.jsxs)("div",{className:"flex flex-wrap items-center gap-4 text-sm text-foreground/50",children:[E>0&&(0,g.jsxs)("div",{className:"flex items-center gap-1",children:[(e=>{const r=[],t=Math.floor(e),a=e%1>=.5;for(let s=0;s<5;s++)s<t?r.push((0,g.jsx)(f.A,{className:"h-4 w-4 fill-amber-400 text-amber-400"},s)):s===t&&a?r.push((0,g.jsx)(f.A,{className:"h-4 w-4 fill-amber-400/50 text-amber-400"},s)):r.push((0,g.jsx)(f.A,{className:"h-4 w-4 text-border"},s));return r})(E),(0,g.jsx)("span",{className:"ml-1 font-medium text-foreground/70",children:E.toFixed(1)}),I>0&&(0,g.jsxs)("span",{children:["(",I," \u0432\u0456\u0434\u0433\u0443\u043a\u0456\u0432)"]})]}),(0,g.jsxs)("div",{className:"flex items-center gap-1",children:[(0,g.jsx)(y.A,{className:"h-4 w-4"}),(0,g.jsxs)("span",{children:[i.views||0," \u043f\u0435\u0440\u0435\u0433\u043b\u044f\u0434\u0456\u0432"]})]}),(0,g.jsxs)("button",{onClick:async()=>{try{await navigator.clipboard.writeText(window.location.href)}catch(e){}},className:"flex items-center gap-1 text-foreground/40 transition-colors hover:text-primary-500",children:[(0,g.jsx)(j.A,{className:"h-4 w-4"}),(0,g.jsx)("span",{children:"\u041f\u043e\u0434\u0456\u043b\u0438\u0442\u0438\u0441\u044f"})]})]}),L>0&&(0,g.jsxs)("div",{className:"flex items-center gap-1.5 text-sm text-success-600",children:[(0,g.jsx)(w.A,{className:"h-4 w-4"}),(0,g.jsx)("span",{className:"font-medium",children:"\u0404 \u0432 \u043d\u0430\u044f\u0432\u043d\u043e\u0441\u0442\u0456"}),(0,g.jsxs)("span",{className:"text-foreground/40",children:["\u2014 ",L," ",1===L?"\u043c\u0430\u0433\u0430\u0437\u0438\u043d":L<5?"\u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0438":"\u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0456\u0432"]})]}),(0,g.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[i.volume&&(0,g.jsx)("span",{className:"rounded-full bg-badge px-3 py-1 text-xs text-foreground/60 dark:bg-card-dark",children:i.volume}),i.code&&(0,g.jsxs)("span",{className:"rounded-full bg-badge px-3 py-1 text-xs text-foreground/40 dark:bg-card-dark",children:["\u041a\u043e\u0434: ",i.code]})]}),T&&(0,g.jsxs)("div",{className:"rounded-xl bg-gradient-to-r from-success-50 to-success-100 p-5 dark:from-success-900/20 dark:to-success-900/10",children:[(0,g.jsx)("div",{className:"mb-1 text-sm text-foreground/50",children:"\u041d\u0430\u0439\u043a\u0440\u0430\u0449\u0430 \u0446\u0456\u043d\u0430"}),(0,g.jsxs)("div",{className:"mb-1 flex items-baseline gap-3",children:[(0,g.jsxs)("span",{className:"text-3xl font-bold text-success-600",children:[T.price," \u20b4"]}),H>0&&(0,g.jsxs)("span",{className:"flex items-center gap-0.5 rounded-full bg-success-500 px-2 py-0.5 text-xs font-medium text-white",children:[(0,g.jsx)(N.A,{className:"h-3 w-3"}),"\u043d\u0430 ",H,"% \u0434\u0435\u0448\u0435\u0432\u0448\u0435"]})]}),(0,g.jsxs)("div",{className:"mb-3 text-sm text-foreground/50",children:["\u0432 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0456 ",(0,g.jsx)("span",{className:"font-medium text-foreground/70",children:T.name})]}),(0,g.jsxs)("a",{href:T.link||"#",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 rounded-full bg-success-500 px-5 py-2.5 text-sm font-medium text-white transition-colors hover:bg-success-600",children:["\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 ",T.name,(0,g.jsx)(k.A,{className:"h-4 w-4"})]})]}),(0,g.jsxs)("div",{className:"flex items-center gap-3",children:[(0,g.jsx)(C.$,{onClick:u,variant:"outline",size:"sm",children:"\u041f\u043e\u0440\u0456\u0432\u043d\u044f\u0442\u0438 \u0446\u0456\u043d\u0438"}),(0,g.jsxs)(n.P.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:async e=>{if(e.preventDefault(),!P)return _(!0),void setTimeout((()=>_(!1)),3e3);z(!0);try{await c()}catch(r){console.error("Save toggle error:",r)}finally{z(!1)}},disabled:S,className:(0,h.cn)("relative rounded-full p-3 transition-colors",l?"bg-error-100 text-error-500 dark:bg-error-900/30":"bg-badge text-foreground/40 hover:text-error-500 dark:bg-card-dark"),children:[(0,g.jsx)(A.A,{className:(0,h.cn)("h-5 w-5",l&&"fill-current")}),p&&(0,g.jsxs)(n.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"absolute -bottom-12 right-0 z-10 whitespace-nowrap rounded-lg bg-microbar px-3 py-2 text-xs text-white shadow-lg",children:["\u0423\u0432\u0456\u0439\u0434\u0456\u0442\u044c \u0432"," ",(0,g.jsx)(s.N_,{to:"/login",className:"text-primary-400 underline",children:"\u0430\u043a\u043a\u0430\u0443\u043d\u0442"})]})]})]})]})}var S=t(7856);function z(e){let{features:r}=e;return 0===r.length?(0,g.jsxs)("div",{className:"rounded-2xl bg-card-light p-6 shadow-soft dark:bg-card-dark",children:[(0,g.jsxs)("div",{className:"mb-4 flex items-center gap-3",children:[(0,g.jsx)("div",{className:"rounded-lg bg-primary-100 p-2 dark:bg-primary-900/30",children:(0,g.jsx)(S.A,{className:"h-5 w-5 text-primary-500"})}),(0,g.jsx)("h2",{className:"font-serif text-xl font-bold text-foreground",children:"\u0425\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438"})]}),(0,g.jsx)("p",{className:"text-foreground/50",children:"\u0425\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438 \u0432\u0456\u0434\u0441\u0443\u0442\u043d\u0456"})]}):(0,g.jsxs)(n.P.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"rounded-2xl bg-card-light p-6 shadow-soft dark:bg-card-dark",children:[(0,g.jsxs)("div",{className:"mb-6 flex items-center gap-3",children:[(0,g.jsx)("div",{className:"rounded-lg bg-primary-100 p-2 dark:bg-primary-900/30",children:(0,g.jsx)(S.A,{className:"h-5 w-5 text-primary-500"})}),(0,g.jsx)("h2",{className:"font-serif text-xl font-bold text-foreground",children:"\u0425\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438"})]}),(0,g.jsx)("div",{className:"overflow-hidden rounded-xl border border-border",children:r.map(((e,r)=>(0,g.jsxs)("div",{className:"flex items-center justify-between gap-4 px-4 py-3 ".concat(r%2===0?"bg-bgAlt dark:bg-surface-dark/50":""),children:[(0,g.jsx)("span",{className:"text-sm text-foreground/50",children:e.key}),(0,g.jsx)("span",{className:"text-right text-sm font-medium text-foreground",children:e.value})]},e.key)))})]})}var P=t(1680),E=t(2382);function I(e){let{description:r}=e;const[t,s]=(0,a.useState)(!1),o=r&&r.length>500,l=o&&!t?r.slice(0,500)+"...":r;return(0,g.jsxs)(n.P.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"rounded-2xl bg-card-light p-6 shadow-soft dark:bg-card-dark",children:[(0,g.jsxs)("div",{className:"mb-4 flex items-center gap-3",children:[(0,g.jsx)("div",{className:"rounded-lg bg-primary-100 p-2 dark:bg-primary-900/30",children:(0,g.jsx)(P.A,{className:"h-5 w-5 text-primary-500"})}),(0,g.jsx)("h2",{className:"font-serif text-xl font-bold text-foreground",children:"\u041e\u043f\u0438\u0441 \u0442\u043e\u0432\u0430\u0440\u0443"})]}),r?(0,g.jsxs)("div",{className:"prose prose-sm max-w-none dark:prose-invert",children:[(0,g.jsx)(i.N,{mode:"wait",children:(0,g.jsx)(n.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:(c=l||r,c.split("\n\n").map(((e,r)=>{if(e.startsWith("**")&&e.endsWith("**")){const t=e.slice(2,-2);return(0,g.jsx)("h4",{className:"mt-4 font-semibold text-foreground",children:t},r)}return(0,g.jsx)("p",{className:"mt-2 text-foreground/60",children:e},r)})))},t?"expanded":"collapsed")}),o&&(0,g.jsxs)("button",{onClick:()=>s(!t),className:"mt-4 flex items-center gap-1 text-sm font-medium text-primary-500 hover:text-primary-600",children:[t?"\u0417\u0433\u043e\u0440\u043d\u0443\u0442\u0438":"\u0427\u0438\u0442\u0430\u0442\u0438 \u0434\u0430\u043b\u0456",(0,g.jsx)(E.A,{className:(0,h.cn)("h-4 w-4 text-primary-500 transition-transform",t&&"rotate-180")})]})]}):(0,g.jsx)("p",{className:"text-foreground/50",children:"\u041e\u043f\u0438\u0441 \u0432\u0456\u0434\u0441\u0443\u0442\u043d\u0456\u0439"})]});var c}var L=t(7033),R=t(6511);function T(e){var r,t;let{storePrices:a}=e;if(!a||0===a.length)return(0,g.jsxs)("div",{className:"rounded-2xl bg-card-light p-6 shadow-soft dark:bg-card-dark",children:[(0,g.jsxs)("div",{className:"mb-4 flex items-center gap-3",children:[(0,g.jsx)("div",{className:"rounded-lg bg-primary-100 p-2 dark:bg-primary-900/30",children:(0,g.jsx)(L.A,{className:"h-5 w-5 text-primary-500"})}),(0,g.jsx)("h2",{className:"font-serif text-xl font-bold text-foreground",children:"\u041f\u043e\u0440\u0456\u0432\u043d\u044f\u043d\u043d\u044f \u0446\u0456\u043d"})]}),(0,g.jsx)("p",{className:"text-foreground/50",children:"\u0426\u0456\u043d\u0438 \u0432 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0430\u0445 \u0432\u0456\u0434\u0441\u0443\u0442\u043d\u0456"})]});const s=[...a].sort(((e,r)=>e.price-r.price)),i=null===(r=s[0])||void 0===r?void 0:r.price,o=(null===(t=s[s.length-1])||void 0===t?void 0:t.price)-i;return(0,g.jsxs)(n.P.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"rounded-2xl bg-card-light p-6 shadow-soft dark:bg-card-dark",children:[(0,g.jsxs)("div",{className:"mb-6 flex flex-wrap items-center gap-3",children:[(0,g.jsx)("div",{className:"rounded-lg bg-primary-100 p-2 dark:bg-primary-900/30",children:(0,g.jsx)(L.A,{className:"h-5 w-5 text-primary-500"})}),(0,g.jsx)("h2",{className:"font-serif text-xl font-bold text-foreground",children:"\u041f\u043e\u0440\u0456\u0432\u043d\u044f\u043d\u043d\u044f \u0446\u0456\u043d"}),(0,g.jsxs)("span",{className:"rounded-full bg-badge px-3 py-1 text-sm text-foreground/50 dark:bg-card-dark dark:text-foreground/40",children:[a.length," ",1===a.length?"\u043c\u0430\u0433\u0430\u0437\u0438\u043d":a.length<5?"\u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0438":"\u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0456\u0432"]}),o>0&&(0,g.jsxs)("span",{className:"ml-auto rounded-full bg-success-500 px-3 py-1 text-sm font-medium text-white",children:["\u0415\u043a\u043e\u043d\u043e\u043c\u0456\u044f \u0434\u043e ",o," \u0433\u0440\u043d"]})]}),(0,g.jsx)("div",{className:"hidden overflow-hidden rounded-xl border border-border md:block",children:(0,g.jsxs)("table",{className:"w-full",children:[(0,g.jsx)("thead",{children:(0,g.jsxs)("tr",{className:"border-b border-border bg-bgAlt dark:bg-surface-dark",children:[(0,g.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-foreground/50",children:"\u041c\u0430\u0433\u0430\u0437\u0438\u043d"}),(0,g.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-foreground/50",children:"\u0426\u0456\u043d\u0430"}),(0,g.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-foreground/50",children:"\u0414\u043e\u0441\u0442\u0430\u0432\u043a\u0430"}),(0,g.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-foreground/50",children:"\u0414\u0456\u044f"})]})}),(0,g.jsx)("tbody",{children:s.map(((e,r)=>{const t=e.price===i;return(0,g.jsxs)("tr",{className:t?"bg-success-50 dark:bg-success-900/10":r%2===1?"bg-bgAlt/50 dark:bg-surface-dark/50":"",children:[(0,g.jsx)("td",{className:"px-4 py-3",children:(0,g.jsxs)("div",{className:"flex items-center gap-3",children:[e.logo?(0,g.jsx)("img",{src:e.logo,alt:e.name,className:"h-8 w-8 rounded-lg object-contain",onError:e=>{e.target.src="/img/placeholder.webp"}}):(0,g.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-primary-100 dark:bg-primary-900/30",children:(0,g.jsx)(R.A,{className:"h-4 w-4 text-primary-500"})}),(0,g.jsx)("span",{className:"font-medium text-foreground",children:e.name})]})}),(0,g.jsx)("td",{className:"px-4 py-3",children:(0,g.jsxs)("div",{className:"flex items-center gap-2",children:[(0,g.jsxs)("span",{className:"text-lg font-bold ".concat(t?"text-success-600":"text-foreground"),children:[e.price," \u20b4"]}),t&&(0,g.jsx)("span",{className:"rounded-full bg-success-500 px-2 py-0.5 text-xs font-medium text-white",children:"MIN"})]})}),(0,g.jsx)("td",{className:"px-4 py-3 text-sm text-foreground/50",children:e.delivery||"\u2014"}),(0,g.jsx)("td",{className:"px-4 py-3 text-right",children:(0,g.jsxs)("a",{href:e.link||"#",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 rounded-full px-4 py-1.5 text-sm font-medium transition-colors ".concat(t?"bg-success-500 text-white hover:bg-success-600":"border border-primary-500/30 text-primary-500 hover:bg-primary-50 dark:hover:bg-primary-900/20"),children:["\u041a\u0443\u043f\u0438\u0442\u0438",(0,g.jsx)(k.A,{className:"h-3.5 w-3.5"})]})})]},"".concat(e.store_id,"-").concat(r))}))})]})}),(0,g.jsx)("div",{className:"space-y-3 md:hidden",children:s.map(((e,r)=>{const t=e.price===i;return(0,g.jsxs)("div",{className:"relative rounded-xl border p-4 ".concat(t?"border-success-500/30 bg-success-50 dark:bg-success-900/10":"border-border"),children:[t&&(0,g.jsx)("span",{className:"absolute -top-2 left-3 rounded-full bg-success-500 px-2 py-0.5 text-xs font-medium text-white",children:"MIN"}),(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("div",{className:"flex items-center gap-3",children:[e.logo?(0,g.jsx)("img",{src:e.logo,alt:e.name,className:"h-8 w-8 rounded-lg object-contain",onError:e=>{e.target.src="/img/placeholder.webp"}}):(0,g.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-primary-100 dark:bg-primary-900/30",children:(0,g.jsx)(R.A,{className:"h-4 w-4 text-primary-500"})}),(0,g.jsxs)("div",{children:[(0,g.jsx)("span",{className:"font-medium text-foreground",children:e.name}),e.delivery&&(0,g.jsx)("div",{className:"text-xs text-foreground/40",children:e.delivery})]})]}),(0,g.jsxs)("div",{className:"text-right",children:[(0,g.jsxs)("div",{className:"text-lg font-bold ".concat(t?"text-success-600":"text-foreground"),children:[e.price," \u20b4"]}),(0,g.jsx)("a",{href:e.link||"#",target:"_blank",rel:"noopener noreferrer",className:"text-xs font-medium text-primary-500 hover:text-primary-600",children:"\u041a\u0443\u043f\u0438\u0442\u0438 \u2192"})]})]})]},"".concat(e.store_id,"-").concat(r))}))})]})}var M=t(2555),H=t(7950),F=t(8969),B=t(3817),$=t(9292),O=t(2580),D=t(228),U=t.n(D);t(6433),t(5632),t(1845),t(4260);function Z(e){let{storeLocations:r,storePrices:t,cities:s,cityCoordinates:l}=e;const c=(0,a.useRef)(null),d=(0,a.useRef)(null),u=(0,a.useRef)(null),m=(0,a.useRef)(null),p=(0,a.useRef)(null),f=(0,a.useRef)(null),b=(0,a.useRef)({}),v=(0,a.useRef)({}),y=(0,a.useRef)(!1),j=(0,a.useRef)(!1),[w,N]=(0,a.useState)(!1),[k,A]=(0,a.useState)(null),[_,S]=(0,a.useState)(null),[z,P]=(0,a.useState)(""),[E,I]=(0,a.useState)(!1),[L,R]=(0,a.useState)([]),[T,D]=(0,a.useState)(!1),[Z,V]=(0,a.useState)(!1),W=(0,a.useRef)(null),q=(0,a.useRef)(null),G=localStorage.getItem("userLocationStatus"),J=G&&"denied"!==G?G:"\u041a\u0438\u0457\u0432",Y=(0,a.useMemo)((()=>["\u041a\u0438\u0457\u0432","\u0425\u0430\u0440\u043a\u0456\u0432","\u041e\u0434\u0435\u0441\u0430","\u0414\u043d\u0456\u043f\u0440\u043e","\u0425\u0435\u0440\u0441\u043e\u043d","\u0417\u0430\u043f\u043e\u0440\u0456\u0436\u0436\u044f","\u041b\u044c\u0432\u0456\u0432","\u041a\u0440\u0438\u0432\u0438\u0439 \u0420\u0456\u0433","\u041c\u0438\u043a\u043e\u043b\u0430\u0457\u0432","\u0417\u0430 \u0440\u043e\u0437\u0442\u0430\u0448\u0443\u0432\u0430\u043d\u043d\u044f\u043c"]),[]),K=(0,a.useMemo)((()=>[...new Set(r.map((e=>e.store_name)))]),[r]),Q=(0,a.useCallback)((e=>{const r=t.find((r=>r.name===e));return r?"".concat(r.price," \u0433\u0440\u043d"):"\u041d/\u0414"}),[t]),X=(0,a.useCallback)((async()=>{let e=[50.4501,30.5234];if(J&&"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044c \u043c\u0456\u0441\u0442\u043e"!==J)if(J in l)e=l[J];else if("\u0417\u0430 \u0440\u043e\u0437\u0442\u0430\u0448\u0443\u0432\u0430\u043d\u043d\u044f\u043c"===J&&navigator.geolocation)try{const r=await new Promise(((e,r)=>{navigator.geolocation.getCurrentPosition(e,r,{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}));e=[r.coords.latitude,r.coords.longitude]}catch(r){}return{coords:e,zoom:12}}),[J,l]),ee=(0,a.useCallback)(((e,r)=>U().divIcon({html:'\n        <div class="flex items-center justify-center px-2 py-1 text-xs font-semibold rounded-full shadow-lg transition-all '.concat(r?"bg-primary-500 text-white scale-110":"bg-white text-gray-900 dark:bg-gray-800 dark:text-white",'">\n          ').concat(e,"\n        </div>\n      "),className:"custom-price-marker",iconSize:[80,28],iconAnchor:[40,14]})),[]),re=(0,a.useCallback)(((e,a,s,n)=>{a.clearLayers(),Object.keys(s).forEach((e=>delete s[e]));(L.length>0?r.filter((e=>L.includes(e.store_name))):r).forEach(((r,i)=>{const o=Q(r.store_name),l="".concat(r.store_name,"_").concat(r.latitude,"_").concat(r.longitude,"_").concat(i),c=U().marker([r.latitude,r.longitude],{icon:ee(o,_===l)});c.on("click",(()=>{S((e=>{const a=e===l?null:l;if(a&&n){const e=t.find((e=>e.name===r.store_name));A((0,M.A)((0,M.A)({},r),{},{price:(null===e||void 0===e?void 0:e.price)||0,link:null===e||void 0===e?void 0:e.link}))}else a||A(null);return a})),e.panTo([r.latitude,r.longitude],{animate:!0,duration:.5})})),s[l]=c,a.addLayer(c)}))}),[r,t,L,_,Q,ee]);(0,a.useEffect)((()=>{if(y.current||!c.current||0===r.length)return;let e=!1;const t=c.current;return(async()=>{const{coords:r,zoom:a}=await X();e||u.current||(t._leaflet_id&&delete t._leaflet_id,u.current=U().map(t,{center:r,zoom:a,scrollWheelZoom:!1,dragging:!0,zoomControl:!1}),U().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(u.current),p.current=U().markerClusterGroup({maxClusterRadius:30,disableClusteringAtZoom:18,iconCreateFunction:e=>U().divIcon({html:'<div class="flex items-center justify-center h-10 w-10 rounded-full bg-primary-500 text-white font-bold text-sm shadow-lg">'.concat(e.getChildCount(),"</div>"),className:"custom-cluster-icon",iconSize:U().point(40,40)})}),u.current.addLayer(p.current),y.current=!0,re(u.current,p.current,b.current,!1),se(u.current))})(),()=>{e=!0}}),[r]),(0,a.useEffect)((()=>()=>{u.current&&(u.current.remove(),u.current=null,p.current=null,y.current=!1)}),[]),(0,a.useEffect)((()=>{u.current&&p.current&&re(u.current,p.current,b.current,!1),m.current&&f.current&&re(m.current,f.current,v.current,!0)}),[L,re]),(0,a.useEffect)((()=>{if(!w||!d.current)return void(!w&&m.current&&(W.current&&(W.current.remove(),W.current=null),m.current.remove(),m.current=null,f.current=null,j.current=!1));if(j.current)return;let e=!1;const r=d.current;return(async()=>{const{coords:t,zoom:a}=await X();e||m.current||(r._leaflet_id&&delete r._leaflet_id,m.current=U().map(r,{center:t,zoom:a,scrollWheelZoom:!0,dragging:!0,zoomControl:!1}),U().control.zoom({position:"bottomright"}).addTo(m.current),U().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(m.current),f.current=U().markerClusterGroup({maxClusterRadius:30,disableClusteringAtZoom:18,iconCreateFunction:e=>U().divIcon({html:'<div class="flex items-center justify-center h-10 w-10 rounded-full bg-primary-500 text-white font-bold text-sm shadow-lg">'.concat(e.getChildCount(),"</div>"),className:"custom-cluster-icon",iconSize:U().point(40,40)})}),m.current.addLayer(f.current),j.current=!0,re(m.current,f.current,v.current,!0),se(m.current),setTimeout((()=>{var e;null===(e=m.current)||void 0===e||e.invalidateSize()}),100))})(),()=>{e=!0}}),[w]);const te=(0,a.useCallback)((async e=>{if(!m.current)return;let r=[50.4501,30.5234];if("\u0417\u0430 \u0440\u043e\u0437\u0442\u0430\u0448\u0443\u0432\u0430\u043d\u043d\u044f\u043c"===e&&navigator.geolocation)try{const e=await new Promise(((e,r)=>{navigator.geolocation.getCurrentPosition(e,r)}));r=[e.coords.latitude,e.coords.longitude]}catch(t){return}else e in l&&(r=l[e]);m.current.flyTo(r,14,{animate:!0,duration:1}),I(!1),P("")}),[l]),ae=(0,a.useMemo)((()=>z?s.filter((e=>e.name_ua.toLowerCase().includes(z.toLowerCase()))):[...s.filter((e=>Y.slice(0,-1).includes(e.name_ua))),{id:-1,name_ua:"\u0417\u0430 \u0440\u043e\u0437\u0442\u0430\u0448\u0443\u0432\u0430\u043d\u043d\u044f\u043c",latitude:0,longitude:0}].slice(0,10)),[s,z,Y]);(0,a.useEffect)((()=>{const e=e=>{q.current&&!q.current.contains(e.target)&&I(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[]);const se=(0,a.useCallback)((e=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition((r=>{const{latitude:t,longitude:a}=r.coords,s=[t,a];W.current&&W.current.remove(),W.current=U().marker(s,{icon:U().divIcon({html:'<div class="relative flex items-center justify-center">\n              <div class="absolute h-8 w-8 animate-ping rounded-full bg-blue-400/30"></div>\n              <div class="h-4 w-4 rounded-full border-2 border-white bg-blue-500 shadow-lg"></div>\n            </div>',className:"user-location-marker",iconSize:[32,32],iconAnchor:[16,16]})}).addTo(e)}),(()=>{}),{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})}),[]),ne=(0,a.useCallback)((()=>{if(!navigator.geolocation)return;const e=m.current||u.current;e&&(V(!0),navigator.geolocation.getCurrentPosition((r=>{const{latitude:t,longitude:a}=r.coords,s=[t,a];W.current&&W.current.remove(),W.current=U().marker(s,{icon:U().divIcon({html:'<div class="relative flex items-center justify-center">\n              <div class="absolute h-8 w-8 animate-ping rounded-full bg-blue-400/30"></div>\n              <div class="h-4 w-4 rounded-full border-2 border-white bg-blue-500 shadow-lg"></div>\n            </div>',className:"user-location-marker",iconSize:[32,32],iconAnchor:[16,16]})}).addTo(e),e.flyTo(s,15,{animate:!0,duration:1}),V(!1)}),(()=>{V(!1)}),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}))}),[]);return(0,a.useEffect)((()=>{const e=e=>{"Escape"===e.key&&(N(!1),A(null),S(null))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[]),0===r.length?(0,g.jsxs)("div",{className:"rounded-2xl bg-surface-light p-8 text-center dark:bg-card-dark",children:[(0,g.jsx)(o.A,{className:"mx-auto mb-3 h-12 w-12 text-foreground/40"}),(0,g.jsx)("p",{className:"text-foreground/50 dark:text-foreground/40",children:"\u041b\u043e\u043a\u0430\u0446\u0456\u0457 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0456\u0432 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0456"})]}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{onClick:()=>N(!0),className:"group relative z-0 cursor-pointer overflow-hidden rounded-2xl",children:[(0,g.jsx)("div",{ref:c,className:"h-48 w-full"}),(0,g.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/0 transition-colors group-hover:bg-surface-dark/20",children:(0,g.jsx)("div",{className:"rounded-full bg-card-light/90 p-3 opacity-0 shadow-lg transition-opacity group-hover:opacity-100 dark:bg-card-dark/90",children:(0,g.jsx)(F.A,{className:"h-5 w-5 text-foreground/70"})})}),(0,g.jsxs)("div",{className:"absolute bottom-2 left-2 rounded-full bg-card-light/90 px-3 py-1 text-xs font-medium shadow dark:bg-card-dark/90",children:[(0,g.jsx)(o.A,{className:"mr-1 inline h-3 w-3"}),r.length," \u043b\u043e\u043a\u0430\u0446\u0456\u0439"]})]}),(0,H.createPortal)((0,g.jsx)(i.N,{children:w&&(0,g.jsxs)(n.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[9999] bg-black/90",children:[(0,g.jsx)("div",{ref:d,className:"h-full w-full"}),(0,g.jsx)("button",{onClick:()=>{N(!1),A(null),S(null)},className:"absolute right-4 top-4 z-[1000] rounded-full bg-card-light p-3 shadow-lg transition-colors hover:bg-primary-50 dark:bg-card-dark dark:hover:bg-primary-900/20",children:(0,g.jsx)(x.A,{className:"h-5 w-5"})}),(0,g.jsx)("button",{onClick:ne,disabled:Z,className:(0,h.cn)("absolute right-4 top-16 z-[1000] rounded-full p-3 shadow-lg transition-colors",Z?"bg-primary-500 text-white":"bg-card-light hover:bg-primary-50 dark:bg-card-dark dark:hover:bg-primary-900/20"),title:"\u041c\u043e\u0454 \u043c\u0456\u0441\u0446\u0435\u0437\u043d\u0430\u0445\u043e\u0434\u0436\u0435\u043d\u043d\u044f",children:(0,g.jsx)(B.A,{className:(0,h.cn)("h-5 w-5",Z&&"animate-pulse")})}),(0,g.jsxs)("div",{className:"absolute left-4 top-4 z-[1000] w-64",children:[(0,g.jsxs)("div",{className:"relative",children:[(0,g.jsx)($.A,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-foreground/40"}),(0,g.jsx)("input",{type:"text",placeholder:"\u041f\u043e\u0448\u0443\u043a \u043c\u0456\u0441\u0442\u0430...",value:z,onChange:e=>{P(e.target.value),I(!0)},onFocus:()=>I(!0),className:"w-full rounded-lg bg-card-light py-2 pl-10 pr-4 shadow-lg dark:bg-card-dark"})]}),(0,g.jsx)(i.N,{children:E&&(0,g.jsx)(n.P.div,{ref:q,initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute mt-2 max-h-64 w-full overflow-y-auto rounded-lg bg-card-light shadow-lg dark:bg-card-dark",children:ae.map((e=>(0,g.jsxs)("button",{onClick:()=>te(e.name_ua),className:"flex w-full items-center gap-2 px-4 py-2 text-left text-sm hover:bg-primary-50 dark:hover:bg-primary-900/20",children:["\u0417\u0430 \u0440\u043e\u0437\u0442\u0430\u0448\u0443\u0432\u0430\u043d\u043d\u044f\u043c"===e.name_ua?(0,g.jsx)(o.A,{className:"h-4 w-4 text-primary-500"}):(0,g.jsx)(o.A,{className:"h-4 w-4 text-foreground/40"}),e.name_ua]},e.id)))})})]}),(0,g.jsxs)("button",{onClick:()=>D(!T),className:(0,h.cn)("absolute left-4 top-16 z-[1000] mt-2 flex items-center gap-2 rounded-lg px-4 py-2 shadow-lg transition-colors",T?"bg-primary-500 text-white":"bg-card-light hover:bg-primary-50 dark:bg-card-dark dark:hover:bg-primary-900/20"),children:[(0,g.jsx)(O.A,{className:"h-4 w-4"}),"\u0424\u0456\u043b\u044c\u0442\u0440\u0438",L.length>0&&(0,g.jsx)("span",{className:"rounded-full bg-white/20 px-2 py-0.5 text-xs",children:L.length})]}),(0,g.jsx)(i.N,{children:T&&(0,g.jsxs)(n.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"absolute bottom-4 left-4 top-32 z-[1000] w-64 overflow-y-auto rounded-lg bg-card-light p-4 shadow-lg dark:bg-card-dark",children:[(0,g.jsx)("h3",{className:"mb-3 font-semibold text-foreground dark:text-white",children:"\u041c\u0430\u0433\u0430\u0437\u0438\u043d\u0438"}),(0,g.jsx)("div",{className:"space-y-2",children:K.map((e=>(0,g.jsxs)("label",{className:"flex cursor-pointer items-center gap-2",children:[(0,g.jsx)("input",{type:"checkbox",checked:L.includes(e),onChange:()=>(e=>{R((r=>r.includes(e)?r.filter((r=>r!==e)):[...r,e]))})(e),className:"h-4 w-4 rounded border-border text-primary-500 focus:ring-primary-500"}),(0,g.jsx)("span",{className:"text-sm text-foreground/70 dark:text-foreground/60",children:e})]},e)))}),L.length>0&&(0,g.jsx)(C.$,{variant:"ghost",size:"sm",className:"mt-4 w-full",onClick:()=>R([]),children:"\u0421\u043a\u0438\u043d\u0443\u0442\u0438 \u0444\u0456\u043b\u044c\u0442\u0440\u0438"})]})}),(0,g.jsx)(i.N,{children:k&&(0,g.jsxs)(n.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"absolute bottom-4 right-4 z-[1000] w-80 rounded-lg bg-card-light p-4 shadow-lg dark:bg-card-dark",children:[(0,g.jsx)("button",{onClick:()=>{A(null),S(null)},className:"absolute right-2 top-2 rounded-full p-1 hover:bg-primary-50 dark:hover:bg-primary-900/20",children:(0,g.jsx)(x.A,{className:"h-4 w-4"})}),(0,g.jsx)("h3",{className:"mb-2 font-semibold text-foreground dark:text-white",children:k.store_name}),k.address&&(0,g.jsxs)("p",{className:"mb-2 text-sm text-foreground/50 dark:text-foreground/40",children:[(0,g.jsx)(o.A,{className:"mr-1 inline h-4 w-4"}),k.address]}),(k.hours_mon_fri||k.hours_sat||k.hours_sun)&&(0,g.jsxs)("div",{className:"mb-3 space-y-1 text-xs text-foreground/50 dark:text-foreground/40",children:[k.hours_mon_fri&&(0,g.jsxs)("p",{children:["\u041f\u043d-\u041f\u0442: ",k.hours_mon_fri]}),k.hours_sat&&(0,g.jsxs)("p",{children:["\u0421\u0431: ",k.hours_sat]}),k.hours_sun&&(0,g.jsxs)("p",{children:["\u041d\u0434: ",k.hours_sun]})]}),(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("span",{className:"text-xl font-bold text-success-500",children:[k.price," \u0433\u0440\u043d"]}),(0,g.jsx)(C.$,{size:"sm",onClick:()=>k.link&&window.open(k.link,"_blank"),children:"\u041a\u0443\u043f\u0438\u0442\u0438"})]})]})})]})}),document.body)]})}delete U().Icon.Default.prototype._getIconUrl,U().Icon.Default.mergeOptions({iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png"});var V=t(4049),W=t(2233);function q(){const{productId:e}=(0,s.g)(),r=(0,s.Zp)(),[t,d]=(0,a.useState)(!1),{data:u,isLoading:m,error:x,isSaved:h,toggleSave:f,deleteProduct:b,cityCoordinates:v,getMinPrice:y,images:j,featureList:w}=function(e){const[r,t]=(0,a.useState)({product:null,storeLocations:[],cities:[]}),[s,n]=(0,a.useState)(!0),[i,o]=(0,a.useState)(null),[d,u]=(0,a.useState)(!1),m=localStorage.getItem("token"),x=(0,a.useCallback)((async()=>{if(e){n(!0),o(null);try{const[r,a,s]=await Promise.all([l.A.get("".concat(c.H,"/products/").concat(e)),l.A.get("".concat(c.H,"/cities")),l.A.get("".concat(c.H,"/store-locations"),{params:{productId:e}})]);t({product:r.data,cities:a.data,storeLocations:s.data})}catch(r){console.error("Error fetching product data:",r),o("\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u0437\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0435\u043d\u043d\u044f \u0434\u0430\u043d\u0438\u0445. \u041f\u0435\u0440\u0435\u0432\u0456\u0440\u0442\u0435 \u043f\u0456\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044f.")}finally{n(!1)}}}),[e]);(0,a.useEffect)((()=>{x()}),[x]);const h=(0,a.useCallback)((async()=>{if(m&&e)try{const r=await l.A.get("".concat(c.H,"/saved-products/").concat(e),{headers:{Authorization:"Bearer ".concat(m)}});u(r.data.isSaved)}catch(r){console.error("Error checking saved status:",r)}else u(!1)}),[e,m]);(0,a.useEffect)((()=>{s||i||!r.product||h()}),[h,s,i,r.product]);const g=(0,a.useCallback)((async()=>{if(m&&e)try{d?(await l.A.delete("".concat(c.H,"/saved-products/").concat(e),{headers:{Authorization:"Bearer ".concat(m)}}),u(!1)):(await l.A.post("".concat(c.H,"/saved-products"),{productId:e},{headers:{Authorization:"Bearer ".concat(m)}}),u(!0))}catch(r){throw console.error("Error toggling save:",r),new Error("\u041d\u0435 \u0432\u0434\u0430\u043b\u043e\u0441\u044f \u0437\u043c\u0456\u043d\u0438\u0442\u0438 \u0441\u0442\u0430\u0442\u0443\u0441 \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043d\u044f \u0442\u043e\u0432\u0430\u0440\u0443.")}}),[e,m,d]),p=(0,a.useCallback)((async()=>{if(m&&e)try{await l.A.delete("".concat(c.H,"/admin/product/").concat(e),{headers:{Authorization:"Bearer ".concat(m)}})}catch(r){throw console.error("Error deleting product:",r),new Error("\u041d\u0435 \u0432\u0434\u0430\u043b\u043e\u0441\u044f \u0432\u0438\u0434\u0430\u043b\u0438\u0442\u0438 \u0442\u043e\u0432\u0430\u0440.")}}),[e,m]),f=(0,a.useMemo)((()=>{const e={};return r.cities.forEach((r=>{r.latitude&&r.longitude&&(e[r.name_ua]=[r.latitude,r.longitude])})),e}),[r.cities]),b=(0,a.useCallback)((()=>{var e;if(null===(e=r.product)||void 0===e||!e.store_prices||0===r.product.store_prices.length)return"\u041d/\u0414";const t=Math.min(...r.product.store_prices.map((e=>e.price)));return"".concat(t," \u0433\u0440\u043d")}),[r.product]),v=(0,a.useMemo)((()=>{var e;return null!==(e=r.product)&&void 0!==e&&e.images&&r.product.images.length>0?r.product.images:["/img/placeholder.webp"]}),[r.product]),y=(0,a.useMemo)((()=>{var e;if(null===(e=r.product)||void 0===e||!e.features)return[];const t=r.product.features;return[{key:"\u0411\u0440\u0435\u043d\u0434",value:t.brand},{key:"\u041a\u0440\u0430\u0457\u043d\u0430 \u0432\u0438\u0440\u043e\u0431\u043d\u0438\u0446\u0442\u0432\u0430",value:t.country},{key:"\u0412\u0438\u0434",value:t.type},{key:"\u041a\u043b\u0430\u0441",value:t.class},{key:"\u0413\u0440\u0443\u043f\u0430 \u0442\u043e\u0432\u0430\u0440\u0443",value:t.category},{key:"\u041f\u0440\u0438\u0437\u043d\u0430\u0447\u0435\u043d\u043d\u044f",value:t.purpose},{key:"\u0421\u0442\u0430\u0442\u044c",value:t.gender},{key:"\u0410\u043a\u0442\u0438\u0432\u043d\u0438\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442",value:t.active_ingredients}].filter((e=>Boolean(e.value)))}),[r.product]);return{data:r,isLoading:s,error:i,isSaved:d,setIsSaved:u,toggleSave:g,deleteProduct:p,cityCoordinates:f,getMinPrice:b,images:v,featureList:y}}(e),N=(0,a.useRef)(null),k=JSON.parse(localStorage.getItem("user")||"null"),A=null===k||void 0===k?void 0:k.is_admin;if(m)return(0,g.jsx)(W.Y,{});if(x||!u.product)return(0,g.jsx)("div",{className:"container-main py-16",children:(0,g.jsxs)("div",{className:"mx-auto max-w-md text-center",children:[(0,g.jsx)("div",{className:"mb-4 text-6xl",children:"\ud83d\ude15"}),(0,g.jsx)("h1",{className:"mb-2 font-serif text-2xl font-bold text-foreground",children:x||"\u0422\u043e\u0432\u0430\u0440 \u043d\u0435 \u0437\u043d\u0430\u0439\u0434\u0435\u043d\u043e"}),(0,g.jsx)("p",{className:"mb-6 text-foreground/50",children:"\u041f\u0435\u0440\u0435\u0432\u0456\u0440\u0442\u0435 \u043f\u0456\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044f \u0434\u043e \u0456\u043d\u0442\u0435\u0440\u043d\u0435\u0442\u0443 \u0430\u0431\u043e \u0441\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u0456\u0437\u043d\u0456\u0448\u0435"}),(0,g.jsx)(C.$,{onClick:()=>r(-1),children:"\u041f\u043e\u0432\u0435\u0440\u043d\u0443\u0442\u0438\u0441\u044c \u043d\u0430\u0437\u0430\u0434"})]})});const{product:S,storeLocations:P,cities:E}=u,L=[...S.category_name?[{label:S.category_name,href:"/subcategories/".concat(S.category_id)}]:[],...S.brand_name?[{label:S.brand_name,href:"/search?query=".concat(encodeURIComponent(S.brand_name))}]:[],{label:S.name}];return(0,g.jsxs)("div",{className:"min-h-screen bg-surface-light dark:bg-surface-dark",children:[(0,g.jsx)("div",{className:"border-b border-border bg-card-light dark:bg-card-dark",children:(0,g.jsx)("div",{className:"container-main py-3",children:(0,g.jsx)(V.B,{items:L})})}),(0,g.jsxs)("div",{className:"container-main py-8",children:[(0,g.jsxs)("div",{className:"mb-8 grid gap-8 lg:grid-cols-2",children:[(0,g.jsx)(n.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4},children:(0,g.jsx)(p,{images:j,productName:S.name})}),(0,g.jsxs)(n.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.1},className:"flex flex-col gap-6",children:[(0,g.jsx)(_,{product:S,minPrice:y(),isSaved:h,onToggleSave:f,onDelete:()=>d(!0),onScrollToPrices:()=>{var e;null===(e=N.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},isAdmin:A}),(0,g.jsxs)("div",{className:"rounded-2xl bg-card-light p-4 shadow-soft dark:bg-card-dark",children:[(0,g.jsxs)("div",{className:"mb-3 flex items-center gap-2 text-sm font-medium text-foreground/70",children:[(0,g.jsx)(o.A,{className:"h-4 w-4 text-primary-500"}),"\u0414\u0435 \u043a\u0443\u043f\u0438\u0442\u0438"]}),(0,g.jsx)(Z,{storeLocations:P,storePrices:S.store_prices,cities:E,cityCoordinates:v})]})]})]}),(0,g.jsx)("div",{ref:N,className:"mb-8 scroll-mt-20",children:(0,g.jsx)(T,{storePrices:S.store_prices})}),(0,g.jsxs)("div",{className:"space-y-8",children:[(0,g.jsx)(z,{features:w}),(0,g.jsx)(I,{description:S.description_full})]})]}),(0,g.jsx)(i.N,{children:t&&(0,g.jsx)(n.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:()=>d(!1),children:(0,g.jsxs)(n.P.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:e=>e.stopPropagation(),className:"w-full max-w-md rounded-2xl bg-card-light p-6 shadow-xl dark:bg-card-dark",children:[(0,g.jsx)("h3",{className:"mb-2 text-lg font-bold text-foreground",children:"\u0412\u0438\u0434\u0430\u043b\u0438\u0442\u0438 \u0442\u043e\u0432\u0430\u0440?"}),(0,g.jsx)("p",{className:"mb-6 text-foreground/50",children:"\u0412\u0438 \u0432\u043f\u0435\u0432\u043d\u0435\u043d\u0456, \u0449\u043e \u0445\u043e\u0447\u0435\u0442\u0435 \u0432\u0438\u0434\u0430\u043b\u0438\u0442\u0438 \u0446\u0435\u0439 \u0442\u043e\u0432\u0430\u0440? \u0426\u044e \u0434\u0456\u044e \u043d\u0435\u043c\u043e\u0436\u043b\u0438\u0432\u043e \u0441\u043a\u0430\u0441\u0443\u0432\u0430\u0442\u0438."}),(0,g.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,g.jsx)(C.$,{variant:"ghost",onClick:()=>d(!1),children:"\u0421\u043a\u0430\u0441\u0443\u0432\u0430\u0442\u0438"}),(0,g.jsx)(C.$,{variant:"danger",onClick:async()=>{try{await b(),r("/search")}catch(e){console.error("Delete error:",e)}d(!1)},children:"\u0412\u0438\u0434\u0430\u043b\u0438\u0442\u0438"})]})]})})})]})}}}]);
//# sourceMappingURL=653.e898a564.chunk.js.map