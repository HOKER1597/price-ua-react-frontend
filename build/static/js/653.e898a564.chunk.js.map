{"version":3,"file":"static/js/653.e898a564.chunk.js","mappings":"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","sources":["components/ui/Button.tsx","components/common/Breadcrumbs.tsx","components/features/product/ProductGallery.tsx","components/features/product/ProductInfo.tsx","components/features/product/ProductFeatures.tsx","components/features/product/ProductDescription.tsx","components/features/product/ProductPrices.tsx","components/features/product/ProductMap.tsx","pages/ProductDetailPage.tsx","hooks/useProductDetail.ts"],"sourcesContent":["import React, { forwardRef, ButtonHTMLAttributes } from 'react';\nimport { cva, type VariantProps } from 'class-variance-authority';\nimport { cn } from '../../utils/cn';\nimport { Loader2 } from 'lucide-react';\n\nconst buttonVariants = cva(\n  'inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-medium transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 active:scale-[0.98]',\n  {\n    variants: {\n      variant: {\n        primary: 'bg-primary-500 text-white shadow-md hover:bg-primary-600 hover:shadow-lg focus-visible:ring-primary-500',\n        secondary: 'bg-primary-100 text-primary-700 shadow-sm hover:bg-primary-200 hover:shadow-md focus-visible:ring-primary-500 dark:bg-primary-900/30 dark:text-primary-300 dark:hover:bg-primary-900/50',\n        accent: 'bg-primary-500 text-white shadow-md hover:bg-primary-600 hover:shadow-lg focus-visible:ring-primary-500',\n        outline: 'border-2 border-primary-500 text-primary-500 hover:bg-primary-50 dark:hover:bg-primary-900/20 focus-visible:ring-primary-500',\n        ghost: 'text-foreground/70 hover:bg-primary-50 dark:hover:bg-card-dark focus-visible:ring-primary-500',\n        link: 'text-primary-500 underline-offset-4 hover:underline focus-visible:ring-primary-500',\n        danger: 'bg-error-500 text-white shadow-md hover:bg-error-600 hover:shadow-lg focus-visible:ring-error-500',\n        success: 'bg-success-500 text-white shadow-md hover:bg-success-600 hover:shadow-lg focus-visible:ring-success-500',\n      },\n      size: {\n        xs: 'h-7 px-2 text-xs rounded-md',\n        sm: 'h-8 px-3 text-xs',\n        md: 'h-10 px-4',\n        lg: 'h-12 px-6 text-base',\n        xl: 'h-14 px-8 text-lg',\n        icon: 'h-10 w-10',\n        'icon-sm': 'h-8 w-8',\n        'icon-lg': 'h-12 w-12',\n      },\n    },\n    defaultVariants: {\n      variant: 'primary',\n      size: 'md',\n    },\n  }\n);\n\nexport interface ButtonProps\n  extends ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  isLoading?: boolean;\n  leftIcon?: React.ReactNode;\n  rightIcon?: React.ReactNode;\n}\n\nconst Button = forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, isLoading, leftIcon, rightIcon, children, disabled, ...props }, ref) => {\n    return (\n      <button\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        disabled={disabled || isLoading}\n        {...props}\n      >\n        {isLoading ? (\n          <Loader2 className=\"h-4 w-4 animate-spin\" />\n        ) : leftIcon ? (\n          leftIcon\n        ) : null}\n        {children}\n        {!isLoading && rightIcon}\n      </button>\n    );\n  }\n);\n\nButton.displayName = 'Button';\n\nexport { Button, buttonVariants };\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { ChevronRight, Home } from 'lucide-react';\nimport { cn } from '../../utils/cn';\n\ninterface BreadcrumbItem {\n  label: string;\n  href?: string;\n}\n\ninterface BreadcrumbsProps {\n  items: BreadcrumbItem[];\n  className?: string;\n}\n\nexport function Breadcrumbs({ items, className }: BreadcrumbsProps) {\n  return (\n    <nav className={cn('flex items-center gap-1.5 text-sm', className)} aria-label=\"Breadcrumb\">\n      <Link\n        to=\"/\"\n        className=\"flex items-center text-foreground/40 transition-colors hover:text-primary-500\"\n      >\n        <Home className=\"h-4 w-4\" />\n      </Link>\n\n      {items.map((item, index) => (\n        <React.Fragment key={index}>\n          <ChevronRight className=\"h-3.5 w-3.5 text-foreground/30\" />\n          {item.href ? (\n            <Link\n              to={item.href}\n              className=\"text-foreground/50 transition-colors hover:text-primary-500\"\n            >\n              {item.label}\n            </Link>\n          ) : (\n            <span className=\"text-foreground/70 font-medium\">{item.label}</span>\n          )}\n        </React.Fragment>\n      ))}\n    </nav>\n  );\n}\n","import React, { useState, useCallback, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { ChevronLeft, ChevronRight, X, ZoomIn } from 'lucide-react';\nimport { cn } from '../../../utils/cn';\n\ninterface ProductGalleryProps {\n  images: string[];\n  productName: string;\n}\n\nexport function ProductGallery({ images, productName }: ProductGalleryProps) {\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [isFullScreen, setIsFullScreen] = useState(false);\n  const [direction, setDirection] = useState<'left' | 'right' | null>(null);\n\n  const handlePrev = useCallback(\n    (e?: React.MouseEvent) => {\n      e?.stopPropagation();\n      setDirection('left');\n      setCurrentIndex((prev) => (prev === 0 ? images.length - 1 : prev - 1));\n    },\n    [images.length]\n  );\n\n  const handleNext = useCallback(\n    (e?: React.MouseEvent) => {\n      e?.stopPropagation();\n      setDirection('right');\n      setCurrentIndex((prev) => (prev === images.length - 1 ? 0 : prev + 1));\n    },\n    [images.length]\n  );\n\n  const handleThumbnailClick = (index: number) => {\n    if (index !== currentIndex) {\n      setDirection(index > currentIndex ? 'right' : 'left');\n      setCurrentIndex(index);\n    }\n  };\n\n  // Keyboard navigation\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (!isFullScreen) return;\n      if (e.key === 'ArrowLeft') handlePrev();\n      else if (e.key === 'ArrowRight') handleNext();\n      else if (e.key === 'Escape') setIsFullScreen(false);\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [isFullScreen, handlePrev, handleNext]);\n\n  // Prevent body scroll when fullscreen is open\n  useEffect(() => {\n    if (isFullScreen) {\n      document.body.style.overflow = 'hidden';\n    } else {\n      document.body.style.overflow = '';\n    }\n    return () => {\n      document.body.style.overflow = '';\n    };\n  }, [isFullScreen]);\n\n  const slideVariants = {\n    enter: (dir: 'left' | 'right' | null) => ({\n      x: dir === 'right' ? 300 : dir === 'left' ? -300 : 0,\n      opacity: 0,\n    }),\n    center: {\n      x: 0,\n      opacity: 1,\n    },\n    exit: (dir: 'left' | 'right' | null) => ({\n      x: dir === 'right' ? -300 : dir === 'left' ? 300 : 0,\n      opacity: 0,\n    }),\n  };\n\n  return (\n    <>\n      <div className=\"flex flex-col gap-3\">\n        {/* Main Image */}\n        <div\n          onClick={() => setIsFullScreen(true)}\n          className=\"group relative aspect-square w-full cursor-zoom-in overflow-hidden rounded-2xl bg-surface-light dark:bg-card-dark\"\n        >\n          <AnimatePresence mode=\"wait\" custom={direction}>\n            <motion.img\n              key={currentIndex}\n              src={images[currentIndex]}\n              alt={`${productName} ${currentIndex + 1}`}\n              custom={direction}\n              variants={slideVariants}\n              initial=\"enter\"\n              animate=\"center\"\n              exit=\"exit\"\n              transition={{ duration: 0.3, ease: 'easeInOut' }}\n              className=\"h-full w-full object-contain\"\n              onError={(e) => {\n                (e.target as HTMLImageElement).src = '/img/placeholder.webp';\n              }}\n            />\n          </AnimatePresence>\n\n          {/* Zoom indicator */}\n          <div className=\"absolute bottom-4 right-4 rounded-full bg-surface-dark/50 p-2 opacity-0 transition-opacity group-hover:opacity-100\">\n            <ZoomIn className=\"h-5 w-5 text-white\" />\n          </div>\n\n          {/* Navigation arrows */}\n          {images.length > 1 && (\n            <>\n              <button\n                onClick={handlePrev}\n                className=\"absolute left-2 top-1/2 -translate-y-1/2 rounded-full bg-card-light/80 p-2 shadow-lg opacity-0 transition-all hover:bg-card-light group-hover:opacity-100 dark:bg-card-dark/80 dark:hover:bg-card-dark\"\n              >\n                <ChevronLeft className=\"h-5 w-5 text-foreground/70\" />\n              </button>\n              <button\n                onClick={handleNext}\n                className=\"absolute right-2 top-1/2 -translate-y-1/2 rounded-full bg-card-light/80 p-2 shadow-lg opacity-0 transition-all hover:bg-card-light group-hover:opacity-100 dark:bg-card-dark/80 dark:hover:bg-card-dark\"\n              >\n                <ChevronRight className=\"h-5 w-5 text-foreground/70\" />\n              </button>\n            </>\n          )}\n        </div>\n\n        {/* Thumbnails below */}\n        {images.length > 1 && (\n          <div className=\"flex gap-2 overflow-x-auto pb-1\">\n            {images.slice(0, 5).map((img, index) => (\n              <button\n                key={index}\n                onClick={() => handleThumbnailClick(index)}\n                className={cn(\n                  'relative h-16 w-16 flex-shrink-0 overflow-hidden rounded-lg border-2 transition-all',\n                  index === currentIndex\n                    ? 'border-primary-500 ring-2 ring-primary-500/30'\n                    : 'border-border hover:border-primary-300'\n                )}\n              >\n                <img\n                  src={img}\n                  alt={`${productName} ${index + 1}`}\n                  className=\"h-full w-full object-cover\"\n                  onError={(e) => {\n                    (e.target as HTMLImageElement).src = '/img/placeholder.webp';\n                  }}\n                />\n              </button>\n            ))}\n            {images.length > 5 && (\n              <button\n                onClick={() => handleThumbnailClick(5)}\n                className=\"relative h-16 w-16 flex-shrink-0 overflow-hidden rounded-lg border-2 border-border transition-all hover:border-primary-300\"\n              >\n                <img\n                  src={images[5]}\n                  alt={`${productName} more`}\n                  className=\"h-full w-full object-cover opacity-50\"\n                  onError={(e) => {\n                    (e.target as HTMLImageElement).src = '/img/placeholder.webp';\n                  }}\n                />\n                <div className=\"absolute inset-0 flex items-center justify-center bg-black/40 text-sm font-bold text-white\">\n                  +{images.length - 5}\n                </div>\n              </button>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Fullscreen Modal */}\n      <AnimatePresence>\n        {isFullScreen && (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/90\"\n            onClick={() => setIsFullScreen(false)}\n          >\n            <button\n              onClick={() => setIsFullScreen(false)}\n              className=\"absolute right-4 top-4 z-10 rounded-full bg-white/10 p-3 text-white transition-colors hover:bg-white/20\"\n            >\n              <X className=\"h-6 w-6\" />\n            </button>\n\n            <AnimatePresence mode=\"wait\" custom={direction}>\n              <motion.img\n                key={currentIndex}\n                src={images[currentIndex]}\n                alt={`${productName} ${currentIndex + 1}`}\n                custom={direction}\n                variants={slideVariants}\n                initial=\"enter\"\n                animate=\"center\"\n                exit=\"exit\"\n                transition={{ duration: 0.3, ease: 'easeInOut' }}\n                className=\"max-h-[90vh] max-w-[90vw] object-contain\"\n                onClick={(e) => e.stopPropagation()}\n                onError={(e) => {\n                  (e.target as HTMLImageElement).src = '/img/placeholder.webp';\n                }}\n              />\n            </AnimatePresence>\n\n            {images.length > 1 && (\n              <>\n                <button\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    handlePrev();\n                  }}\n                  className=\"absolute left-4 top-1/2 -translate-y-1/2 rounded-full bg-white/10 p-4 text-white transition-colors hover:bg-white/20\"\n                >\n                  <ChevronLeft className=\"h-8 w-8\" />\n                </button>\n                <button\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    handleNext();\n                  }}\n                  className=\"absolute right-4 top-1/2 -translate-y-1/2 rounded-full bg-white/10 p-4 text-white transition-colors hover:bg-white/20\"\n                >\n                  <ChevronRight className=\"h-8 w-8\" />\n                </button>\n              </>\n            )}\n\n            {/* Image counter */}\n            <div className=\"absolute bottom-4 left-1/2 -translate-x-1/2 rounded-full bg-surface-dark/50 px-4 py-2 text-sm text-white\">\n              {currentIndex + 1} / {images.length}\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </>\n  );\n}\n","import React, { useState } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { Heart, Star, Eye, Edit2, Trash2, Share2, ArrowDown, ExternalLink, CheckCircle } from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { Button } from '../../ui/Button';\nimport { cn } from '../../../utils/cn';\nimport type { Product } from '../../../types';\n\ninterface ProductInfoProps {\n  product: Product;\n  minPrice: string;\n  isSaved: boolean;\n  onToggleSave: () => Promise<void>;\n  onDelete?: () => void;\n  onScrollToPrices: () => void;\n  isAdmin?: boolean;\n}\n\nexport function ProductInfo({\n  product,\n  minPrice,\n  isSaved,\n  onToggleSave,\n  onDelete,\n  onScrollToPrices,\n  isAdmin,\n}: ProductInfoProps) {\n  const navigate = useNavigate();\n  const [showLoginPrompt, setShowLoginPrompt] = useState(false);\n  const [isToggling, setIsToggling] = useState(false);\n\n  const token = localStorage.getItem('token');\n\n  const handleSaveToggle = async (e: React.MouseEvent) => {\n    e.preventDefault();\n\n    if (!token) {\n      setShowLoginPrompt(true);\n      setTimeout(() => setShowLoginPrompt(false), 3000);\n      return;\n    }\n\n    setIsToggling(true);\n    try {\n      await onToggleSave();\n    } catch (err) {\n      console.error('Save toggle error:', err);\n    } finally {\n      setIsToggling(false);\n    }\n  };\n\n  const handleEdit = () => {\n    navigate(`/admin/product-edit?productId=${product.id}`);\n  };\n\n  const handleShare = async () => {\n    try {\n      await navigator.clipboard.writeText(window.location.href);\n    } catch {\n      // fallback - ignore\n    }\n  };\n\n  const rating = Number(product.rating) || 0;\n  const reviewCount = Number(product.review_count) || 0;\n  const storeCount = product.store_prices?.length || 0;\n\n  // Find best price info\n  const sortedPrices = product.store_prices\n    ? [...product.store_prices].sort((a, b) => a.price - b.price)\n    : [];\n  const bestStore = sortedPrices[0];\n  const worstPrice = sortedPrices.length > 1 ? sortedPrices[sortedPrices.length - 1]?.price : 0;\n  const savingsPercent = bestStore && worstPrice > 0\n    ? Math.round(((worstPrice - bestStore.price) / worstPrice) * 100)\n    : 0;\n\n  const renderStars = (r: number) => {\n    const stars = [];\n    const fullStars = Math.floor(r);\n    const hasHalfStar = r % 1 >= 0.5;\n\n    for (let i = 0; i < 5; i++) {\n      if (i < fullStars) {\n        stars.push(\n          <Star key={i} className=\"h-4 w-4 fill-amber-400 text-amber-400\" />\n        );\n      } else if (i === fullStars && hasHalfStar) {\n        stars.push(\n          <Star key={i} className=\"h-4 w-4 fill-amber-400/50 text-amber-400\" />\n        );\n      } else {\n        stars.push(\n          <Star key={i} className=\"h-4 w-4 text-border\" />\n        );\n      }\n    }\n    return stars;\n  };\n\n  return (\n    <div className=\"flex flex-col gap-4\">\n      {/* Admin actions */}\n      {isAdmin && (\n        <div className=\"flex gap-2\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={handleEdit}\n            leftIcon={<Edit2 className=\"h-4 w-4\" />}\n          >\n            \n          </Button>\n          <Button\n            variant=\"danger\"\n            size=\"sm\"\n            onClick={onDelete}\n            leftIcon={<Trash2 className=\"h-4 w-4\" />}\n          >\n            \n          </Button>\n        </div>\n      )}\n\n      {/* Brand */}\n      {product.brand_name && (\n        <Link\n          to={`/search?query=${encodeURIComponent(product.brand_name)}`}\n          className=\"text-sm font-semibold text-primary-500 hover:text-primary-600\"\n        >\n          {product.brand_name}\n        </Link>\n      )}\n\n      {/* Product name */}\n      <h1 className=\"font-serif text-2xl font-bold text-foreground lg:text-3xl\">\n        {product.name}\n      </h1>\n\n      {/* Meta info: rating + views + share */}\n      <div className=\"flex flex-wrap items-center gap-4 text-sm text-foreground/50\">\n        {rating > 0 && (\n          <div className=\"flex items-center gap-1\">\n            {renderStars(rating)}\n            <span className=\"ml-1 font-medium text-foreground/70\">{rating.toFixed(1)}</span>\n            {reviewCount > 0 && <span>({reviewCount} )</span>}\n          </div>\n        )}\n        <div className=\"flex items-center gap-1\">\n          <Eye className=\"h-4 w-4\" />\n          <span>{product.views || 0} </span>\n        </div>\n        <button\n          onClick={handleShare}\n          className=\"flex items-center gap-1 text-foreground/40 transition-colors hover:text-primary-500\"\n        >\n          <Share2 className=\"h-4 w-4\" />\n          <span></span>\n        </button>\n      </div>\n\n      {/* Availability badge */}\n      {storeCount > 0 && (\n        <div className=\"flex items-center gap-1.5 text-sm text-success-600\">\n          <CheckCircle className=\"h-4 w-4\" />\n          <span className=\"font-medium\">  </span>\n          <span className=\"text-foreground/40\">\n             {storeCount} {storeCount === 1 ? '' : storeCount < 5 ? '' : ''}\n          </span>\n        </div>\n      )}\n\n      {/* Volume + Code */}\n      <div className=\"flex flex-wrap items-center gap-3\">\n        {product.volume && (\n          <span className=\"rounded-full bg-badge px-3 py-1 text-xs text-foreground/60 dark:bg-card-dark\">\n            {product.volume}\n          </span>\n        )}\n        {product.code && (\n          <span className=\"rounded-full bg-badge px-3 py-1 text-xs text-foreground/40 dark:bg-card-dark\">\n            : {product.code}\n          </span>\n        )}\n      </div>\n\n      {/* Best Price Block */}\n      {bestStore && (\n        <div className=\"rounded-xl bg-gradient-to-r from-success-50 to-success-100 p-5 dark:from-success-900/20 dark:to-success-900/10\">\n          <div className=\"mb-1 text-sm text-foreground/50\"> </div>\n          <div className=\"mb-1 flex items-baseline gap-3\">\n            <span className=\"text-3xl font-bold text-success-600\">\n              {bestStore.price} \n            </span>\n            {savingsPercent > 0 && (\n              <span className=\"flex items-center gap-0.5 rounded-full bg-success-500 px-2 py-0.5 text-xs font-medium text-white\">\n                <ArrowDown className=\"h-3 w-3\" />\n                 {savingsPercent}% \n              </span>\n            )}\n          </div>\n          <div className=\"mb-3 text-sm text-foreground/50\">\n              <span className=\"font-medium text-foreground/70\">{bestStore.name}</span>\n          </div>\n          <a\n            href={bestStore.link || '#'}\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            className=\"inline-flex items-center gap-2 rounded-full bg-success-500 px-5 py-2.5 text-sm font-medium text-white transition-colors hover:bg-success-600\"\n          >\n              {bestStore.name}\n            <ExternalLink className=\"h-4 w-4\" />\n          </a>\n        </div>\n      )}\n\n      {/* Actions row */}\n      <div className=\"flex items-center gap-3\">\n        <Button onClick={onScrollToPrices} variant=\"outline\" size=\"sm\">\n           \n        </Button>\n\n        {/* Heart button */}\n        <motion.button\n          whileHover={{ scale: 1.1 }}\n          whileTap={{ scale: 0.9 }}\n          onClick={handleSaveToggle}\n          disabled={isToggling}\n          className={cn(\n            'relative rounded-full p-3 transition-colors',\n            isSaved\n              ? 'bg-error-100 text-error-500 dark:bg-error-900/30'\n              : 'bg-badge text-foreground/40 hover:text-error-500 dark:bg-card-dark'\n          )}\n        >\n          <Heart\n            className={cn('h-5 w-5', isSaved && 'fill-current')}\n          />\n\n          {/* Login prompt */}\n          {showLoginPrompt && (\n            <motion.div\n              initial={{ opacity: 0, y: 10 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: 10 }}\n              className=\"absolute -bottom-12 right-0 z-10 whitespace-nowrap rounded-lg bg-microbar px-3 py-2 text-xs text-white shadow-lg\"\n            >\n               {' '}\n              <Link to=\"/login\" className=\"text-primary-400 underline\">\n                \n              </Link>\n            </motion.div>\n          )}\n        </motion.button>\n      </div>\n    </div>\n  );\n}\n","import React from 'react';\nimport { motion } from 'framer-motion';\nimport { Info } from 'lucide-react';\n\ninterface Feature {\n  key: string;\n  value: string;\n}\n\ninterface ProductFeaturesProps {\n  features: Feature[];\n}\n\nexport function ProductFeatures({ features }: ProductFeaturesProps) {\n  if (features.length === 0) {\n    return (\n      <div className=\"rounded-2xl bg-card-light p-6 shadow-soft dark:bg-card-dark\">\n        <div className=\"mb-4 flex items-center gap-3\">\n          <div className=\"rounded-lg bg-primary-100 p-2 dark:bg-primary-900/30\">\n            <Info className=\"h-5 w-5 text-primary-500\" />\n          </div>\n          <h2 className=\"font-serif text-xl font-bold text-foreground\">\n            \n          </h2>\n        </div>\n        <p className=\"text-foreground/50\">\n           \n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      whileInView={{ opacity: 1, y: 0 }}\n      viewport={{ once: true }}\n      className=\"rounded-2xl bg-card-light p-6 shadow-soft dark:bg-card-dark\"\n    >\n      <div className=\"mb-6 flex items-center gap-3\">\n        <div className=\"rounded-lg bg-primary-100 p-2 dark:bg-primary-900/30\">\n          <Info className=\"h-5 w-5 text-primary-500\" />\n        </div>\n        <h2 className=\"font-serif text-xl font-bold text-foreground\">\n          \n        </h2>\n      </div>\n\n      <div className=\"overflow-hidden rounded-xl border border-border\">\n        {features.map((feature, index) => (\n          <div\n            key={feature.key}\n            className={`flex items-center justify-between gap-4 px-4 py-3 ${\n              index % 2 === 0 ? 'bg-bgAlt dark:bg-surface-dark/50' : ''\n            }`}\n          >\n            <span className=\"text-sm text-foreground/50\">\n              {feature.key}\n            </span>\n            <span className=\"text-right text-sm font-medium text-foreground\">\n              {feature.value}\n            </span>\n          </div>\n        ))}\n      </div>\n    </motion.div>\n  );\n}\n","import React, { useState } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { FileText, ChevronDown } from 'lucide-react';\nimport { cn } from '../../../utils/cn';\n\ninterface ProductDescriptionProps {\n  description?: string;\n}\n\nexport function ProductDescription({ description }: ProductDescriptionProps) {\n  const [isExpanded, setIsExpanded] = useState(false);\n\n  const renderDescription = (desc: string) => {\n    const sections = desc.split('\\n\\n');\n    return sections.map((section, index) => {\n      if (section.startsWith('**') && section.endsWith('**')) {\n        const title = section.slice(2, -2);\n        return (\n          <h4 key={index} className=\"mt-4 font-semibold text-foreground\">\n            {title}\n          </h4>\n        );\n      }\n      return (\n        <p key={index} className=\"mt-2 text-foreground/60\">\n          {section}\n        </p>\n      );\n    });\n  };\n\n  const shouldTruncate = description && description.length > 500;\n  const displayText = shouldTruncate && !isExpanded\n    ? description.slice(0, 500) + '...'\n    : description;\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      whileInView={{ opacity: 1, y: 0 }}\n      viewport={{ once: true }}\n      className=\"rounded-2xl bg-card-light p-6 shadow-soft dark:bg-card-dark\"\n    >\n      <div className=\"mb-4 flex items-center gap-3\">\n        <div className=\"rounded-lg bg-primary-100 p-2 dark:bg-primary-900/30\">\n          <FileText className=\"h-5 w-5 text-primary-500\" />\n        </div>\n        <h2 className=\"font-serif text-xl font-bold text-foreground\">\n           \n        </h2>\n      </div>\n\n      {description ? (\n        <div className=\"prose prose-sm max-w-none dark:prose-invert\">\n          <AnimatePresence mode=\"wait\">\n            <motion.div\n              key={isExpanded ? 'expanded' : 'collapsed'}\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              exit={{ opacity: 0 }}\n              transition={{ duration: 0.2 }}\n            >\n              {renderDescription(displayText || description)}\n            </motion.div>\n          </AnimatePresence>\n\n          {shouldTruncate && (\n            <button\n              onClick={() => setIsExpanded(!isExpanded)}\n              className=\"mt-4 flex items-center gap-1 text-sm font-medium text-primary-500 hover:text-primary-600\"\n            >\n              {isExpanded ? '' : ' '}\n              <ChevronDown\n                className={cn(\n                  'h-4 w-4 text-primary-500 transition-transform',\n                  isExpanded && 'rotate-180'\n                )}\n              />\n            </button>\n          )}\n        </div>\n      ) : (\n        <p className=\"text-foreground/50\"> </p>\n      )}\n    </motion.div>\n  );\n}\n","import React from 'react';\nimport { motion } from 'framer-motion';\nimport { BarChart3, ExternalLink, Store } from 'lucide-react';\nimport type { StorePrice } from '../../../types';\n\ninterface ProductPricesProps {\n  storePrices: StorePrice[];\n}\n\nexport function ProductPrices({ storePrices }: ProductPricesProps) {\n  if (!storePrices || storePrices.length === 0) {\n    return (\n      <div className=\"rounded-2xl bg-card-light p-6 shadow-soft dark:bg-card-dark\">\n        <div className=\"mb-4 flex items-center gap-3\">\n          <div className=\"rounded-lg bg-primary-100 p-2 dark:bg-primary-900/30\">\n            <BarChart3 className=\"h-5 w-5 text-primary-500\" />\n          </div>\n          <h2 className=\"font-serif text-xl font-bold text-foreground\">\n             \n          </h2>\n        </div>\n        <p className=\"text-foreground/50\">\n             \n        </p>\n      </div>\n    );\n  }\n\n  // Sort by price\n  const sortedPrices = [...storePrices].sort((a, b) => a.price - b.price);\n  const lowestPrice = sortedPrices[0]?.price;\n  const highestPrice = sortedPrices[sortedPrices.length - 1]?.price;\n  const savings = highestPrice - lowestPrice;\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      whileInView={{ opacity: 1, y: 0 }}\n      viewport={{ once: true }}\n      className=\"rounded-2xl bg-card-light p-6 shadow-soft dark:bg-card-dark\"\n    >\n      <div className=\"mb-6 flex flex-wrap items-center gap-3\">\n        <div className=\"rounded-lg bg-primary-100 p-2 dark:bg-primary-900/30\">\n          <BarChart3 className=\"h-5 w-5 text-primary-500\" />\n        </div>\n        <h2 className=\"font-serif text-xl font-bold text-foreground\">\n           \n        </h2>\n        <span className=\"rounded-full bg-badge px-3 py-1 text-sm text-foreground/50 dark:bg-card-dark dark:text-foreground/40\">\n          {storePrices.length} {storePrices.length === 1 ? '' : storePrices.length < 5 ? '' : ''}\n        </span>\n        {savings > 0 && (\n          <span className=\"ml-auto rounded-full bg-success-500 px-3 py-1 text-sm font-medium text-white\">\n              {savings} \n          </span>\n        )}\n      </div>\n\n      {/* Desktop table */}\n      <div className=\"hidden overflow-hidden rounded-xl border border-border md:block\">\n        <table className=\"w-full\">\n          <thead>\n            <tr className=\"border-b border-border bg-bgAlt dark:bg-surface-dark\">\n              <th className=\"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-foreground/50\">\n                \n              </th>\n              <th className=\"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-foreground/50\">\n                \n              </th>\n              <th className=\"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-foreground/50\">\n                \n              </th>\n              <th className=\"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-foreground/50\">\n                \n              </th>\n            </tr>\n          </thead>\n          <tbody>\n            {sortedPrices.map((store, index) => {\n              const isLowest = store.price === lowestPrice;\n\n              return (\n                <tr\n                  key={`${store.store_id}-${index}`}\n                  className={\n                    isLowest\n                      ? 'bg-success-50 dark:bg-success-900/10'\n                      : index % 2 === 1\n                      ? 'bg-bgAlt/50 dark:bg-surface-dark/50'\n                      : ''\n                  }\n                >\n                  {/* Store */}\n                  <td className=\"px-4 py-3\">\n                    <div className=\"flex items-center gap-3\">\n                      {store.logo ? (\n                        <img\n                          src={store.logo}\n                          alt={store.name}\n                          className=\"h-8 w-8 rounded-lg object-contain\"\n                          onError={(e) => {\n                            (e.target as HTMLImageElement).src = '/img/placeholder.webp';\n                          }}\n                        />\n                      ) : (\n                        <div className=\"flex h-8 w-8 items-center justify-center rounded-lg bg-primary-100 dark:bg-primary-900/30\">\n                          <Store className=\"h-4 w-4 text-primary-500\" />\n                        </div>\n                      )}\n                      <span className=\"font-medium text-foreground\">\n                        {store.name}\n                      </span>\n                    </div>\n                  </td>\n                  {/* Price */}\n                  <td className=\"px-4 py-3\">\n                    <div className=\"flex items-center gap-2\">\n                      <span className={`text-lg font-bold ${isLowest ? 'text-success-600' : 'text-foreground'}`}>\n                        {store.price} \n                      </span>\n                      {isLowest && (\n                        <span className=\"rounded-full bg-success-500 px-2 py-0.5 text-xs font-medium text-white\">\n                          MIN\n                        </span>\n                      )}\n                    </div>\n                  </td>\n                  {/* Delivery */}\n                  <td className=\"px-4 py-3 text-sm text-foreground/50\">\n                    {store.delivery || ''}\n                  </td>\n                  {/* Action */}\n                  <td className=\"px-4 py-3 text-right\">\n                    <a\n                      href={store.link || '#'}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      className={`inline-flex items-center gap-1.5 rounded-full px-4 py-1.5 text-sm font-medium transition-colors ${\n                        isLowest\n                          ? 'bg-success-500 text-white hover:bg-success-600'\n                          : 'border border-primary-500/30 text-primary-500 hover:bg-primary-50 dark:hover:bg-primary-900/20'\n                      }`}\n                    >\n                      \n                      <ExternalLink className=\"h-3.5 w-3.5\" />\n                    </a>\n                  </td>\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n\n      {/* Mobile cards */}\n      <div className=\"space-y-3 md:hidden\">\n        {sortedPrices.map((store, index) => {\n          const isLowest = store.price === lowestPrice;\n\n          return (\n            <div\n              key={`${store.store_id}-${index}`}\n              className={`relative rounded-xl border p-4 ${\n                isLowest\n                  ? 'border-success-500/30 bg-success-50 dark:bg-success-900/10'\n                  : 'border-border'\n              }`}\n            >\n              {isLowest && (\n                <span className=\"absolute -top-2 left-3 rounded-full bg-success-500 px-2 py-0.5 text-xs font-medium text-white\">\n                  MIN\n                </span>\n              )}\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-3\">\n                  {store.logo ? (\n                    <img\n                      src={store.logo}\n                      alt={store.name}\n                      className=\"h-8 w-8 rounded-lg object-contain\"\n                      onError={(e) => {\n                        (e.target as HTMLImageElement).src = '/img/placeholder.webp';\n                      }}\n                    />\n                  ) : (\n                    <div className=\"flex h-8 w-8 items-center justify-center rounded-lg bg-primary-100 dark:bg-primary-900/30\">\n                      <Store className=\"h-4 w-4 text-primary-500\" />\n                    </div>\n                  )}\n                  <div>\n                    <span className=\"font-medium text-foreground\">{store.name}</span>\n                    {store.delivery && (\n                      <div className=\"text-xs text-foreground/40\">{store.delivery}</div>\n                    )}\n                  </div>\n                </div>\n                <div className=\"text-right\">\n                  <div className={`text-lg font-bold ${isLowest ? 'text-success-600' : 'text-foreground'}`}>\n                    {store.price} \n                  </div>\n                  <a\n                    href={store.link || '#'}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"text-xs font-medium text-primary-500 hover:text-primary-600\"\n                  >\n                     \n                  </a>\n                </div>\n              </div>\n            </div>\n          );\n        })}\n      </div>\n    </motion.div>\n  );\n}\n","import React, { useEffect, useRef, useState, useCallback, useMemo } from 'react';\nimport { createPortal } from 'react-dom';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { MapPin, X, Search, Maximize2, Filter, LocateFixed } from 'lucide-react';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport 'leaflet.markercluster/dist/MarkerCluster.css';\nimport 'leaflet.markercluster/dist/MarkerCluster.Default.css';\nimport 'leaflet.markercluster';\nimport { Button } from '../../ui/Button';\nimport { cn } from '../../../utils/cn';\nimport type { StoreLocation, StorePrice, City } from '../../../types';\n\n// Fix Leaflet icon issues\ndelete (L.Icon.Default.prototype as any)._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',\n  iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',\n  shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',\n});\n\ninterface ProductMapProps {\n  storeLocations: StoreLocation[];\n  storePrices: StorePrice[];\n  cities: City[];\n  cityCoordinates: Record<string, [number, number]>;\n}\n\ninterface SelectedStore extends StoreLocation {\n  price: number;\n  link?: string;\n}\n\nexport function ProductMap({\n  storeLocations,\n  storePrices,\n  cities,\n  cityCoordinates,\n}: ProductMapProps) {\n  const mapContainerRef = useRef<HTMLDivElement>(null);\n  const fullScreenMapContainerRef = useRef<HTMLDivElement>(null);\n  const mapRef = useRef<L.Map | null>(null);\n  const fullScreenMapRef = useRef<L.Map | null>(null);\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const clusterGroupRef = useRef<any>(null);\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const fullScreenClusterGroupRef = useRef<any>(null);\n  const markerRefs = useRef<Record<string, L.Marker>>({});\n  const fullScreenMarkerRefs = useRef<Record<string, L.Marker>>({});\n  const mapInitializedRef = useRef(false);\n  const fullScreenMapInitializedRef = useRef(false);\n\n  const [isFullScreen, setIsFullScreen] = useState(false);\n  const [selectedStore, setSelectedStore] = useState<SelectedStore | null>(null);\n  const [activeMarkerId, setActiveMarkerId] = useState<string | null>(null);\n  const [citySearch, setCitySearch] = useState('');\n  const [showCityPopup, setShowCityPopup] = useState(false);\n  const [selectedFilters, setSelectedFilters] = useState<string[]>([]);\n  const [showFilters, setShowFilters] = useState(false);\n  const [isLocating, setIsLocating] = useState(false);\n  const userMarkerRef = useRef<L.Marker | null>(null);\n\n  const cityPopupRef = useRef<HTMLDivElement>(null);\n\n  const storedLocation = localStorage.getItem('userLocationStatus');\n  const userLocation = storedLocation && storedLocation !== 'denied' ? storedLocation : '';\n\n  // Top cities for quick access\n  const topCities = useMemo(() => [\n    '', '', '', '', '',\n    '', '', ' ', '', ' '\n  ], []);\n\n  // Unique store names for filtering\n  const uniqueStores = useMemo(() => {\n    return [...new Set(storeLocations.map((loc) => loc.store_name))];\n  }, [storeLocations]);\n\n  // Get price for store\n  const getPriceForStore = useCallback((storeName: string): string => {\n    const storePrice = storePrices.find((sp) => sp.name === storeName);\n    return storePrice ? `${storePrice.price} ` : '/';\n  }, [storePrices]);\n\n  // Get default coordinates\n  const getDefaultCoordinates = useCallback(async (): Promise<{ coords: [number, number]; zoom: number }> => {\n    let coords: [number, number] = [50.4501, 30.5234]; // Kyiv default\n    let zoom = 12;\n\n    if (userLocation && userLocation !== ' ') {\n      if (userLocation in cityCoordinates) {\n        coords = cityCoordinates[userLocation];\n      } else if (userLocation === ' ' && navigator.geolocation) {\n        try {\n          const position = await new Promise<GeolocationPosition>((resolve, reject) => {\n            navigator.geolocation.getCurrentPosition(resolve, reject, {\n              enableHighAccuracy: true,\n              timeout: 10000,\n              maximumAge: 0,\n            });\n          });\n          coords = [position.coords.latitude, position.coords.longitude];\n        } catch {\n          // Use default if geolocation fails\n        }\n      }\n    }\n\n    return { coords, zoom };\n  }, [userLocation, cityCoordinates]);\n\n  // Create price label icon\n  const createPriceIcon = useCallback((price: string, isActive: boolean) => {\n    return L.divIcon({\n      html: `\n        <div class=\"flex items-center justify-center px-2 py-1 text-xs font-semibold rounded-full shadow-lg transition-all ${\n          isActive\n            ? 'bg-primary-500 text-white scale-110'\n            : 'bg-white text-gray-900 dark:bg-gray-800 dark:text-white'\n        }\">\n          ${price}\n        </div>\n      `,\n      className: 'custom-price-marker',\n      iconSize: [80, 28],\n      iconAnchor: [40, 14],\n    });\n  }, []);\n\n  // Create markers for map\n  const createMarkers = useCallback((\n    map: L.Map,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    clusterGroup: any,\n    markers: Record<string, L.Marker>,\n    isFullScreenMap: boolean\n  ) => {\n    // Clear existing markers\n    clusterGroup.clearLayers();\n    Object.keys(markers).forEach((key) => delete markers[key]);\n\n    // Filter locations\n    const filteredLocations = selectedFilters.length > 0\n      ? storeLocations.filter((loc) => selectedFilters.includes(loc.store_name))\n      : storeLocations;\n\n    filteredLocations.forEach((location, index) => {\n      const price = getPriceForStore(location.store_name);\n      const markerId = `${location.store_name}_${location.latitude}_${location.longitude}_${index}`;\n\n      const marker = L.marker([location.latitude, location.longitude], {\n        icon: createPriceIcon(price, activeMarkerId === markerId),\n      });\n\n      marker.on('click', () => {\n        setActiveMarkerId((prev) => {\n          const newId = prev === markerId ? null : markerId;\n          if (newId && isFullScreenMap) {\n            const storePrice = storePrices.find((sp) => sp.name === location.store_name);\n            setSelectedStore({\n              ...location,\n              price: storePrice?.price || 0,\n              link: storePrice?.link,\n            });\n          } else if (!newId) {\n            setSelectedStore(null);\n          }\n          return newId;\n        });\n\n        map.panTo([location.latitude, location.longitude], { animate: true, duration: 0.5 });\n      });\n\n      markers[markerId] = marker;\n      clusterGroup.addLayer(marker);\n    });\n  }, [storeLocations, storePrices, selectedFilters, activeMarkerId, getPriceForStore, createPriceIcon]);\n\n  // Initialize inline map (only once when data is available)\n  useEffect(() => {\n    if (mapInitializedRef.current || !mapContainerRef.current || storeLocations.length === 0) return;\n\n    let cancelled = false;\n    const container = mapContainerRef.current;\n\n    const initMap = async () => {\n      const { coords, zoom } = await getDefaultCoordinates();\n\n      // After await, check if this effect was cleaned up (React StrictMode double-mount)\n      if (cancelled || mapRef.current) return;\n\n      if ((container as any)._leaflet_id) {\n        delete (container as any)._leaflet_id;\n      }\n\n      mapRef.current = L.map(container, {\n        center: coords,\n        zoom,\n        scrollWheelZoom: false,\n        dragging: true,\n        zoomControl: false,\n      });\n\n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n        attribution: '&copy; OpenStreetMap contributors',\n      }).addTo(mapRef.current);\n\n      clusterGroupRef.current = (L as any).markerClusterGroup({\n        maxClusterRadius: 30,\n        disableClusteringAtZoom: 18,\n        iconCreateFunction: (cluster: any) => {\n          return L.divIcon({\n            html: `<div class=\"flex items-center justify-center h-10 w-10 rounded-full bg-primary-500 text-white font-bold text-sm shadow-lg\">${cluster.getChildCount()}</div>`,\n            className: 'custom-cluster-icon',\n            iconSize: L.point(40, 40),\n          });\n        },\n      });\n\n      mapRef.current.addLayer(clusterGroupRef.current);\n      mapInitializedRef.current = true;\n      createMarkers(mapRef.current, clusterGroupRef.current, markerRefs.current, false);\n\n      // Auto-show user location\n      addUserMarker(mapRef.current);\n    };\n\n    initMap();\n\n    return () => {\n      cancelled = true;\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [storeLocations]);\n\n  // Cleanup inline map on unmount\n  useEffect(() => {\n    return () => {\n      if (mapRef.current) {\n        mapRef.current.remove();\n        mapRef.current = null;\n        clusterGroupRef.current = null;\n        mapInitializedRef.current = false;\n      }\n    };\n  }, []);\n\n  // Update markers when filters change (both inline and fullscreen)\n  useEffect(() => {\n    if (mapRef.current && clusterGroupRef.current) {\n      createMarkers(mapRef.current, clusterGroupRef.current, markerRefs.current, false);\n    }\n    if (fullScreenMapRef.current && fullScreenClusterGroupRef.current) {\n      createMarkers(fullScreenMapRef.current, fullScreenClusterGroupRef.current, fullScreenMarkerRefs.current, true);\n    }\n  }, [selectedFilters, createMarkers]);\n\n  // Initialize fullscreen map\n  useEffect(() => {\n    if (!isFullScreen || !fullScreenMapContainerRef.current) {\n      // Cleanup when closing fullscreen\n      if (!isFullScreen && fullScreenMapRef.current) {\n        if (userMarkerRef.current) {\n          userMarkerRef.current.remove();\n          userMarkerRef.current = null;\n        }\n        fullScreenMapRef.current.remove();\n        fullScreenMapRef.current = null;\n        fullScreenClusterGroupRef.current = null;\n        fullScreenMapInitializedRef.current = false;\n      }\n      return;\n    }\n\n    if (fullScreenMapInitializedRef.current) return;\n\n    let cancelled = false;\n    const fsContainer = fullScreenMapContainerRef.current;\n\n    const initFullScreenMap = async () => {\n      const { coords, zoom } = await getDefaultCoordinates();\n\n      if (cancelled || fullScreenMapRef.current) return;\n\n      if ((fsContainer as any)._leaflet_id) {\n        delete (fsContainer as any)._leaflet_id;\n      }\n\n      fullScreenMapRef.current = L.map(fsContainer, {\n        center: coords,\n        zoom,\n        scrollWheelZoom: true,\n        dragging: true,\n        zoomControl: false,\n      });\n\n      L.control.zoom({ position: 'bottomright' }).addTo(fullScreenMapRef.current);\n\n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n        attribution: '&copy; OpenStreetMap contributors',\n      }).addTo(fullScreenMapRef.current);\n\n      fullScreenClusterGroupRef.current = (L as any).markerClusterGroup({\n        maxClusterRadius: 30,\n        disableClusteringAtZoom: 18,\n        iconCreateFunction: (cluster: any) => {\n          return L.divIcon({\n            html: `<div class=\"flex items-center justify-center h-10 w-10 rounded-full bg-primary-500 text-white font-bold text-sm shadow-lg\">${cluster.getChildCount()}</div>`,\n            className: 'custom-cluster-icon',\n            iconSize: L.point(40, 40),\n          });\n        },\n      });\n\n      fullScreenMapRef.current.addLayer(fullScreenClusterGroupRef.current);\n      fullScreenMapInitializedRef.current = true;\n      createMarkers(fullScreenMapRef.current, fullScreenClusterGroupRef.current, fullScreenMarkerRefs.current, true);\n\n      // Auto-show user location\n      addUserMarker(fullScreenMapRef.current);\n\n      setTimeout(() => {\n        fullScreenMapRef.current?.invalidateSize();\n      }, 100);\n    };\n\n    initFullScreenMap();\n\n    return () => {\n      cancelled = true;\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isFullScreen]);\n\n  // Handle city select\n  const handleCitySelect = useCallback(async (cityName: string) => {\n    if (!fullScreenMapRef.current) return;\n\n    let coords: [number, number] = [50.4501, 30.5234];\n\n    if (cityName === ' ' && navigator.geolocation) {\n      try {\n        const position = await new Promise<GeolocationPosition>((resolve, reject) => {\n          navigator.geolocation.getCurrentPosition(resolve, reject);\n        });\n        coords = [position.coords.latitude, position.coords.longitude];\n      } catch {\n        return;\n      }\n    } else if (cityName in cityCoordinates) {\n      coords = cityCoordinates[cityName];\n    }\n\n    fullScreenMapRef.current.flyTo(coords, 14, { animate: true, duration: 1 });\n    setShowCityPopup(false);\n    setCitySearch('');\n  }, [cityCoordinates]);\n\n  // Filter cities\n  const filteredCities = useMemo(() => {\n    if (citySearch) {\n      return cities.filter((city) =>\n        city.name_ua.toLowerCase().includes(citySearch.toLowerCase())\n      );\n    }\n    return [\n      ...cities.filter((city) => topCities.slice(0, -1).includes(city.name_ua)),\n      { id: -1, name_ua: ' ', latitude: 0, longitude: 0 } as City,\n    ].slice(0, 10);\n  }, [cities, citySearch, topCities]);\n\n  // Handle click outside city popup\n  useEffect(() => {\n    const handleClickOutside = (e: MouseEvent) => {\n      if (cityPopupRef.current && !cityPopupRef.current.contains(e.target as Node)) {\n        setShowCityPopup(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  // Handle filter toggle\n  const handleFilterToggle = (store: string) => {\n    setSelectedFilters((prev) =>\n      prev.includes(store)\n        ? prev.filter((s) => s !== store)\n        : [...prev, store]\n    );\n  };\n\n  // Add user location marker to a map (without panning)\n  const addUserMarker = useCallback((map: L.Map) => {\n    if (!navigator.geolocation) return;\n\n    navigator.geolocation.getCurrentPosition(\n      (position) => {\n        const { latitude, longitude } = position.coords;\n        const coords: [number, number] = [latitude, longitude];\n\n        // Remove old user marker\n        if (userMarkerRef.current) {\n          userMarkerRef.current.remove();\n        }\n\n        // Create user location marker with pulsing blue dot\n        userMarkerRef.current = L.marker(coords, {\n          icon: L.divIcon({\n            html: `<div class=\"relative flex items-center justify-center\">\n              <div class=\"absolute h-8 w-8 animate-ping rounded-full bg-blue-400/30\"></div>\n              <div class=\"h-4 w-4 rounded-full border-2 border-white bg-blue-500 shadow-lg\"></div>\n            </div>`,\n            className: 'user-location-marker',\n            iconSize: [32, 32],\n            iconAnchor: [16, 16],\n          }),\n        }).addTo(map);\n      },\n      () => { /* geolocation denied/failed - silently ignore */ },\n      { enableHighAccuracy: true, timeout: 10000, maximumAge: 60000 }\n    );\n  }, []);\n\n  // Locate user on map (with fly-to animation)\n  const handleLocateMe = useCallback(() => {\n    if (!navigator.geolocation) return;\n\n    const map = fullScreenMapRef.current || mapRef.current;\n    if (!map) return;\n\n    setIsLocating(true);\n\n    navigator.geolocation.getCurrentPosition(\n      (position) => {\n        const { latitude, longitude } = position.coords;\n        const coords: [number, number] = [latitude, longitude];\n\n        // Remove old user marker\n        if (userMarkerRef.current) {\n          userMarkerRef.current.remove();\n        }\n\n        // Create user location marker with pulsing blue dot\n        userMarkerRef.current = L.marker(coords, {\n          icon: L.divIcon({\n            html: `<div class=\"relative flex items-center justify-center\">\n              <div class=\"absolute h-8 w-8 animate-ping rounded-full bg-blue-400/30\"></div>\n              <div class=\"h-4 w-4 rounded-full border-2 border-white bg-blue-500 shadow-lg\"></div>\n            </div>`,\n            className: 'user-location-marker',\n            iconSize: [32, 32],\n            iconAnchor: [16, 16],\n          }),\n        }).addTo(map);\n\n        map.flyTo(coords, 15, { animate: true, duration: 1 });\n        setIsLocating(false);\n      },\n      () => {\n        setIsLocating(false);\n      },\n      { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }\n    );\n  }, []);\n\n  // Close fullscreen on escape\n  useEffect(() => {\n    const handleEscape = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        setIsFullScreen(false);\n        setSelectedStore(null);\n        setActiveMarkerId(null);\n      }\n    };\n\n    window.addEventListener('keydown', handleEscape);\n    return () => window.removeEventListener('keydown', handleEscape);\n  }, []);\n\n  if (storeLocations.length === 0) {\n    return (\n      <div className=\"rounded-2xl bg-surface-light p-8 text-center dark:bg-card-dark\">\n        <MapPin className=\"mx-auto mb-3 h-12 w-12 text-foreground/40\" />\n        <p className=\"text-foreground/50 dark:text-foreground/40\">\n            \n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <>\n      {/* Inline Map */}\n      <div\n        onClick={() => setIsFullScreen(true)}\n        className=\"group relative z-0 cursor-pointer overflow-hidden rounded-2xl\"\n      >\n        <div ref={mapContainerRef} className=\"h-48 w-full\" />\n        <div className=\"absolute inset-0 flex items-center justify-center bg-black/0 transition-colors group-hover:bg-surface-dark/20\">\n          <div className=\"rounded-full bg-card-light/90 p-3 opacity-0 shadow-lg transition-opacity group-hover:opacity-100 dark:bg-card-dark/90\">\n            <Maximize2 className=\"h-5 w-5 text-foreground/70\" />\n          </div>\n        </div>\n        <div className=\"absolute bottom-2 left-2 rounded-full bg-card-light/90 px-3 py-1 text-xs font-medium shadow dark:bg-card-dark/90\">\n          <MapPin className=\"mr-1 inline h-3 w-3\" />\n          {storeLocations.length} \n        </div>\n      </div>\n\n      {/* Fullscreen Map Modal - rendered via portal to escape parent stacking context */}\n      {createPortal(\n        <AnimatePresence>\n          {isFullScreen && (\n            <motion.div\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              exit={{ opacity: 0 }}\n              className=\"fixed inset-0 z-[9999] bg-black/90\"\n            >\n            <div ref={fullScreenMapContainerRef} className=\"h-full w-full\" />\n\n            {/* Close button */}\n            <button\n              onClick={() => {\n                setIsFullScreen(false);\n                setSelectedStore(null);\n                setActiveMarkerId(null);\n              }}\n              className=\"absolute right-4 top-4 z-[1000] rounded-full bg-card-light p-3 shadow-lg transition-colors hover:bg-primary-50 dark:bg-card-dark dark:hover:bg-primary-900/20\"\n            >\n              <X className=\"h-5 w-5\" />\n            </button>\n\n            {/* Locate me button */}\n            <button\n              onClick={handleLocateMe}\n              disabled={isLocating}\n              className={cn(\n                'absolute right-4 top-16 z-[1000] rounded-full p-3 shadow-lg transition-colors',\n                isLocating\n                  ? 'bg-primary-500 text-white'\n                  : 'bg-card-light hover:bg-primary-50 dark:bg-card-dark dark:hover:bg-primary-900/20'\n              )}\n              title=\" \"\n            >\n              <LocateFixed className={cn('h-5 w-5', isLocating && 'animate-pulse')} />\n            </button>\n\n            {/* City search */}\n            <div className=\"absolute left-4 top-4 z-[1000] w-64\">\n              <div className=\"relative\">\n                <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-foreground/40\" />\n                <input\n                  type=\"text\"\n                  placeholder=\" ...\"\n                  value={citySearch}\n                  onChange={(e) => {\n                    setCitySearch(e.target.value);\n                    setShowCityPopup(true);\n                  }}\n                  onFocus={() => setShowCityPopup(true)}\n                  className=\"w-full rounded-lg bg-card-light py-2 pl-10 pr-4 shadow-lg dark:bg-card-dark\"\n                />\n              </div>\n\n              <AnimatePresence>\n                {showCityPopup && (\n                  <motion.div\n                    ref={cityPopupRef}\n                    initial={{ opacity: 0, y: -10 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    exit={{ opacity: 0, y: -10 }}\n                    className=\"absolute mt-2 max-h-64 w-full overflow-y-auto rounded-lg bg-card-light shadow-lg dark:bg-card-dark\"\n                  >\n                    {filteredCities.map((city) => (\n                      <button\n                        key={city.id}\n                        onClick={() => handleCitySelect(city.name_ua)}\n                        className=\"flex w-full items-center gap-2 px-4 py-2 text-left text-sm hover:bg-primary-50 dark:hover:bg-primary-900/20\"\n                      >\n                        {city.name_ua === ' ' ? (\n                          <MapPin className=\"h-4 w-4 text-primary-500\" />\n                        ) : (\n                          <MapPin className=\"h-4 w-4 text-foreground/40\" />\n                        )}\n                        {city.name_ua}\n                      </button>\n                    ))}\n                  </motion.div>\n                )}\n              </AnimatePresence>\n            </div>\n\n            {/* Filter button */}\n            <button\n              onClick={() => setShowFilters(!showFilters)}\n              className={cn(\n                'absolute left-4 top-16 z-[1000] mt-2 flex items-center gap-2 rounded-lg px-4 py-2 shadow-lg transition-colors',\n                showFilters\n                  ? 'bg-primary-500 text-white'\n                  : 'bg-card-light hover:bg-primary-50 dark:bg-card-dark dark:hover:bg-primary-900/20'\n              )}\n            >\n              <Filter className=\"h-4 w-4\" />\n              \n              {selectedFilters.length > 0 && (\n                <span className=\"rounded-full bg-white/20 px-2 py-0.5 text-xs\">\n                  {selectedFilters.length}\n                </span>\n              )}\n            </button>\n\n            {/* Filter panel */}\n            <AnimatePresence>\n              {showFilters && (\n                <motion.div\n                  initial={{ opacity: 0, x: -20 }}\n                  animate={{ opacity: 1, x: 0 }}\n                  exit={{ opacity: 0, x: -20 }}\n                  className=\"absolute bottom-4 left-4 top-32 z-[1000] w-64 overflow-y-auto rounded-lg bg-card-light p-4 shadow-lg dark:bg-card-dark\"\n                >\n                  <h3 className=\"mb-3 font-semibold text-foreground dark:text-white\">\n                    \n                  </h3>\n                  <div className=\"space-y-2\">\n                    {uniqueStores.map((store) => (\n                      <label\n                        key={store}\n                        className=\"flex cursor-pointer items-center gap-2\"\n                      >\n                        <input\n                          type=\"checkbox\"\n                          checked={selectedFilters.includes(store)}\n                          onChange={() => handleFilterToggle(store)}\n                          className=\"h-4 w-4 rounded border-border text-primary-500 focus:ring-primary-500\"\n                        />\n                        <span className=\"text-sm text-foreground/70 dark:text-foreground/60\">\n                          {store}\n                        </span>\n                      </label>\n                    ))}\n                  </div>\n                  {selectedFilters.length > 0 && (\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      className=\"mt-4 w-full\"\n                      onClick={() => setSelectedFilters([])}\n                    >\n                       \n                    </Button>\n                  )}\n                </motion.div>\n              )}\n            </AnimatePresence>\n\n            {/* Selected store panel */}\n            <AnimatePresence>\n              {selectedStore && (\n                <motion.div\n                  initial={{ opacity: 0, x: 20 }}\n                  animate={{ opacity: 1, x: 0 }}\n                  exit={{ opacity: 0, x: 20 }}\n                  className=\"absolute bottom-4 right-4 z-[1000] w-80 rounded-lg bg-card-light p-4 shadow-lg dark:bg-card-dark\"\n                >\n                  <button\n                    onClick={() => {\n                      setSelectedStore(null);\n                      setActiveMarkerId(null);\n                    }}\n                    className=\"absolute right-2 top-2 rounded-full p-1 hover:bg-primary-50 dark:hover:bg-primary-900/20\"\n                  >\n                    <X className=\"h-4 w-4\" />\n                  </button>\n\n                  <h3 className=\"mb-2 font-semibold text-foreground dark:text-white\">\n                    {selectedStore.store_name}\n                  </h3>\n\n                  {selectedStore.address && (\n                    <p className=\"mb-2 text-sm text-foreground/50 dark:text-foreground/40\">\n                      <MapPin className=\"mr-1 inline h-4 w-4\" />\n                      {selectedStore.address}\n                    </p>\n                  )}\n\n                  {(selectedStore.hours_mon_fri || selectedStore.hours_sat || selectedStore.hours_sun) && (\n                    <div className=\"mb-3 space-y-1 text-xs text-foreground/50 dark:text-foreground/40\">\n                      {selectedStore.hours_mon_fri && (\n                        <p>-: {selectedStore.hours_mon_fri}</p>\n                      )}\n                      {selectedStore.hours_sat && (\n                        <p>: {selectedStore.hours_sat}</p>\n                      )}\n                      {selectedStore.hours_sun && (\n                        <p>: {selectedStore.hours_sun}</p>\n                      )}\n                    </div>\n                  )}\n\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-xl font-bold text-success-500\">\n                      {selectedStore.price} \n                    </span>\n                    <Button\n                      size=\"sm\"\n                      onClick={() => selectedStore.link && window.open(selectedStore.link, '_blank')}\n                    >\n                      \n                    </Button>\n                  </div>\n                </motion.div>\n              )}\n            </AnimatePresence>\n          </motion.div>\n          )}\n        </AnimatePresence>,\n        document.body\n      )}\n    </>\n  );\n}\n","import React, { useRef, useState } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { MapPin } from 'lucide-react';\nimport { useProductDetail } from '../hooks/useProductDetail';\nimport { ProductGallery } from '../components/features/product/ProductGallery';\nimport { ProductInfo } from '../components/features/product/ProductInfo';\nimport { ProductFeatures } from '../components/features/product/ProductFeatures';\nimport { ProductDescription } from '../components/features/product/ProductDescription';\nimport { ProductPrices } from '../components/features/product/ProductPrices';\nimport { ProductMap } from '../components/features/product/ProductMap';\nimport { Breadcrumbs } from '../components/common/Breadcrumbs';\nimport { Button } from '../components/ui/Button';\nimport { FullPageSpinner } from '../components/ui/Spinner';\n\nexport default function ProductDetailPage() {\n  const { productId } = useParams<{ productId: string }>();\n  const navigate = useNavigate();\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\n\n  const {\n    data,\n    isLoading,\n    error,\n    isSaved,\n    toggleSave,\n    deleteProduct,\n    cityCoordinates,\n    getMinPrice,\n    images,\n    featureList,\n  } = useProductDetail(productId);\n\n  // Section refs for scrolling\n  const pricesRef = useRef<HTMLDivElement>(null);\n\n  // User info\n  const user = JSON.parse(localStorage.getItem('user') || 'null');\n  const isAdmin = user?.is_admin;\n\n  // Scroll to prices\n  const scrollToPrices = () => {\n    pricesRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  // Handle delete\n  const handleDelete = async () => {\n    try {\n      await deleteProduct();\n      navigate('/search');\n    } catch (err) {\n      console.error('Delete error:', err);\n    }\n    setShowDeleteModal(false);\n  };\n\n  if (isLoading) {\n    return <FullPageSpinner />;\n  }\n\n  if (error || !data.product) {\n    return (\n      <div className=\"container-main py-16\">\n        <div className=\"mx-auto max-w-md text-center\">\n          <div className=\"mb-4 text-6xl\"></div>\n          <h1 className=\"mb-2 font-serif text-2xl font-bold text-foreground\">\n            {error || '  '}\n          </h1>\n          <p className=\"mb-6 text-foreground/50\">\n                  \n          </p>\n          <Button onClick={() => navigate(-1)}>\n             \n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  const { product, storeLocations, cities } = data;\n\n  const breadcrumbItems = [\n    ...(product.category_name\n      ? [{ label: product.category_name, href: `/subcategories/${product.category_id}` }]\n      : []),\n    ...(product.brand_name\n      ? [{ label: product.brand_name, href: `/search?query=${encodeURIComponent(product.brand_name)}` }]\n      : []),\n    { label: product.name },\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-surface-light dark:bg-surface-dark\">\n      {/* Breadcrumbs */}\n      <div className=\"border-b border-border bg-card-light dark:bg-card-dark\">\n        <div className=\"container-main py-3\">\n          <Breadcrumbs items={breadcrumbItems} />\n        </div>\n      </div>\n\n      {/* Main content */}\n      <div className=\"container-main py-8\">\n        {/* Top section: Gallery + Info */}\n        <div className=\"mb-8 grid gap-8 lg:grid-cols-2\">\n          {/* Gallery */}\n          <motion.div\n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ duration: 0.4 }}\n          >\n            <ProductGallery images={images} productName={product.name} />\n          </motion.div>\n\n          {/* Product info */}\n          <motion.div\n            initial={{ opacity: 0, x: 20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ duration: 0.4, delay: 0.1 }}\n            className=\"flex flex-col gap-6\"\n          >\n            <ProductInfo\n              product={product}\n              minPrice={getMinPrice()}\n              isSaved={isSaved}\n              onToggleSave={toggleSave}\n              onDelete={() => setShowDeleteModal(true)}\n              onScrollToPrices={scrollToPrices}\n              isAdmin={isAdmin}\n            />\n\n            {/* Map preview */}\n            <div className=\"rounded-2xl bg-card-light p-4 shadow-soft dark:bg-card-dark\">\n              <div className=\"mb-3 flex items-center gap-2 text-sm font-medium text-foreground/70\">\n                <MapPin className=\"h-4 w-4 text-primary-500\" />\n                 \n              </div>\n              <ProductMap\n                storeLocations={storeLocations}\n                storePrices={product.store_prices}\n                cities={cities}\n                cityCoordinates={cityCoordinates}\n              />\n            </div>\n          </motion.div>\n        </div>\n\n        {/* Price comparison */}\n        <div ref={pricesRef} className=\"mb-8 scroll-mt-20\">\n          <ProductPrices storePrices={product.store_prices} />\n        </div>\n\n        {/* Features + Description */}\n        <div className=\"space-y-8\">\n          <ProductFeatures features={featureList} />\n          <ProductDescription description={product.description_full} />\n        </div>\n      </div>\n\n      {/* Delete confirmation modal */}\n      <AnimatePresence>\n        {showDeleteModal && (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4\"\n            onClick={() => setShowDeleteModal(false)}\n          >\n            <motion.div\n              initial={{ scale: 0.95, opacity: 0 }}\n              animate={{ scale: 1, opacity: 1 }}\n              exit={{ scale: 0.95, opacity: 0 }}\n              onClick={(e) => e.stopPropagation()}\n              className=\"w-full max-w-md rounded-2xl bg-card-light p-6 shadow-xl dark:bg-card-dark\"\n            >\n              <h3 className=\"mb-2 text-lg font-bold text-foreground\">\n                 ?\n              </h3>\n              <p className=\"mb-6 text-foreground/50\">\n                 ,     ?    .\n              </p>\n              <div className=\"flex justify-end gap-3\">\n                <Button variant=\"ghost\" onClick={() => setShowDeleteModal(false)}>\n                  \n                </Button>\n                <Button variant=\"danger\" onClick={handleDelete}>\n                  \n                </Button>\n              </div>\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n}\n","import { useState, useEffect, useCallback, useMemo } from 'react';\nimport axios from 'axios';\nimport type { Product, City, StoreLocation } from '../types';\nimport { API_URL } from '../utils/api';\n\nexport interface ProductDetailData {\n  product: Product | null;\n  storeLocations: StoreLocation[];\n  cities: City[];\n}\n\nexport interface UseProductDetailReturn {\n  data: ProductDetailData;\n  isLoading: boolean;\n  error: string | null;\n  isSaved: boolean;\n  setIsSaved: (value: boolean) => void;\n  toggleSave: () => Promise<void>;\n  deleteProduct: () => Promise<void>;\n  cityCoordinates: Record<string, [number, number]>;\n  getMinPrice: () => string;\n  images: string[];\n  featureList: { key: string; value: string }[];\n}\n\nexport function useProductDetail(productId: string | undefined): UseProductDetailReturn {\n  const [data, setData] = useState<ProductDetailData>({\n    product: null,\n    storeLocations: [],\n    cities: [],\n  });\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isSaved, setIsSaved] = useState(false);\n\n  const token = localStorage.getItem('token');\n\n  // Fetch initial data\n  const fetchData = useCallback(async () => {\n    if (!productId) return;\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const [productRes, citiesRes, locationsRes] = await Promise.all([\n        axios.get(`${API_URL}/products/${productId}`),\n        axios.get(`${API_URL}/cities`),\n        axios.get(`${API_URL}/store-locations`, { params: { productId } }),\n      ]);\n\n      setData({\n        product: productRes.data,\n        cities: citiesRes.data,\n        storeLocations: locationsRes.data,\n      });\n    } catch (err) {\n      console.error('Error fetching product data:', err);\n      setError('  .  .');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [productId]);\n\n  useEffect(() => {\n    fetchData();\n  }, [fetchData]);\n\n  // Check saved status\n  const checkSavedStatus = useCallback(async () => {\n    if (!token || !productId) {\n      setIsSaved(false);\n      return;\n    }\n\n    try {\n      const res = await axios.get(`${API_URL}/saved-products/${productId}`, {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      setIsSaved(res.data.isSaved);\n    } catch (err) {\n      console.error('Error checking saved status:', err);\n    }\n  }, [productId, token]);\n\n  useEffect(() => {\n    if (!isLoading && !error && data.product) {\n      checkSavedStatus();\n    }\n  }, [checkSavedStatus, isLoading, error, data.product]);\n\n  // Toggle save\n  const toggleSave = useCallback(async () => {\n    if (!token || !productId) return;\n\n    try {\n      if (isSaved) {\n        await axios.delete(`${API_URL}/saved-products/${productId}`, {\n          headers: { Authorization: `Bearer ${token}` },\n        });\n        setIsSaved(false);\n      } else {\n        await axios.post(\n          `${API_URL}/saved-products`,\n          { productId },\n          { headers: { Authorization: `Bearer ${token}` } }\n        );\n        setIsSaved(true);\n      }\n    } catch (err) {\n      console.error('Error toggling save:', err);\n      throw new Error('     .');\n    }\n  }, [productId, token, isSaved]);\n\n  // Delete product\n  const deleteProduct = useCallback(async () => {\n    if (!token || !productId) return;\n\n    try {\n      await axios.delete(`${API_URL}/admin/product/${productId}`, {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n    } catch (err) {\n      console.error('Error deleting product:', err);\n      throw new Error('   .');\n    }\n  }, [productId, token]);\n\n  // City coordinates\n  const cityCoordinates = useMemo(() => {\n    const coords: Record<string, [number, number]> = {};\n    data.cities.forEach((city) => {\n      if (city.latitude && city.longitude) {\n        coords[city.name_ua] = [city.latitude, city.longitude];\n      }\n    });\n    return coords;\n  }, [data.cities]);\n\n  // Get minimum price\n  const getMinPrice = useCallback((): string => {\n    if (!data.product?.store_prices || data.product.store_prices.length === 0) {\n      return '/';\n    }\n    const min = Math.min(...data.product.store_prices.map((sp) => sp.price));\n    return `${min} `;\n  }, [data.product]);\n\n  // Images\n  const images = useMemo(() => {\n    return data.product?.images && data.product.images.length > 0\n      ? data.product.images\n      : ['/img/placeholder.webp'];\n  }, [data.product]);\n\n  // Feature list\n  const featureList = useMemo(() => {\n    if (!data.product?.features) return [];\n\n    const features = data.product.features;\n    return [\n      { key: '', value: features.brand },\n      { key: ' ', value: features.country },\n      { key: '', value: features.type },\n      { key: '', value: features.class },\n      { key: ' ', value: features.category },\n      { key: '', value: features.purpose },\n      { key: '', value: features.gender },\n      { key: ' ', value: features.active_ingredients },\n    ].filter((f): f is { key: string; value: string } => Boolean(f.value));\n  }, [data.product]);\n\n  return {\n    data,\n    isLoading,\n    error,\n    isSaved,\n    setIsSaved,\n    toggleSave,\n    deleteProduct,\n    cityCoordinates,\n    getMinPrice,\n    images,\n    featureList,\n  };\n}\n"],"names":["buttonVariants","cva","variants","variant","primary","secondary","accent","outline","ghost","link","danger","success","size","xs","sm","md","lg","xl","icon","defaultVariants","Button","forwardRef","_ref","ref","className","isLoading","leftIcon","rightIcon","children","disabled","props","_objectWithoutProperties","_excluded","_jsxs","_objectSpread","cn","_jsx","Loader2","displayName","Breadcrumbs","items","Link","to","Home","map","item","index","React","ChevronRight","href","label","ProductGallery","images","productName","currentIndex","setCurrentIndex","useState","isFullScreen","setIsFullScreen","direction","setDirection","handlePrev","useCallback","e","stopPropagation","prev","length","handleNext","handleThumbnailClick","useEffect","handleKeyDown","key","window","addEventListener","removeEventListener","document","body","style","overflow","slideVariants","enter","dir","x","opacity","center","exit","_Fragment","onClick","AnimatePresence","mode","custom","motion","img","src","alt","concat","initial","animate","transition","duration","ease","onError","target","ZoomIn","ChevronLeft","slice","div","X","ProductInfo","_product$store_prices","_sortedPrices","product","minPrice","isSaved","onToggleSave","onDelete","onScrollToPrices","isAdmin","navigate","useNavigate","showLoginPrompt","setShowLoginPrompt","isToggling","setIsToggling","token","localStorage","getItem","rating","Number","reviewCount","review_count","storeCount","store_prices","sortedPrices","sort","a","b","price","bestStore","worstPrice","savingsPercent","Math","round","handleEdit","id","Edit2","Trash2","brand_name","encodeURIComponent","name","r","stars","fullStars","floor","hasHalfStar","i","push","Star","renderStars","toFixed","Eye","views","async","navigator","clipboard","writeText","location","_unused","Share2","CheckCircle","volume","code","ArrowDown","rel","ExternalLink","button","whileHover","scale","whileTap","preventDefault","setTimeout","err","console","error","Heart","y","ProductFeatures","features","Info","whileInView","viewport","once","feature","value","ProductDescription","description","isExpanded","setIsExpanded","shouldTruncate","displayText","FileText","desc","split","section","startsWith","endsWith","title","ChevronDown","ProductPrices","_sortedPrices$","storePrices","BarChart3","lowestPrice","savings","store","isLowest","logo","Store","delivery","store_id","ProductMap","storeLocations","cities","cityCoordinates","mapContainerRef","useRef","fullScreenMapContainerRef","mapRef","fullScreenMapRef","clusterGroupRef","fullScreenClusterGroupRef","markerRefs","fullScreenMarkerRefs","mapInitializedRef","fullScreenMapInitializedRef","selectedStore","setSelectedStore","activeMarkerId","setActiveMarkerId","citySearch","setCitySearch","showCityPopup","setShowCityPopup","selectedFilters","setSelectedFilters","showFilters","setShowFilters","isLocating","setIsLocating","userMarkerRef","cityPopupRef","storedLocation","userLocation","topCities","useMemo","uniqueStores","Set","loc","store_name","getPriceForStore","storeName","storePrice","find","sp","getDefaultCoordinates","coords","geolocation","position","Promise","resolve","reject","getCurrentPosition","enableHighAccuracy","timeout","maximumAge","latitude","longitude","zoom","createPriceIcon","isActive","L","html","iconSize","iconAnchor","createMarkers","clusterGroup","markers","isFullScreenMap","clearLayers","Object","keys","forEach","filter","includes","markerId","marker","on","newId","panTo","addLayer","current","cancelled","container","_leaflet_id","scrollWheelZoom","dragging","zoomControl","attribution","addTo","maxClusterRadius","disableClusteringAtZoom","iconCreateFunction","cluster","getChildCount","addUserMarker","initMap","remove","fsContainer","_fullScreenMapRef$cur","invalidateSize","initFullScreenMap","handleCitySelect","cityName","_unused2","flyTo","filteredCities","city","name_ua","toLowerCase","handleClickOutside","contains","handleLocateMe","handleEscape","MapPin","Maximize2","createPortal","LocateFixed","Search","type","placeholder","onChange","onFocus","Filter","checked","s","handleFilterToggle","address","hours_mon_fri","hours_sat","hours_sun","open","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","iconUrl","shadowUrl","ProductDetailPage","productId","useParams","showDeleteModal","setShowDeleteModal","data","toggleSave","deleteProduct","getMinPrice","featureList","setData","setIsLoading","setError","setIsSaved","fetchData","productRes","citiesRes","locationsRes","all","axios","get","API_URL","params","checkSavedStatus","res","headers","Authorization","delete","post","Error","_data$product","min","_data$product2","_data$product3","brand","country","class","category","purpose","gender","active_ingredients","f","Boolean","useProductDetail","pricesRef","user","JSON","parse","is_admin","FullPageSpinner","breadcrumbItems","category_name","category_id","delay","scrollToPrices","_pricesRef$current","scrollIntoView","behavior","description_full"],"sourceRoot":""}