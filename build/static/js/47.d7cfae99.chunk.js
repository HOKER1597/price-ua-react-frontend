"use strict";(self.webpackChunkprice_ua=self.webpackChunkprice_ua||[]).push([[47],{1498:()=>{},2047:(e,a,t)=>{t.r(a),t.d(a,{default:()=>o});var s=t(2555),n=t(5043),i=t(9722),r=t(9688),l=(t(1498),t(579));const o=function(){const[e,a]=(0,n.useState)([]),[t,o]=(0,n.useState)([]),[c,d]=(0,n.useState)([]),[u,p]=(0,n.useState)({category_id:"",brand_id:"",name:"",volume:"",images:[null],code:"",features:[{key:"",value:""}],description:"",description_full:"",composition:"",usage:"",store_prices:[{store_id:"",price:"",link:""}]}),[m,g]=(0,n.useState)(null),[h,f]=(0,n.useState)(null),[x,v]=(0,n.useState)(null),[j,b]=(0,n.useState)(!1);(0,n.useEffect)((()=>{(async()=>{try{const e=await i.A.get("".concat(r.H,"/categories/public"));a(e.data.sort(((e,a)=>e.name_ua.localeCompare(a.name_ua))))}catch(e){console.error("\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u0437\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0435\u043d\u043d\u044f \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u0439:",e)}})(),(async()=>{try{const e=await i.A.get("".concat(r.H,"/brands"));o(e.data.sort(((e,a)=>e.name.localeCompare(a.name))))}catch(e){console.error("\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u0437\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0435\u043d\u043d\u044f \u0431\u0440\u0435\u043d\u0434\u0456\u0432:",e)}})(),(async()=>{try{const e=await i.A.get("".concat(r.H,"/stores"));d(e.data.sort(((e,a)=>e.name.localeCompare(a.name))))}catch(e){console.error("\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u0437\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0435\u043d\u043d\u044f \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0456\u0432:",e)}})()}),[]);const y=(e,a,t,n)=>{const{name:i,value:r}=e.target;if("image"===n){const t=[...u.images];t[a]=e.target.files[0],p((0,s.A)((0,s.A)({},u),{},{images:t})),g(e.target.files[0])}else if("feature"===n){const e=[...u.features];e[a][t]=r,p((0,s.A)((0,s.A)({},u),{},{features:e}))}else if("store_price"===n){const e=[...u.store_prices];e[a][t]=r,p((0,s.A)((0,s.A)({},u),{},{store_prices:e}))}else p((0,s.A)((0,s.A)({},u),{},{[i]:r}))},_=()=>{u.images.length<10&&p((0,s.A)((0,s.A)({},u),{},{images:[...u.images,null]}))},k=e=>{const a=u.images.filter(((a,t)=>t!==e));p((0,s.A)((0,s.A)({},u),{},{images:a.length>0?a:[null]})),m&&e===u.images.length-1&&g(null)},N=()=>{u.features.length<10&&p((0,s.A)((0,s.A)({},u),{},{features:[...u.features,{key:"",value:""}]}))},C=e=>{const a=u.features.filter(((a,t)=>t!==e));p((0,s.A)((0,s.A)({},u),{},{features:a.length>0?a:[{key:"",value:""}]}))},A=()=>{u.store_prices.length<10&&p((0,s.A)((0,s.A)({},u),{},{store_prices:[...u.store_prices,{store_id:"",price:"",link:""}]}))},S=e=>{const a=u.store_prices.filter(((a,t)=>t!==e));p((0,s.A)((0,s.A)({},u),{},{store_prices:a.length>0?a:[{store_id:"",price:"",link:""}]}))},w=[{key:"brand",label:"\u0411\u0440\u0435\u043d\u0434"},{key:"country",label:"\u041a\u0440\u0430\u0457\u043d\u0430"},{key:"type",label:"\u0422\u0438\u043f"},{key:"class",label:"\u041a\u043b\u0430\u0441"},{key:"category",label:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u044f"},{key:"purpose",label:"\u041f\u0440\u0438\u0437\u043d\u0430\u0447\u0435\u043d\u043d\u044f"},{key:"gender",label:"\u0421\u0442\u0430\u0442\u044c"},{key:"active_ingredients",label:"\u0410\u043a\u0442\u0438\u0432\u043d\u0456 \u0456\u043d\u0433\u0440\u0435\u0434\u0456\u0454\u043d\u0442\u0438"}],F=e=>{const a=u.features.filter(((a,t)=>t!==e)).map((e=>e.key)).filter((e=>e));return w.filter((e=>!a.includes(e.key)))},H=e=>{const a=u.store_prices.filter(((a,t)=>t!==e)).map((e=>e.store_id)).filter((e=>e));return c.filter((e=>!a.includes(e.id.toString())))};return(0,l.jsxs)("div",{className:"admin-product-create animate-page",children:[(0,l.jsx)("h2",{className:"centered-heading",children:"\u0421\u0442\u0432\u043e\u0440\u0438\u0442\u0438 \u043d\u043e\u0432\u0438\u0439 \u0442\u043e\u0432\u0430\u0440"}),(0,l.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),b(!0),f(null),v(null),!u.category_id||!u.brand_id||!u.name)return f("\u0417\u0430\u043f\u043e\u0432\u043d\u0456\u0442\u044c \u043e\u0431\u043e\u0432\u2019\u044f\u0437\u043a\u043e\u0432\u0456 \u043f\u043e\u043b\u044f: \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u044f, \u0431\u0440\u0435\u043d\u0434, \u043d\u0430\u0437\u0432\u0430"),void b(!1);const a=localStorage.getItem("token"),t=new FormData;t.append("category_id",u.category_id),t.append("brand_id",u.brand_id),t.append("name",u.name),t.append("volume",u.volume),t.append("code",u.code),t.append("description",u.description),t.append("description_full",u.description_full),t.append("composition",u.composition),t.append("usage",u.usage);const s=u.features.reduce(((e,a)=>(a.key&&a.value&&(e[a.key]=a.value),e)),{});t.append("features",JSON.stringify(s));const n=u.store_prices.filter((e=>e.store_id&&e.price&&!isNaN(parseFloat(e.price))));t.append("store_prices",JSON.stringify(n)),u.images.forEach((e=>{e&&t.append("images",e)}));try{await i.A.post("".concat(r.H,"/admin/product"),t,{headers:{Authorization:"Bearer ".concat(a),"Content-Type":"multipart/form-data"}}),v("\u0422\u043e\u0432\u0430\u0440 \u0443\u0441\u043f\u0456\u0448\u043d\u043e \u0441\u0442\u0432\u043e\u0440\u0435\u043d\u043e!"),p({category_id:"",brand_id:"",name:"",volume:"",images:[null],code:"",features:[{key:"",value:""}],description:"",description_full:"",composition:"",usage:"",store_prices:[{store_id:"",price:"",link:""}]}),g(null)}catch(c){var l,o;console.error("\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u0441\u0442\u0432\u043e\u0440\u0435\u043d\u043d\u044f \u0442\u043e\u0432\u0430\u0440\u0443:",{message:c.message,response:c.response?c.response.data:"No response data"}),f((null===(l=c.response)||void 0===l||null===(o=l.data)||void 0===o?void 0:o.error)||"\u041d\u0435 \u0432\u0434\u0430\u043b\u043e\u0441\u044f \u0441\u0442\u0432\u043e\u0440\u0438\u0442\u0438 \u0442\u043e\u0432\u0430\u0440. \u041f\u0435\u0440\u0435\u0432\u0456\u0440\u0442\u0435 \u0434\u0430\u043d\u0456 \u0430\u0431\u043e \u043f\u0456\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044f \u0434\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430.")}finally{b(!1)}},children:[(0,l.jsxs)("div",{className:"form-group animate-field",children:[(0,l.jsx)("label",{children:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u044f"}),(0,l.jsxs)("select",{name:"category_id",value:u.category_id,onChange:e=>y(e),required:!0,children:[(0,l.jsx)("option",{value:"",children:"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044c \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u044e"}),e.map((e=>(0,l.jsx)("option",{value:e.id,children:e.name_ua},e.id)))]})]}),(0,l.jsxs)("div",{className:"form-group animate-field",children:[(0,l.jsx)("label",{children:"\u0411\u0440\u0435\u043d\u0434"}),(0,l.jsxs)("select",{name:"brand_id",value:u.brand_id,onChange:e=>y(e),required:!0,children:[(0,l.jsx)("option",{value:"",children:"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044c \u0431\u0440\u0435\u043d\u0434"}),t.map((e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,l.jsxs)("div",{className:"form-group animate-field",children:[(0,l.jsx)("label",{children:"\u041d\u0430\u0437\u0432\u0430"}),(0,l.jsx)("input",{type:"text",name:"name",value:u.name,onChange:e=>y(e),required:!0})]}),u.images.map(((e,a)=>(0,l.jsxs)("div",{className:"form-group animate-field image-group",children:[(0,l.jsxs)("label",{children:["\u0417\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u043d\u044f ",a+1]}),(0,l.jsxs)("div",{className:"input-with-button",children:[(0,l.jsx)("input",{type:"file",accept:"image/*",onChange:e=>y(e,a,"image","image")}),(0,l.jsxs)("div",{className:"button-group",children:[a===u.images.length-1&&u.images.length<10&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{type:"button",className:"add-button",onClick:_,children:"+"}),u.images.length>1&&(0,l.jsx)("button",{type:"button",className:"remove-button",onClick:()=>k(a),children:"-"})]}),a!==u.images.length-1&&(0,l.jsx)("button",{type:"button",className:"remove-button",onClick:()=>k(a),children:"-"})]})]})]},a))),m&&(0,l.jsxs)("div",{className:"form-group animate-field image-preview",children:[(0,l.jsx)("label",{children:"\u0412\u0438\u0433\u043b\u044f\u0434 \u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u043d\u044f"}),(0,l.jsx)("img",{src:URL.createObjectURL(m),alt:"Preview"})]}),(0,l.jsxs)("div",{className:"form-group animate-field",children:[(0,l.jsx)("label",{children:"\u041e\u0431\u2019\u0454\u043c"}),(0,l.jsx)("input",{type:"text",name:"volume",value:u.volume,onChange:e=>y(e)})]}),(0,l.jsxs)("div",{className:"form-group animate-field",children:[(0,l.jsx)("label",{children:"\u041a\u043e\u0434"}),(0,l.jsx)("input",{type:"text",name:"code",value:u.code,onChange:e=>y(e)})]}),(0,l.jsx)("h3",{children:"\u0425\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438"}),u.features.map(((e,a)=>(0,l.jsx)("div",{className:"form-group feature-group animate-field",children:(0,l.jsxs)("div",{className:"input-with-button",children:[(0,l.jsxs)("select",{value:e.key,onChange:e=>y(e,a,"key","feature"),children:[(0,l.jsx)("option",{value:"",children:"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044c \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0443"}),F(a).map((e=>(0,l.jsx)("option",{value:e.key,children:e.label},e.key)))]}),(0,l.jsx)("input",{type:"text",value:e.value,onChange:e=>y(e,a,"value","feature"),placeholder:"\u0417\u043d\u0430\u0447\u0435\u043d\u043d\u044f"}),(0,l.jsxs)("div",{className:"button-group",children:[a===u.features.length-1&&u.features.length<10&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{type:"button",className:"add-button",onClick:N,children:"+"}),u.features.length>1&&(0,l.jsx)("button",{type:"button",className:"remove-button",onClick:()=>C(a),children:"-"})]}),a!==u.features.length-1&&(0,l.jsx)("button",{type:"button",className:"remove-button",onClick:()=>C(a),children:"-"})]})]})},a))),(0,l.jsxs)("div",{className:"form-group animate-field",children:[(0,l.jsx)("label",{children:"\u041a\u043e\u0440\u043e\u0442\u043a\u0438\u0439 \u043e\u043f\u0438\u0441"}),(0,l.jsx)("textarea",{name:"description",value:u.description,onChange:e=>y(e)})]}),(0,l.jsxs)("div",{className:"form-group animate-field",children:[(0,l.jsx)("label",{children:"\u041f\u043e\u0432\u043d\u0438\u0439 \u043e\u043f\u0438\u0441"}),(0,l.jsx)("textarea",{name:"description_full",value:u.description_full,onChange:e=>y(e)})]}),(0,l.jsxs)("div",{className:"form-group animate-field",children:[(0,l.jsx)("label",{children:"\u0421\u043a\u043b\u0430\u0434"}),(0,l.jsx)("textarea",{name:"composition",value:u.composition,onChange:e=>y(e)})]}),(0,l.jsxs)("div",{className:"form-group animate-field",children:[(0,l.jsx)("label",{children:"\u0412\u0438\u043a\u043e\u0440\u0438\u0441\u0442\u0430\u043d\u043d\u044f"}),(0,l.jsx)("textarea",{name:"usage",value:u.usage,onChange:e=>y(e)})]}),(0,l.jsx)("h3",{children:"\u0426\u0456\u043d\u0438 \u0432 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0430\u0445"}),u.store_prices.map(((e,a)=>(0,l.jsx)("div",{className:"form-group store-price-group animate-field",children:(0,l.jsxs)("div",{className:"input-with-button",children:[(0,l.jsxs)("select",{value:e.store_id,onChange:e=>y(e,a,"store_id","store_price"),children:[(0,l.jsx)("option",{value:"",children:"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044c \u043c\u0430\u0433\u0430\u0437\u0438\u043d"}),H(a).map((e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id)))]}),(0,l.jsx)("input",{type:"number",value:e.price,onChange:e=>y(e,a,"price","store_price"),placeholder:"\u0426\u0456\u043d\u0430",min:"0",step:"0.01"}),(0,l.jsx)("input",{type:"text",value:e.link,onChange:e=>y(e,a,"link","store_price"),placeholder:"\u041f\u043e\u0441\u0438\u043b\u0430\u043d\u043d\u044f"}),(0,l.jsxs)("div",{className:"button-group",children:[a===u.store_prices.length-1&&u.store_prices.length<10&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{type:"button",className:"add-button",onClick:A,children:"+"}),u.store_prices.length>1&&(0,l.jsx)("button",{type:"button",className:"remove-button",onClick:()=>S(a),children:"-"})]}),a!==u.store_prices.length-1&&(0,l.jsx)("button",{type:"button",className:"remove-button",onClick:()=>S(a),children:"-"})]})]})},a))),h&&(0,l.jsx)("div",{className:"error-message centered-message",children:h}),x&&(0,l.jsx)("div",{className:"success-message centered-message",children:x}),(0,l.jsx)("button",{type:"submit",className:"save-button animate-field",disabled:j,children:j?"\u0417\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043d\u044f...":"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438"})]})]})}}}]);
//# sourceMappingURL=47.d7cfae99.chunk.js.map