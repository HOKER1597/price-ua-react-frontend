"use strict";(self.webpackChunkprice_ua=self.webpackChunkprice_ua||[]).push([[244],{122:e=>{e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,o,i;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(o=n;0!==o--;)if(!e(t[o],r[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(i=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(o=n;0!==o--;)if(!Object.prototype.hasOwnProperty.call(r,i[o]))return!1;for(o=n;0!==o--;){var s=i[o];if(!e(t[s],r[s]))return!1}return!0}return t!==t&&r!==r}},1244:(e,t,r)=>{r.r(t),r.d(t,{default:()=>z});var n=r(2555),o=r(5043),i=r(9002),s=r(9722),a=r(2027),c=r(122);const d="undefined"!==typeof window?o.useLayoutEffect:o.useEffect;function l(e,t,r){const[n,i]=(0,o.useState)((()=>t(e))),s=(0,o.useCallback)((()=>{const o=t(e);c(n,o)||(i(o),r&&r())}),[n,e,r]);return d(s),[n,s]}function u(e,t,r){return function(e,t,r){const[n,o]=l(e,t,r);return d((function(){const t=e.getHandlerId();if(null!=t)return e.subscribeToStateChange(o,{handlerIds:[t]})}),[e,o]),n}(t,e||(()=>({})),(()=>r.reconnect()))}function g(e,t){const r=[...t||[]];return null==t&&"function"!==typeof e&&r.push(e),(0,o.useMemo)((()=>"function"===typeof e?e():e),r)}function h(e){return(0,o.useMemo)((()=>e.hooks.dragSource()),[e])}function p(e){return(0,o.useMemo)((()=>e.hooks.dragPreview()),[e])}function f(e,t,r,n){let o=r?r.call(n,e,t):void 0;if(void 0!==o)return!!o;if(e===t)return!0;if("object"!==typeof e||!e||"object"!==typeof t||!t)return!1;const i=Object.keys(e),s=Object.keys(t);if(i.length!==s.length)return!1;const a=Object.prototype.hasOwnProperty.bind(t);for(let c=0;c<i.length;c++){const s=i[c];if(!a(s))return!1;const d=e[s],l=t[s];if(o=r?r.call(n,d,l,s):void 0,!1===o||void 0===o&&d!==l)return!1}return!0}function m(e){return null!==e&&"object"===typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function v(e){return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!(0,o.isValidElement)(t)){const n=t;return e(n,r),n}const n=t;!function(e){if("string"===typeof e.type)return;const t=e.type.displayName||e.type.name||"the component";throw new Error("Only native element nodes can now be passed to React DnD connectors."+"You can either wrap ".concat(t," into a <div>, or turn it into a ")+"drag source or a drop target itself.")}(n);return function(e,t){const r=e.ref;return(0,a.V)("string"!==typeof r,"Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),r?(0,o.cloneElement)(e,{ref:e=>{w(r,e),w(t,e)}}):(0,o.cloneElement)(e,{ref:t})}(n,r?t=>e(t,r):e)}}function y(e){const t={};return Object.keys(e).forEach((r=>{const n=e[r];if(r.endsWith("Ref"))t[r]=e[r];else{const e=v(n);t[r]=()=>e}})),t}function w(e,t){"function"===typeof e?e(t):e.current=t}class D{receiveHandlerId(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(e){this.dragSourceOptionsInternal=e}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(e){this.dragPreviewOptionsInternal=e}reconnect(){const e=this.reconnectDragSource();this.reconnectDragPreview(e)}reconnectDragSource(){const e=this.dragSource,t=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return t&&this.disconnectDragSource(),this.handlerId?e?(t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)),t):(this.lastConnectedDragSource=e,t):t}reconnectDragPreview(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.dragPreview,r=e||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();r&&this.disconnectDragPreview(),this.handlerId&&(t?r&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=t,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,t,this.dragPreviewOptions)):this.lastConnectedDragPreview=t)}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!f(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!f(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(e){this.hooks=y({dragSource:(e,t)=>{this.clearDragSource(),this.dragSourceOptions=t||null,m(e)?this.dragSourceRef=e:this.dragSourceNode=e,this.reconnectDragSource()},dragPreview:(e,t)=>{this.clearDragPreview(),this.dragPreviewOptions=t||null,m(e)?this.dragPreviewRef=e:this.dragPreviewNode=e,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}}var I=r(5389);function x(){const{dragDropManager:e}=(0,o.useContext)(I.M);return(0,a.V)(null!=e,"Expected drag drop context"),e}let b=!1,j=!1;class S{receiveHandlerId(e){this.sourceId=e}getHandlerId(){return this.sourceId}canDrag(){(0,a.V)(!b,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return b=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{b=!1}}isDragging(){if(!this.sourceId)return!1;(0,a.V)(!j,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return j=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{j=!1}}subscribeToStateChange(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}isDraggingSource(e){return this.internalMonitor.isDraggingSource(e)}isOverTarget(e,t){return this.internalMonitor.isOverTarget(e,t)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(e){return this.internalMonitor.subscribeToOffsetChange(e)}canDragSource(e){return this.internalMonitor.canDragSource(e)}canDropOnTarget(e){return this.internalMonitor.canDropOnTarget(e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.sourceId=null,this.internalMonitor=e.getMonitor()}}class C{beginDrag(){const e=this.spec,t=this.monitor;let r=null;return r="object"===typeof e.item?e.item:"function"===typeof e.item?e.item(t):{},null!==r&&void 0!==r?r:null}canDrag(){const e=this.spec,t=this.monitor;return"boolean"===typeof e.canDrag?e.canDrag:"function"!==typeof e.canDrag||e.canDrag(t)}isDragging(e,t){const r=this.spec,n=this.monitor,{isDragging:o}=r;return o?o(n):t===e.getSourceId()}endDrag(){const e=this.spec,t=this.monitor,r=this.connector,{end:n}=e;n&&n(t.getItem(),t),r.reconnect()}constructor(e,t,r){this.spec=e,this.monitor=t,this.connector=r}}function O(e,t,r){const n=x(),i=function(e,t,r){const n=(0,o.useMemo)((()=>new C(e,t,r)),[t,r]);return(0,o.useEffect)((()=>{n.spec=e}),[e]),n}(e,t,r),s=function(e){return(0,o.useMemo)((()=>{const t=e.type;return(0,a.V)(null!=t,"spec.type must be defined"),t}),[e])}(e);d((function(){if(null!=s){const[e,o]=function(e,t,r){const n=r.getRegistry(),o=n.addSource(e,t);return[o,()=>n.removeSource(o)]}(s,i,n);return t.receiveHandlerId(e),r.receiveHandlerId(e),o}}),[n,t,r,i,s])}function P(e,t){const r=g(e,t);(0,a.V)(!r.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const n=function(){const e=x();return(0,o.useMemo)((()=>new S(e)),[e])}(),i=function(e,t){const r=x(),n=(0,o.useMemo)((()=>new D(r.getBackend())),[r]);return d((()=>(n.dragSourceOptions=e||null,n.reconnect(),()=>n.disconnectDragSource())),[n,e]),d((()=>(n.dragPreviewOptions=t||null,n.reconnect(),()=>n.disconnectDragPreview())),[n,t]),n}(r.options,r.previewOptions);return O(r,n,i),[u(r.collect,n,i),h(i),p(i)]}function N(e){return(0,o.useMemo)((()=>e.hooks.dropTarget()),[e])}class k{get connectTarget(){return this.dropTarget}reconnect(){const e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();const t=this.dropTarget;this.handlerId&&(t?e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=t,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,t,this.dropTargetOptions)):this.lastConnectedDropTarget=t)}receiveHandlerId(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(e){this.dropTargetOptionsInternal=e}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!f(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(e){this.hooks=y({dropTarget:(e,t)=>{this.clearDropTarget(),this.dropTargetOptions=t,m(e)?this.dropTargetRef=e:this.dropTargetNode=e,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=e}}let T=!1;class M{receiveHandlerId(e){this.targetId=e}getHandlerId(){return this.targetId}subscribeToStateChange(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}canDrop(){if(!this.targetId)return!1;(0,a.V)(!T,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return T=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{T=!1}}isOver(e){return!!this.targetId&&this.internalMonitor.isOverTarget(this.targetId,e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.targetId=null,this.internalMonitor=e.getMonitor()}}class H{canDrop(){const e=this.spec,t=this.monitor;return!e.canDrop||e.canDrop(t.getItem(),t)}hover(){const e=this.spec,t=this.monitor;e.hover&&e.hover(t.getItem(),t)}drop(){const e=this.spec,t=this.monitor;if(e.drop)return e.drop(t.getItem(),t)}constructor(e,t){this.spec=e,this.monitor=t}}function A(e,t,r){const n=x(),i=function(e,t){const r=(0,o.useMemo)((()=>new H(e,t)),[t]);return(0,o.useEffect)((()=>{r.spec=e}),[e]),r}(e,t),s=function(e){const{accept:t}=e;return(0,o.useMemo)((()=>((0,a.V)(null!=e.accept,"accept must be defined"),Array.isArray(t)?t:[t])),[t])}(e);d((function(){const[e,o]=function(e,t,r){const n=r.getRegistry(),o=n.addTarget(e,t);return[o,()=>n.removeTarget(o)]}(s,i,n);return t.receiveHandlerId(e),r.receiveHandlerId(e),o}),[n,t,i,r,s.map((e=>e.toString())).join("|")])}function R(e,t){const r=g(e,t),n=function(){const e=x();return(0,o.useMemo)((()=>new M(e)),[e])}(),i=function(e){const t=x(),r=(0,o.useMemo)((()=>new k(t.getBackend())),[t]);return d((()=>(r.dropTargetOptions=e||null,r.reconnect(),()=>r.disconnectDropTarget())),[e]),r}(r.options);return A(r,n,i),[u(r.collect,n,i),N(i)]}var E=r(9688),_=(r(9409),r(579));const B="product";function V(e){let{product:t,savedProductIds:r,toggleSavedProduct:n,getProductName:o,getMinPrice:s,setDraggedProductId:a}=e;const[{isDragging:c},d]=P((()=>({type:B,item:{productId:t.id},end:()=>a(null),collect:e=>({isDragging:!!e.isDragging()})})));return(0,_.jsx)("div",{ref:d,className:"product-card-container",style:{opacity:c?.5:1},onDragStart:()=>{console.log("Drag started, productId:",t.id),a(t.id)},children:(0,_.jsxs)(i.N_,{to:"/product/".concat(t.id),className:"product-card",children:[(0,_.jsx)("h3",{children:o(t)}),(0,_.jsxs)("div",{className:"image-container",children:[(0,_.jsx)("img",{src:t.images&&t.images.length>0?t.images[0]:"/img/placeholder.webp",alt:t.name,onError:e=>e.target.src="/img/placeholder.webp"}),(0,_.jsx)("div",{className:"wishlist-heart ".concat(r.includes(t.id)?"saved":""),onClick:e=>{e.preventDefault(),n(t.id)},children:(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:r.includes(t.id)?"#ff0000":"none",stroke:"#ff0000",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,_.jsx)("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})})]}),(0,_.jsx)("p",{className:"price",children:s(t.store_prices)}),(0,_.jsx)("p",{children:t.description||"\u041e\u043f\u0438\u0441 \u0432\u0456\u0434\u0441\u0443\u0442\u043d\u0456\u0439"})]})})}function L(e){let{category:t,editingCategoryId:r,editedCategoryName:n,setEditedCategoryName:o,handleUpdateCategory:i,startEditingCategory:s,openDeleteModal:a,draggedProductId:c,moveProductToCategory:d,products:l,savedProductIds:u,toggleSavedProduct:g,getProductName:h,getMinPrice:p,setDraggedProductId:f}=e;const[{isOver:m},v]=R((()=>({accept:B,drop:e=>d(e.productId,t.id),collect:e=>({isOver:!!e.isOver()})}))),y=l.filter((e=>e.saved_category_id===t.id));return(0,_.jsxs)("div",{className:"category-section",children:[(0,_.jsx)("div",{className:"category-header",children:r===t.id?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("input",{type:"text",value:n,onChange:e=>o(e.target.value),className:"category-edit-input"}),(0,_.jsxs)("div",{className:"category-buttons",children:[(0,_.jsx)("button",{className:"confirm-edit-btn",onClick:()=>i(t.id),children:(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#008000",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,_.jsx)("path",{d:"M20 6L9 17l-5-5"})})}),(0,_.jsx)("button",{className:"edit-category-btn",onClick:()=>s(t),children:(0,_.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#333",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,_.jsx)("path",{d:"M20 14.66V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h5.34"}),(0,_.jsx)("polygon",{points:"18 2 22 6 12 16 8 16 8 12 18 2"})]})}),(0,_.jsx)("button",{className:"delete-category-btn",onClick:()=>a(t),children:(0,_.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#333",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,_.jsx)("path",{d:"M3 6h18"}),(0,_.jsx)("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),(0,_.jsx)("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),(0,_.jsx)("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),(0,_.jsx)("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]})})]})]}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("h3",{children:t.name}),(0,_.jsxs)("div",{className:"category-buttons",children:[(0,_.jsx)("button",{className:"edit-category-btn",onClick:()=>s(t),children:(0,_.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#333",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,_.jsx)("path",{d:"M20 14.66V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h5.34"}),(0,_.jsx)("polygon",{points:"18 2 22 6 12 16 8 16 8 12 18 2"})]})}),(0,_.jsx)("button",{className:"delete-category-btn",onClick:()=>a(t),children:(0,_.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#333",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,_.jsx)("path",{d:"M3 6h18"}),(0,_.jsx)("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),(0,_.jsx)("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),(0,_.jsx)("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),(0,_.jsx)("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]})})]})]})}),(0,_.jsx)("div",{className:"drop-container",children:(0,_.jsxs)("div",{className:"category-products products-list loaded",children:[y.length>0?y.map((e=>(0,_.jsx)(V,{product:e,savedProductIds:u,toggleSavedProduct:g,getProductName:h,getMinPrice:p,setDraggedProductId:f},e.id))):(0,_.jsx)("p",{className:"no-products-text",children:"\u041d\u0435\u043c\u0430\u0454 \u0442\u043e\u0432\u0430\u0440\u0456\u0432 \u0443 \u0446\u0456\u0439 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u0457"}),c&&(0,_.jsx)("div",{ref:v,className:"placeholder-card ".concat(m?"drop-target":""),children:(0,_.jsx)("span",{className:"plus-icon",children:"+"})})]})})]})}const z=function(){const[e,t]=(0,o.useState)([]),[r,a]=(0,o.useState)([]),[c,d]=(0,o.useState)(!0),[u,g]=(0,o.useState)(null),[h,p]=(0,o.useState)(null),[f,m]=(0,o.useState)([]),[v,y]=(0,o.useState)(""),[w,D]=(0,o.useState)(!1),[I,b]=(0,o.useState)(null),[j,S]=(0,o.useState)(""),[C,O]=(0,o.useState)(null),[P,N]=(0,o.useState)(!1),[k,T]=(0,o.useState)(!1),[M,H]=(0,o.useState)(null),A=(0,i.Zp)(),{clientOffset:z,isDragging:U}=function(e){const t=x().getMonitor(),[r,n]=l(t,e);return(0,o.useEffect)((()=>t.subscribeToOffsetChange(n))),(0,o.useEffect)((()=>t.subscribeToStateChange(n))),r}((e=>({clientOffset:e.getClientOffset(),isDragging:e.isDragging()})));(0,o.useEffect)((()=>{if(!U||!z)return;let e=null;return e=setInterval((()=>{const e=z.y,t=window.innerHeight;e<200?(console.log("Scrolling up, y:",e),window.scrollBy(0,-10)):e>t-200&&(console.log("Scrolling down, y:",e),window.scrollBy(0,10))}),16),()=>{e&&(console.log("Stopping auto-scroll"),clearInterval(e))}}),[z,U]);const F=e=>"".concat(e.name," (").concat(e.volume||"\u041e\u0431\u2019\u0454\u043c \u043d\u0435 \u0432\u043a\u0430\u0437\u0430\u043d\u043e",")"),W=e=>e&&0!==e.length?"".concat(Math.min(...e.map((e=>e.price)))," \u0433\u0440\u043d"):"\u041d\u0435\u043c\u0430\u0454 \u0432 \u043d\u0430\u044f\u0432\u043d\u043e\u0441\u0442\u0456",[{isOver:Y},Z]=R((()=>({accept:B,drop:e=>X(e.productId,null),collect:e=>({isOver:!!e.isOver()})})));(0,o.useEffect)((()=>{let e=!1;return(async()=>{const r=localStorage.getItem("token");if(!r)return void A("/login");d(!0);const o={Authorization:"Bearer ".concat(r)},[i,c]=await Promise.allSettled([s.A.get("".concat(E.H,"/categories"),{headers:o}),s.A.get("".concat(E.H,"/saved-products"),{headers:o})]);if(!e){var l,u;if("fulfilled"===i.status)m(i.value.data||[]);else if(console.error("Error fetching categories:",i.reason),p("\u041d\u0435 \u0432\u0434\u0430\u043b\u043e\u0441\u044f \u0437\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0438\u0442\u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u0457"),[401,403].includes(null===(l=i.reason)||void 0===l||null===(u=l.response)||void 0===u?void 0:u.status))return void A("/login");if("fulfilled"===c.status){const r=c.value.data.savedProducts||[],o=r.map((e=>e.product_id));if(a(o),0===o.length)t([]);else{const i=await Promise.allSettled(o.map((e=>s.A.get("".concat(E.H,"/products/").concat(e)))));if(e)return;const a=i.filter((e=>"fulfilled"===e.status)).map((e=>{var t;return(0,n.A)((0,n.A)({},e.value.data),{},{saved_category_id:(null===(t=r.find((t=>t.product_id===e.value.data.id)))||void 0===t?void 0:t.saved_category_id)||null})}));t(a)}}else{var h,f;if(console.error("Error fetching wishlist:",c.reason),g("\u041d\u0435 \u0432\u0434\u0430\u043b\u043e\u0441\u044f \u0437\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0438\u0442\u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u0431\u0430\u0436\u0430\u043d\u043e\u0433\u043e"),[401,403].includes(null===(h=c.reason)||void 0===h||null===(f=h.response)||void 0===f?void 0:f.status))return void A("/login")}e||d(!1)}})(),()=>{e=!0}}),[A]);const q=async n=>{const o=localStorage.getItem("token");if(o)try{await s.A.delete("".concat(E.H,"/saved-products/").concat(n),{headers:{Authorization:"Bearer ".concat(o)}}),a(r.filter((e=>e!==n))),t(e.filter((e=>e.id!==n)))}catch(i){console.error("Error removing product from wishlist:",i),g("\u041d\u0435 \u0432\u0434\u0430\u043b\u043e\u0441\u044f \u0432\u0438\u0434\u0430\u043b\u0438\u0442\u0438 \u0442\u043e\u0432\u0430\u0440 \u0456\u0437 \u0431\u0430\u0436\u0430\u043d\u043e\u0433\u043e")}else A("/login")},G=e=>{b(e.id),S(e.name)},J=async e=>{const t=localStorage.getItem("token");if(!t||!j.trim())return void p("\u0412\u0432\u0435\u0434\u0456\u0442\u044c \u043d\u0430\u0437\u0432\u0443 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u0457");const r=[...f],o=f.map((t=>t.id===e?(0,n.A)((0,n.A)({},t),{},{name:j.trim()}):t));m(o),b(null),S(""),p(null);try{await s.A.put("".concat(E.H,"/categories/").concat(e),{name:j.trim()},{headers:{Authorization:"Bearer ".concat(t)}})}catch(i){console.error("Error updating category:",i),p("\u041d\u0435 \u0432\u0434\u0430\u043b\u043e\u0441\u044f \u043e\u043d\u043e\u0432\u0438\u0442\u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u044e"),m(r)}},K=t=>{O(t);e.filter((e=>e.saved_category_id===t.id)).length>0?T(!0):N(!0)},Q=()=>{O(null),N(!1),T(!1),p(null)},X=async(r,o)=>{const i=localStorage.getItem("token");if(!i)return void A("/login");const a=[...e];t((e=>e.map((e=>e.id===r?(0,n.A)((0,n.A)({},e),{},{saved_category_id:o}):e)))),H(null);try{await s.A.patch("".concat(E.H,"/saved-products/").concat(r),{saved_category_id:o},{headers:{Authorization:"Bearer ".concat(i)}})}catch(c){console.error("Error moving product to category:",c),p("\u041d\u0435 \u0432\u0434\u0430\u043b\u043e\u0441\u044f \u043f\u0435\u0440\u0435\u043c\u0456\u0441\u0442\u0438\u0442\u0438 \u0442\u043e\u0432\u0430\u0440 \u0434\u043e \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u0457"),t(a),H(null)}},$=e.filter((e=>!e.saved_category_id));return(0,_.jsxs)("div",{className:"wishlist",children:[(0,_.jsxs)("div",{className:"wishlist-header",children:[(0,_.jsx)("h2",{children:"\u0421\u043f\u0438\u0441\u043e\u043a \u0431\u0430\u0436\u0430\u043d\u043e\u0433\u043e"}),(0,_.jsx)("button",{className:"add-category-btn",onClick:()=>D(!0),children:"\u0414\u043e\u0434\u0430\u0442\u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u044e"})]}),c&&(0,_.jsx)("div",{className:"loading-overlay",children:(0,_.jsxs)("div",{className:"spinner-container",children:[(0,_.jsx)("div",{className:"spinner"}),(0,_.jsx)("p",{children:"\u0417\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0435\u043d\u043d\u044f..."})]})}),u&&!e.length&&(0,_.jsx)("div",{className:"wishlist-error",children:u}),h&&(0,_.jsx)("div",{className:"wishlist-error",children:h}),!c&&0===e.length&&!u&&(0,_.jsxs)("div",{className:"wishlist-empty",children:[(0,_.jsx)("h2",{children:"\u0412\u0430\u0448 \u0441\u043f\u0438\u0441\u043e\u043a \u0431\u0430\u0436\u0430\u043d\u043e\u0433\u043e \u043f\u043e\u0440\u043e\u0436\u043d\u0456\u0439"}),(0,_.jsx)("p",{children:"\u0414\u043e\u0434\u0430\u0439\u0442\u0435 \u0442\u043e\u0432\u0430\u0440\u0438 \u0434\u043e \u0441\u043f\u0438\u0441\u043a\u0443 \u0431\u0430\u0436\u0430\u043d\u043e\u0433\u043e, \u0449\u043e\u0431 \u043f\u043e\u0431\u0430\u0447\u0438\u0442\u0438 \u0457\u0445 \u0442\u0443\u0442."})]}),!c&&$.length>0&&(0,_.jsxs)("div",{className:"wishlist-products products-list loaded",children:[$.map((e=>(0,_.jsx)(V,{product:e,savedProductIds:r,toggleSavedProduct:q,getProductName:F,getMinPrice:W,setDraggedProductId:H},e.id))),M&&(0,_.jsx)("div",{ref:Z,className:"placeholder-card ".concat(Y?"drop-target":""),children:(0,_.jsx)("span",{className:"plus-icon",children:"+"})})]}),!c&&f.length>0&&(0,_.jsx)("div",{className:"category-sections",children:f.map((t=>(0,_.jsx)(L,{category:t,editingCategoryId:I,editedCategoryName:j,setEditedCategoryName:S,handleUpdateCategory:J,startEditingCategory:G,openDeleteModal:K,draggedProductId:M,moveProductToCategory:X,products:e,savedProductIds:r,toggleSavedProduct:q,getProductName:F,getMinPrice:W,setDraggedProductId:H},t.id)))}),w&&(0,_.jsx)("div",{className:"modal-overlay",children:(0,_.jsxs)("div",{className:"modal",children:[(0,_.jsx)("label",{htmlFor:"category-name",children:"\u041d\u0430\u0437\u0432\u0430 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u0457:"}),(0,_.jsx)("input",{id:"category-name",type:"text",value:v,onChange:e=>y(e.target.value),placeholder:"\u0412\u0432\u0435\u0434\u0456\u0442\u044c \u043d\u0430\u0437\u0432\u0443 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u0457"}),h&&(0,_.jsx)("div",{className:"modal-error",children:h}),(0,_.jsxs)("div",{className:"modal-buttons",children:[(0,_.jsx)("button",{className:"wishlist-modal-add-btn",onClick:async()=>{const e=localStorage.getItem("token");if(e&&v.trim())try{const t=await s.A.post("".concat(E.H,"/categories"),{name:v.trim()},{headers:{Authorization:"Bearer ".concat(e)}});m([...f,t.data]),y(""),D(!1),p(null)}catch(t){console.error("Error adding category:",t),p("\u041d\u0435 \u0432\u0434\u0430\u043b\u043e\u0441\u044f \u0434\u043e\u0434\u0430\u0442\u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u044e")}else p("\u0412\u0432\u0435\u0434\u0456\u0442\u044c \u043d\u0430\u0437\u0432\u0443 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u0457")},children:"\u0414\u043e\u0434\u0430\u0442\u0438"}),(0,_.jsx)("button",{className:"wishlist-modal-cancel-btn",onClick:()=>{y(""),D(!1),p(null)},children:"\u0421\u043a\u0430\u0441\u0443\u0432\u0430\u0442\u0438"})]})]})}),P&&(0,_.jsx)("div",{className:"modal-overlay",children:(0,_.jsxs)("div",{className:"delete-modal",children:[(0,_.jsx)("p",{children:"\u0412\u0438 \u0442\u043e\u0447\u043d\u043e \u0445\u043e\u0447\u0435\u0442\u0435 \u0432\u0438\u0434\u0430\u043b\u0438\u0442\u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u044e?"}),h&&(0,_.jsx)("div",{className:"modal-error",children:h}),(0,_.jsxs)("div",{className:"modal-buttons",children:[(0,_.jsx)("button",{className:"wishlist-modal-confirm-delete-btn",onClick:async()=>{const e=localStorage.getItem("token");if(!e||!C)return p("\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u0432\u0438\u0434\u0430\u043b\u0435\u043d\u043d\u044f \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u0457"),void Q();const t=[...f];m(f.filter((e=>e.id!==C.id))),Q();try{await s.A.delete("".concat(E.H,"/categories/").concat(C.id),{headers:{Authorization:"Bearer ".concat(e)}}),console.log("Empty category deleted:",C.id)}catch(r){console.error("Error deleting category:",r),p("\u041d\u0435 \u0432\u0434\u0430\u043b\u043e\u0441\u044f \u0432\u0438\u0434\u0430\u043b\u0438\u0442\u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u044e"),m(t)}},children:"\u0422\u0430\u043a"}),(0,_.jsx)("button",{className:"wishlist-modal-cancel-btn",onClick:Q,children:"\u041d\u0456"})]})]})}),k&&(0,_.jsx)("div",{className:"modal-overlay",children:(0,_.jsxs)("div",{className:"delete-with-products-modal",children:[(0,_.jsx)("p",{children:"\u0423 \u0446\u0456\u0439 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u0457 \u0454 \u0442\u043e\u0432\u0430\u0440\u0438, \u0445\u043e\u0447\u0435\u0442\u0435 \u0457\u0445 \u0437\u0431\u0435\u0440\u0435\u0433\u0442\u0438?"}),h&&(0,_.jsx)("div",{className:"modal-error",children:h}),(0,_.jsxs)("div",{className:"modal-buttons",children:[(0,_.jsx)("button",{className:"wishlist-modal-add-btn",onClick:async()=>{const r=localStorage.getItem("token");if(!r||!C)return p("\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u0432\u0438\u0434\u0430\u043b\u0435\u043d\u043d\u044f \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u0457"),void Q();const o=[...f],i=[...e];m(f.filter((e=>e.id!==C.id))),t(e.map((e=>e.saved_category_id===C.id?(0,n.A)((0,n.A)({},e),{},{saved_category_id:null}):e))),Q();try{const e=i.filter((e=>e.saved_category_id===C.id));await Promise.all(e.map((e=>s.A.patch("".concat(E.H,"/saved-products/").concat(e.id),{saved_category_id:null},{headers:{Authorization:"Bearer ".concat(r)}})))),await s.A.delete("".concat(E.H,"/categories/").concat(C.id),{headers:{Authorization:"Bearer ".concat(r)}}),console.log("Category deleted, products moved to uncategorized:",C.id)}catch(a){console.error("Error deleting category or moving products:",a),p("\u041d\u0435 \u0432\u0434\u0430\u043b\u043e\u0441\u044f \u0432\u0438\u0434\u0430\u043b\u0438\u0442\u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u044e \u0430\u0431\u043e \u043f\u0435\u0440\u0435\u043c\u0456\u0441\u0442\u0438\u0442\u0438 \u0442\u043e\u0432\u0430\u0440\u0438"),m(o),t(i)}},children:"\u0422\u0430\u043a, \u0437\u0431\u0435\u0440\u0435\u0433\u0442\u0438"}),(0,_.jsx)("button",{className:"wishlist-modal-delete-btn",onClick:async()=>{const n=localStorage.getItem("token");if(!n||!C)return p("\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u0432\u0438\u0434\u0430\u043b\u0435\u043d\u043d\u044f \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u0457"),void Q();const o=[...f],i=[...e],c=[...r],d=e.filter((e=>e.saved_category_id===C.id)).map((e=>e.id));m(f.filter((e=>e.id!==C.id))),t(e.filter((e=>!d.includes(e.id)))),a(r.filter((e=>!d.includes(e)))),Q();try{await Promise.all(d.map((e=>s.A.delete("".concat(E.H,"/saved-products/").concat(e),{headers:{Authorization:"Bearer ".concat(n)}})))),await s.A.delete("".concat(E.H,"/categories/").concat(C.id),{headers:{Authorization:"Bearer ".concat(n)}}),console.log("Category and products deleted:",{categoryId:C.id,productIds:d})}catch(l){console.error("Error deleting category or products:",l),p("\u041d\u0435 \u0432\u0434\u0430\u043b\u043e\u0441\u044f \u0432\u0438\u0434\u0430\u043b\u0438\u0442\u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u044e \u0430\u0431\u043e \u0442\u043e\u0432\u0430\u0440\u0438"),m(o),t(i),a(c)}},children:"\u041d\u0456, \u0432\u0438\u0434\u0430\u043b\u0438\u0442\u0438"}),(0,_.jsx)("button",{className:"wishlist-modal-cancel-btn",onClick:Q,children:"\u041d\u0430\u0437\u0430\u0434"})]})]})})]})}},9409:()=>{}}]);
//# sourceMappingURL=244.03e6cb7b.chunk.js.map